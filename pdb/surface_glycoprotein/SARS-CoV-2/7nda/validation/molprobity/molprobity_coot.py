# script auto-generated by phenix.molprobity


from __future__ import absolute_import, division, print_function
from six.moves import cPickle as pickle
from six.moves import range
try :
  import gobject
except ImportError :
  gobject = None
import sys

class coot_extension_gui(object):
  def __init__(self, title):
    import gtk
    self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)
    scrolled_win = gtk.ScrolledWindow()
    self.outside_vbox = gtk.VBox(False, 2)
    self.inside_vbox = gtk.VBox(False, 0)
    self.window.set_title(title)
    self.inside_vbox.set_border_width(0)
    self.window.add(self.outside_vbox)
    self.outside_vbox.pack_start(scrolled_win, True, True, 0)
    scrolled_win.add_with_viewport(self.inside_vbox)
    scrolled_win.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)

  def finish_window(self):
    import gtk
    self.outside_vbox.set_border_width(2)
    ok_button = gtk.Button("  Close  ")
    self.outside_vbox.pack_end(ok_button, False, False, 0)
    ok_button.connect("clicked", lambda b: self.destroy_window())
    self.window.connect("delete_event", lambda a, b: self.destroy_window())
    self.window.show_all()

  def destroy_window(self, *args):
    self.window.destroy()
    self.window = None

  def confirm_data(self, data):
    for data_key in self.data_keys :
      outlier_list = data.get(data_key)
      if outlier_list is not None and len(outlier_list) > 0 :
        return True
    return False

  def create_property_lists(self, data):
    import gtk
    for data_key in self.data_keys :
      outlier_list = data[data_key]
      if outlier_list is None or len(outlier_list) == 0 :
        continue
      else :
        frame = gtk.Frame(self.data_titles[data_key])
        vbox = gtk.VBox(False, 2)
        frame.set_border_width(6)
        frame.add(vbox)
        self.add_top_widgets(data_key, vbox)
        self.inside_vbox.pack_start(frame, False, False, 5)
        list_obj = residue_properties_list(
          columns=self.data_names[data_key],
          column_types=self.data_types[data_key],
          rows=outlier_list,
          box=vbox)

# Molprobity result viewer
class coot_molprobity_todo_list_gui(coot_extension_gui):
  data_keys = [ "rama", "rota", "cbeta", "probe" ]
  data_titles = { "rama"  : "Ramachandran outliers",
                  "rota"  : "Rotamer outliers",
                  "cbeta" : "C-beta outliers",
                  "probe" : "Severe clashes" }
  data_names = { "rama"  : ["Chain", "Residue", "Name", "Score"],
                 "rota"  : ["Chain", "Residue", "Name", "Score"],
                 "cbeta" : ["Chain", "Residue", "Name", "Conf.", "Deviation"],
                 "probe" : ["Atom 1", "Atom 2", "Overlap"] }
  if (gobject is not None):
    data_types = { "rama" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "rota" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "cbeta" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT],
                   "probe" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT] }
  else :
    data_types = dict([ (s, []) for s in ["rama","rota","cbeta","probe"] ])

  def __init__(self, data_file=None, data=None):
    assert ([data, data_file].count(None) == 1)
    if (data is None):
      data = load_pkl(data_file)
    if not self.confirm_data(data):
      return
    coot_extension_gui.__init__(self, "MolProbity to-do list")
    self.dots_btn = None
    self.dots2_btn = None
    self._overlaps_only = True
    self.window.set_default_size(420, 600)
    self.create_property_lists(data)
    self.finish_window()

  def add_top_widgets(self, data_key, box):
    import gtk
    if data_key == "probe" :
      hbox = gtk.HBox(False, 2)
      self.dots_btn = gtk.CheckButton("Show Probe dots")
      hbox.pack_start(self.dots_btn, False, False, 5)
      self.dots_btn.connect("toggled", self.toggle_probe_dots)
      self.dots2_btn = gtk.CheckButton("Overlaps only")
      hbox.pack_start(self.dots2_btn, False, False, 5)
      self.dots2_btn.connect("toggled", self.toggle_all_probe_dots)
      self.dots2_btn.set_active(True)
      self.toggle_probe_dots()
      box.pack_start(hbox, False, False, 0)

  def toggle_probe_dots(self, *args):
    if self.dots_btn is not None :
      show_dots = self.dots_btn.get_active()
      overlaps_only = self.dots2_btn.get_active()
      if show_dots :
        self.dots2_btn.set_sensitive(True)
      else :
        self.dots2_btn.set_sensitive(False)
      show_probe_dots(show_dots, overlaps_only)

  def toggle_all_probe_dots(self, *args):
    if self.dots2_btn is not None :
      self._overlaps_only = self.dots2_btn.get_active()
      self.toggle_probe_dots()

class rsc_todo_list_gui(coot_extension_gui):
  data_keys = ["by_res", "by_atom"]
  data_titles = ["Real-space correlation by residue",
                 "Real-space correlation by atom"]
  data_names = {}
  data_types = {}

class residue_properties_list(object):
  def __init__(self, columns, column_types, rows, box,
      default_size=(380,200)):
    assert len(columns) == (len(column_types) - 1)
    if (len(rows) > 0) and (len(rows[0]) != len(column_types)):
      raise RuntimeError("Wrong number of rows:\n%s" % str(rows[0]))
    import gtk
    self.liststore = gtk.ListStore(*column_types)
    self.listmodel = gtk.TreeModelSort(self.liststore)
    self.listctrl = gtk.TreeView(self.listmodel)
    self.listctrl.column = [None]*len(columns)
    self.listctrl.cell = [None]*len(columns)
    for i, column_label in enumerate(columns):
      cell = gtk.CellRendererText()
      column = gtk.TreeViewColumn(column_label)
      self.listctrl.append_column(column)
      column.set_sort_column_id(i)
      column.pack_start(cell, True)
      column.set_attributes(cell, text=i)
    self.listctrl.get_selection().set_mode(gtk.SELECTION_SINGLE)
    for row in rows :
      self.listmodel.get_model().append(row)
    self.listctrl.connect("cursor-changed", self.OnChange)
    sw = gtk.ScrolledWindow()
    w, h = default_size
    if len(rows) > 10 :
      sw.set_size_request(w, h)
    else :
      sw.set_size_request(w, 30 + (20 * len(rows)))
    sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
    box.pack_start(sw, False, False, 5)
    inside_vbox = gtk.VBox(False, 0)
    sw.add(self.listctrl)

  def OnChange(self, treeview):
    import coot # import dependency
    selection = self.listctrl.get_selection()
    (model, tree_iter) = selection.get_selected()
    if tree_iter is not None :
      row = model[tree_iter]
      xyz = row[-1]
      if isinstance(xyz, tuple) and len(xyz) == 3 :
        set_rotation_centre(*xyz)
        set_zoom(30)
        graphics_draw()

def show_probe_dots(show_dots, overlaps_only):
  import coot # import dependency
  n_objects = number_of_generic_objects()
  sys.stdout.flush()
  if show_dots :
    for object_number in range(n_objects):
      obj_name = generic_object_name(object_number)
      if overlaps_only and not obj_name in ["small overlap", "bad overlap"] :
        sys.stdout.flush()
        set_display_generic_object(object_number, 0)
      else :
        set_display_generic_object(object_number, 1)
  else :
    sys.stdout.flush()
    for object_number in range(n_objects):
      set_display_generic_object(object_number, 0)

def load_pkl(file_name):
  pkl = open(file_name, "rb")
  data = pickle.load(pkl)
  pkl.close()
  return data

data = {}
data['rama'] = [('A', ' 123 ', 'ALA', 0.01765604237613849, (222.906, 172.92699999999994, 196.882)), ('A', ' 332 ', 'ILE', 0.06860460920271431, (156.116, 190.855, 209.07300000000004)), ('A', ' 527 ', 'PRO', 0.03373826672906619, (163.784, 184.77899999999997, 208.166)), ('B', ' 123 ', 'ALA', 0.018889328740057425, (123.36800000000001, 190.40299999999993, 206.473)), ('B', ' 332 ', 'ILE', 0.06962695567991697, (140.909, 126.62499999999997, 195.12)), ('B', ' 527 ', 'PRO', 0.030406296426403127, (142.011, 136.43099999999998, 198.049)), ('C', ' 123 ', 'ALA', 0.01853289678258767, (158.05000000000007, 101.15399999999997, 185.007)), ('C', ' 591 ', 'SER', 0.005793491381213372, (192.065, 143.293, 165.797)), ('C', ' 812 ', 'PRO', 0.04456690142037245, (133.928, 146.679, 134.63)), ('C', ' 814 ', 'LYS', 0.04946426119963955, (138.127, 150.81999999999994, 133.031)), ('H', ' 121 ', 'VAL', 0.08688863482307602, (159.234, 185.812, 248.02500000000003))]
data['omega'] = [('H', ' 157 ', 'PRO', None, (150.153, 188.525, 247.07899999999998)), ('H', ' 159 ', 'PRO', None, (150.659, 192.827, 242.52900000000002)), ('L', '   8 ', 'PRO', None, (172.25600000000006, 214.439, 238.429)), ('L', '  96 ', 'PRO', None, (183.05300000000005, 193.18999999999997, 237.779)), ('L', ' 142 ', 'PRO', None, (157.914, 221.29299999999998, 245.448))]
data['rota'] = [('A', ' 333 ', 'THR', 0.24380125239860628, (158.588, 189.33599999999996, 211.55200000000002)), ('A', ' 517 ', 'LEU', 0.21162717230299102, (154.088, 175.52199999999996, 197.80900000000003)), ('A', ' 779 ', 'GLN', 0.0031689413844749976, (176.566, 154.341, 138.606)), ('B', ' 333 ', 'THR', 0.2459894381188962, (140.394, 128.27, 198.529)), ('B', '1019 ', 'ARG', 0.04750575601085719, (166.485, 174.162, 148.867)), ('C', ' 637 ', 'SER', 0.29293026587382104, (189.07500000000002, 128.08999999999995, 158.204)), ('C', ' 849 ', 'LEU', 0.2406163441405818, (149.72500000000005, 140.579, 159.505)), ('C', '1019 ', 'ARG', 0.22085219396143704, (158.135, 163.83499999999998, 146.741)), ('H', ' 199 ', 'LEU', 0.18716358679756523, (128.86, 214.447, 246.172))]
data['cbeta'] = []
data['probe'] = [(' A 318  PHE  HZ ', ' A 615  VAL HG11', -0.882, (173.741, 192.36, 171.539)), (' C 387  LEU HD22', ' C 392  PHE  HZ ', -0.69, (188.581, 151.096, 197.562)), (' L 106  GLU  OE1', ' L 174  TYR  OH ', -0.682, (159.595, 214.83, 240.177)), (' C1028  LYS  O  ', ' C1032  CYS  HB3', -0.667, (156.29, 162.9, 130.085)), (' L  38  GLN  HB2', ' L  48  LEU HD11', -0.664, (167.388, 207.196, 227.515)), (' A 431  GLY  HA2', ' A 515  PHE  HD2', -0.655, (156.562, 170.254, 203.167)), (' B 125  ASN HD22', ' B1302  NAG  H3 ', -0.653, (127.914, 188.764, 212.31)), (' A 230  PRO  HB2', ' C 355  ARG HH11', -0.652, (196.622, 166.531, 202.324)), (' A1028  LYS  O  ', ' A1032  CYS  HB3', -0.646, (175.635, 166.767, 130.366)), (' B1028  LYS  O  ', ' B1032  CYS  HB3', -0.646, (162.642, 180.773, 133.925)), (' B 390  LEU HD11', ' C 983  ARG  HG2', -0.643, (152.379, 142.421, 189.785)), (' C 722  VAL HG22', ' C1065  VAL HG22', -0.641, (156.908, 152.313, 121.928)), (' A1028  LYS  O  ', ' A1032  CYS  CB ', -0.641, (175.174, 167.262, 129.837)), (' H  38  ARG  HB3', ' H  48  ILE HD11', -0.639, (169.133, 190.505, 239.078)), (' H  27  PHE  HB2', ' H 101  CYS  H  ', -0.638, (171.946, 189.491, 216.613)), (' A 804  GLN  NE2', ' A 935  GLN  OE1', -0.634, (197.854, 170.205, 130.172)), (' C 395  VAL HG21', ' C 524  VAL HG11', -0.632, (196.234, 153.216, 199.616)), (' C 131  CYS  N  ', ' C 166  CYS  SG ', -0.631, (167.182, 112.865, 198.989)), (' C1028  LYS  O  ', ' C1032  CYS  CB ', -0.63, (156.589, 163.135, 129.996)), (' B 858  LEU HD21', ' B 962  LEU HD23', -0.621, (162.357, 178.09, 169.308)), (' C 189  LEU  HB2', ' C 210  ILE HD13', -0.615, (165.756, 107.847, 168.475)), (' B 589  PRO  HG2', ' C 855  PHE  HB3', -0.614, (144.251, 145.054, 169.901)), (' A 318  PHE  CZ ', ' A 615  VAL HG11', -0.611, (174.241, 192.247, 171.868)), (' H  91  THR  HA ', ' H 119  VAL  O  ', -0.609, (160.978, 189.395, 244.376)), (' A 365  TYR  HD2', ' A 387  LEU  HB3', -0.607, (162.633, 175.702, 205.903)), (' L 121  PRO  HD3', ' L 133  VAL HG22', -0.607, (141.424, 206.763, 261.149)), (' H  91  THR HG23', ' H 120  THR  HA ', -0.607, (158.692, 189.576, 244.923)), (' B1028  LYS  O  ', ' B1032  CYS  CB ', -0.606, (162.395, 180.269, 133.391)), (' A 462  LYS  HE3', ' J   1  NAG  H81', -0.6, (136.37, 159.069, 199.327)), (' B 804  GLN  NE2', ' B 935  GLN  OE1', -0.6, (148.936, 198.028, 138.167)), (' C 777  ASN  OD1', ' C1019  ARG  NH1', -0.595, (154.215, 166.314, 146.099)), (' A1035  GLY  HA3', ' C1040  VAL HG21', -0.594, (171.837, 164.749, 123.637)), (' C 720  ILE HG13', ' C 923  ILE HG23', -0.592, (158.024, 152.863, 114.038)), (' A 720  ILE HG13', ' A 923  ILE HG23', -0.589, (185.12, 178.162, 119.209)), (' B 720  ILE HG13', ' B 923  ILE HG23', -0.588, (149.701, 188.438, 122.38)), (' C 726  ILE HD13', ' C 945  LEU HD13', -0.584, (157.334, 148.893, 137.369)), (' A 390  LEU HD11', ' B 983  ARG  HG2', -0.584, (161.827, 175.936, 196.935)), (' B 392  PHE  O  ', ' B 522  ALA  HB1', -0.582, (150.256, 131.392, 191.117)), (' C 126  VAL  H  ', ' C 172  SER  HB2', -0.582, (156.404, 108.221, 188.412)), (' B 715  PRO  HA ', ' B1071  GLN  O  ', -0.58, (141.022, 177.641, 116.492)), (' B1045  LYS  NZ ', ' C 889  GLY  O  ', -0.578, (147.822, 172.414, 129.268)), (' H 131  VAL  O  ', ' H 219  LYS  NZ ', -0.576, (135.464, 197.363, 251.491)), (' B 430  THR HG21', ' B 517  LEU HD23', -0.575, (158.952, 139.65, 190.014)), (' B 526  GLY  O  ', ' B 528  LYS  N  ', -0.574, (141.736, 137.008, 195.598)), (' L 121  PRO  HB3', ' L 132  SER  H  ', -0.565, (141.021, 203.326, 260.029)), (' A 392  PHE  O  ', ' A 522  ALA  HB1', -0.564, (153.268, 182.168, 201.725)), (' A 388  ASN  O  ', ' A 526  GLY  HA3', -0.561, (162.719, 181.572, 204.702)), (' A 978  ASN  ND2', ' C 547  THR  O  ', -0.558, (188.522, 148.416, 179.909)), (' B 722  VAL HG22', ' B1065  VAL HG22', -0.555, (151.72, 187.052, 130.357)), (' B 564  GLN  NE2', ' B 577  ARG  O  ', -0.553, (144.809, 130.351, 181.193)), (' B 726  ILE HD13', ' B 945  LEU HD13', -0.552, (152.002, 184.427, 146.141)), (' H  86  LEU  HB3', ' H 121  VAL HG11', -0.552, (162.894, 183.727, 247.568)), (' C 608  VAL  O  ', ' C 636  TYR  OH ', -0.551, (181.673, 129.993, 152.265)), (' A 439  ASN  O  ', ' A 443  SER  OG ', -0.545, (156.367, 156.824, 228.987)), (' A 722  VAL HG22', ' A1065  VAL HG22', -0.543, (185.279, 174.061, 126.154)), (' B 350  VAL  HA ', ' B 400  PHE  HB2', -0.542, (169.664, 131.574, 208.356)), (' L 171  ASP  OD2', ' L 173  THR  OG1', -0.542, (150.001, 218.004, 240.202)), (' A 642  VAL HG12', ' A 651  ILE HG12', -0.541, (182.276, 198.959, 167.695)), (' A 230  PRO  HG3', ' C 396  TYR  CE1', -0.54, (199.009, 163.716, 201.459)), (' C 715  PRO  HA ', ' C1071  GLN  O  ', -0.54, (172.405, 152.607, 109.497)), (' C 390  LEU  O  ', ' C 390  LEU HD12', -0.539, (190.594, 150.238, 193.686)), (' B 726  ILE HG12', ' B1061  VAL HG22', -0.538, (154.225, 184.651, 143.469)), (' C 666  ILE HD11', ' C 672  ALA  HB2', -0.538, (182.299, 138.195, 145.417)), (' A 526  GLY  O  ', ' A 528  LYS  N  ', -0.537, (163.852, 185.391, 205.839)), (' A 715  PRO  HA ', ' A1071  GLN  O  ', -0.537, (179.219, 191.76, 118.194)), (' B 388  ASN  O  ', ' B 526  GLY  HA3', -0.535, (145.556, 138.28, 195.355)), (' H  50  TRP  CD1', ' H  59  ASN  HB2', -0.532, (180.572, 187.597, 233.087)), (' C 132  GLU  H  ', ' C 165  ASN  N  ', -0.531, (171.186, 112.9, 202.125)), (' B 472  ILE HD13', ' B 482  GLY  HA2', -0.53, (189.804, 119.254, 209.112)), (' L 106  GLU  HB2', ' L 167  GLN  OE1', -0.53, (158.82, 215.6, 237.293)), (' A 980  ILE HG23', ' A 984  LEU HD12', -0.529, (179.269, 153.203, 187.125)), (' B 521  PRO  HD3', ' B 564  GLN  HB2', -0.526, (150.108, 128.888, 181.951)), (' C 827  THR  OG1', ' C 949  GLN  NE2', -0.526, (154.938, 142.936, 147.085)), (' A 985  ASP  OD1', ' C 385  THR  OG1', -0.525, (180.172, 146.566, 195.528)), (' B 439  ASN  O  ', ' B 443  SER  OG ', -0.525, (166.076, 135.89, 223.932)), (' A 401  VAL HG22', ' A 509  ARG  HG2', -0.525, (152.588, 161.986, 220.602)), (' A  81  ASN  O  ', ' A 239  GLN  NE2', -0.525, (210.913, 190.197, 202.091)), (' L 108  LYS  HG2', ' L 109  ARG  H  ', -0.523, (159.987, 223.824, 237.762)), (' A 704  SER  HB3', ' B 790  LYS  HE2', -0.521, (171.619, 203.195, 132.33)), (' H  68  VAL HG22', ' H  83  LEU HD13', -0.519, (170.267, 184.478, 242.117)), (' L 194  ALA  HB2', ' L 209  SER  HB3', -0.514, (143.6, 217.473, 263.667)), (' A 336  CYS  SG ', ' A 363  ALA  HB2', -0.512, (156.848, 180.321, 211.594)), (' B 519  HIS  HB3', ' B 565  PHE  CE2', -0.511, (150.628, 134.354, 182.47)), (' C 329  PHE  CE2', ' C 391  CYS  HB2', -0.51, (195.369, 146.95, 191.409)), (' L  15  PRO  HD3', ' L 107  ILE HG23', -0.51, (158.109, 220.033, 231.663)), (' H 129  PRO  HD2', ' H 215  THR HG21', -0.51, (140.786, 190.904, 247.108)), (' A 295  PRO  HB2', ' A 608  VAL HG21', -0.508, (188.755, 188.88, 167.285)), (' C 392  PHE  O  ', ' C 522  ALA  HB1', -0.508, (196.765, 152.445, 193.232)), (' C 385  THR  OG1', ' C 386  LYS  N  ', -0.507, (181.547, 146.368, 195.98)), (' B 666  ILE HD11', ' B 672  ALA  HB2', -0.506, (132.37, 164.671, 152.96)), (' A 786  LYS  HG3', ' A 787  GLN  HG2', -0.506, (177.653, 150.051, 123.835)), (' C 733  LYS  NZ ', ' C 775  ASP  OD2', -0.504, (145.582, 161.211, 151.439)), (' H 129  PRO  HB3', ' H 155  TYR  HB3', -0.501, (144.44, 193.164, 248.789)), (' L 121  PRO  HG3', ' L 131  ALA  HB1', -0.501, (140.691, 204.217, 262.609)), (' C 816  SER  OG ', ' C 819  GLU  OE1', -0.499, (146.052, 150.279, 131.782)), (' A 519  HIS  HB3', ' A 565  PHE  CE2', -0.498, (154.372, 182.753, 193.248)), (' C 333  THR  O  ', ' C 333  THR  OG1', -0.497, (205.649, 141.711, 201.198)), (' H  44  ARG  NH1', ' H  45  LEU  O  ', -0.497, (172.685, 198.834, 239.99)), (' A 403  ARG HH22', ' B 372  ALA  HB3', -0.494, (152.266, 146.65, 215.816)), (' B1072  GLU  HG2', ' C 894  LEU HD21', -0.494, (141.912, 173.343, 118.826)), (' B 333  THR  O  ', ' B 333  THR  OG1', -0.493, (139.07, 127.634, 200.064)), (' C 459  SER  OG ', ' D   1  NAG  O7 ', -0.492, (187.734, 182.52, 205.801)), (' B 328  ARG  HD2', ' B 533  LEU HD12', -0.489, (137.046, 133.939, 182.069)), (' C 328  ARG  HD2', ' C 533  LEU HD12', -0.489, (201.808, 142.927, 182.489)), (' B 310  LYS  HG3', ' B 600  PRO  HA ', -0.489, (134.908, 174.11, 155.355)), (' C 418  ILE  HA ', ' C 422  ASN  HB2', -0.488, (183.981, 171.196, 212.12)), (' A 354  ASN  O  ', ' A 398  ASP  HA ', -0.485, (147.367, 167.899, 212.926)), (' H  88  SER  HA ', ' H 121  VAL  O  ', -0.485, (160.737, 187.51, 249.891)), (' C 763  LEU HD22', ' C1008  VAL HG21', -0.484, (156.511, 161.654, 164.549)), (' A 770  ILE  O  ', ' A 774  GLN  HG2', -0.484, (175.328, 155.54, 150.025)), (' B 336  CYS  SG ', ' B 363  ALA  HB2', -0.484, (148.742, 131.422, 201.286)), (' B 726  ILE HG22', ' B 948  LEU HD13', -0.484, (155.402, 181.622, 147.046)), (' H 169  LEU HD21', ' H 192  VAL HG21', -0.484, (137.34, 210.834, 240.825)), (' A 403  ARG  HB3', ' A 497  PHE  HE1', -0.483, (152.952, 152.939, 220.481)), (' A 905  ARG  HD2', ' A1049  LEU  O  ', -0.483, (177.696, 170.727, 121.651)), (' L 109  ARG  HG2', ' L 110  THR  H  ', -0.483, (155.248, 224.758, 238.298)), (' B 203  ILE  HB ', ' B 227  VAL  HB ', -0.481, (135.62, 179.097, 199.652)), (' C 310  LYS  NZ ', ' C 663  ASP  OD1', -0.481, (173.172, 138.072, 140.973)), (' B1040  VAL HG21', ' C1035  GLY  HA3', -0.481, (154.977, 168.834, 125.252)), (' B 714  ILE HD12', ' B1096  VAL HG11', -0.48, (144.503, 172.855, 108.702)), (' B 715  PRO  HA ', ' B1072  GLU  HA ', -0.48, (140.899, 176.314, 115.929)), (' B1048  HIS  HA ', ' B1066  THR HG22', -0.479, (154.315, 180.23, 127.591)), (' A1002  GLN  NE2', ' B1005  GLN  OE1', -0.477, (168.74, 164.21, 171.733)), (' H   2  VAL  HA ', ' H  26  GLY  HA3', -0.476, (164.908, 189.771, 216.37)), (' H   4  LEU  HB2', ' H 112  ILE HG22', -0.476, (165.68, 191.316, 223.252)), (' C 726  ILE HG12', ' C1061  VAL HG22', -0.475, (156.195, 151.173, 135.754)), (' C 401  VAL HG22', ' C 509  ARG  HG2', -0.474, (187.751, 159.905, 218.013)), (' B 431  GLY  HA2', ' B 515  PHE  CE2', -0.473, (158.609, 138.636, 195.636)), (' B1094  VAL HG11', ' C 904  TYR  OH ', -0.473, (149.612, 168.514, 110.901)), (' L 185  ALA  O  ', ' L 189  LYS  HG3', -0.473, (141.787, 202.882, 273.484)), (' A 319  ARG  HG2', ' A 592  PHE  HB2', -0.472, (173.369, 186.755, 176.665)), (' B 363  ALA  O  ', ' B 527  PRO  HD3', -0.472, (145.953, 136.165, 199.362)), (' B 905  ARG  HD2', ' B1049  LEU  O  ', -0.471, (159.252, 184.427, 124.848)), (' A 431  GLY  HA2', ' A 515  PHE  CD2', -0.471, (156.404, 170.714, 203.424)), (' C 115  GLN  NE2', ' C 132  GLU  OE2', -0.471, (174.372, 116.962, 202.596)), (' B 355  ARG HH11', ' C 230  PRO  HB2', -0.471, (164.582, 126.553, 195.517)), (' A 472  ILE HD13', ' A 482  GLY  HA2', -0.47, (126.618, 149.182, 217.582)), (' C 327  VAL  HB ', ' C 531  THR HG23', -0.47, (197.133, 137.835, 187.006)), (' A 715  PRO  O  ', ' A1110  TYR  N  ', -0.47, (177.252, 189.148, 114.236)), (' A 189  LEU  HB2', ' A 210  ILE HD13', -0.469, (215.74, 181.771, 180.969)), (' B1072  GLU  HG2', ' C 894  LEU  CD2', -0.469, (141.785, 173.147, 118.568)), (' B  81  ASN  O  ', ' B 239  GLN  NE2', -0.469, (115.906, 169.711, 202.713)), (' B 770  ILE  O  ', ' B 774  GLN  HG2', -0.468, (169.088, 178.892, 155.376)), (' A 396  TYR  HE2', ' B 200  TYR  HE2', -0.468, (145.077, 173.29, 203.786)), (' C 770  ILE  O  ', ' C 774  GLN  HG2', -0.468, (151.765, 162.1, 152.236)), (' C 714  ILE HD12', ' C1096  VAL HG11', -0.468, (176.056, 160.038, 104.735)), (' C 338  PHE  HE2', ' C 365  TYR  HE1', -0.468, (192.257, 150.052, 203.385)), (' B 396  TYR  CZ ', ' C 230  PRO  HG3', -0.467, (161.451, 125.54, 194.329)), (' B 394  ASN  O  ', ' B 515  PHE  HA ', -0.467, (157.313, 131.98, 193.766)), (' B 722  VAL  HA ', ' B1064  HIS  O  ', -0.466, (151.425, 184.407, 131.517)), (' A 826  VAL HG23', ' A 945  LEU HD12', -0.465, (189.237, 168.166, 144.509)), (' A 203  ILE  HB ', ' A 227  VAL  HB ', -0.465, (205.572, 170.912, 193.915)), (' A 983  ARG  HG2', ' C 390  LEU HD22', -0.465, (187.25, 152.08, 191.111)), (' C 318  PHE  O  ', ' C 592  PHE  HA ', -0.463, (187.441, 141.815, 164.124)), (' A1072  GLU  HG2', ' B 894  LEU HD22', -0.46, (175.622, 192.988, 121.655)), (' A1072  GLU  HG2', ' B 894  LEU  CD2', -0.46, (176.022, 192.523, 121.476)), (' C 715  PRO  O  ', ' C1110  TYR  N  ', -0.46, (170.43, 156.521, 106.936)), (' C 195  LYS  HE2', ' C 204  TYR  HE1', -0.459, (166.288, 124.303, 181.156)), (' B 592  PHE  HE1', ' C 855  PHE  HD1', -0.459, (142.378, 147.039, 167.924)), (' C  96  GLU  HG3', ' C 190  ARG HH21', -0.458, (165.605, 104.46, 177.59)), (' A1040  VAL HG21', ' B1035  GLY  HA3', -0.458, (166.639, 180.917, 127.646)), (' C 439  ASN  O  ', ' C 443  SER  OG ', -0.457, (183.652, 157.173, 227.613)), (' B 763  LEU HD22', ' B1008  VAL HG21', -0.457, (169.801, 170.907, 166.415)), (' B 930  ALA  O  ', ' B 934  ILE HG12', -0.457, (147.131, 189.177, 134.486)), (' B 414  GLN  O  ', ' B 424  LYS  NZ ', -0.457, (175.722, 140.387, 197.788)), (' A 122  ASN  OD1', ' A 125  ASN  HB2', -0.456, (219.815, 170.579, 200.899)), (' A  96  GLU  HG3', ' A 190  ARG HH21', -0.455, (217.635, 179.997, 190.637)), (' A 763  LEU HD22', ' A1008  VAL HG21', -0.454, (171.279, 155.464, 163.152)), (' C1048  HIS  HA ', ' C1066  THR HG22', -0.453, (162.342, 158.25, 122.594)), (' A 350  VAL  HA ', ' A 400  PHE  HB2', -0.453, (147.272, 160.63, 215.643)), (' A 908  GLY  O  ', ' A1038  LYS  HE2', -0.453, (170.144, 174.089, 119.4)), (' C 756  TYR  HB3', ' C 759  PHE  HD2', -0.453, (156.913, 164.818, 175.369)), (' C 908  GLY  O  ', ' C1038  LYS  HE2', -0.452, (162.611, 167.503, 118.172)), (' A 418  ILE  HA ', ' A 422  ASN HD22', -0.452, (145.988, 154.17, 211.006)), (' A 794  ILE  O  ', ' A 794  ILE HG13', -0.452, (193.275, 160.472, 115.29)), (' L 123  ASP  O  ', ' L 127  LYS  HG2', -0.451, (132.982, 198.623, 261.317)), (' C 858  LEU HD21', ' C 962  LEU HD23', -0.451, (153.385, 152.665, 164.317)), (' A 333  THR  O  ', ' A 333  THR  OG1', -0.45, (159.357, 190.17, 213.53)), (' C 726  ILE HG22', ' C 948  LEU HD13', -0.45, (157.917, 151.774, 140.214)), (' A1094  VAL HG11', ' B 904  TYR  OH ', -0.449, (166.565, 189.69, 115.61)), (' B 826  VAL  HB ', ' B1057  PRO  HG2', -0.448, (154.751, 188.527, 152.295)), (' B 276  LEU  O  ', ' B 288  ALA  HA ', -0.448, (137.921, 177.889, 176.653)), (' C 905  ARG  HD2', ' C1049  LEU  O  ', -0.447, (156.307, 161.644, 119.844)), (' B 970  PHE  HE1', ' C 759  PHE  HE2', -0.447, (159.735, 166.673, 175.507)), (' A1028  LYS  O  ', ' A1032  CYS  HB2', -0.446, (174.854, 167.831, 130.669)), (' H 196  SER  HA ', ' H 199  LEU HD23', -0.446, (131.886, 217.317, 246.984)), (' A 714  ILE HD12', ' A1096  VAL HG11', -0.445, (172.064, 193.139, 112.786)), (' B 401  VAL HG22', ' B 509  ARG  HG2', -0.445, (164.518, 133.328, 214.045)), (' C 640  SER  OG ', ' C 641  ASN  N  ', -0.445, (190.087, 128.07, 149.635)), (' A 826  VAL  HB ', ' A1057  PRO  HG2', -0.443, (189.866, 165.001, 145.938)), (' A 415  THR HG22', ' B 385  THR HG22', -0.441, (150.943, 149.21, 201.432)), (' A1011  GLN  OE1', ' A1014  ARG  NH1', -0.441, (176.912, 162.9, 157.425)), (' A 565  PHE  HD1', ' A 576  VAL HG12', -0.44, (156.083, 186.271, 190.21)), (' A  48  LEU HD22', ' A 306  PHE  HE1', -0.439, (196.042, 172.489, 169.106)), (' C 826  VAL  HB ', ' C1057  PRO  HG2', -0.439, (151.437, 146.883, 142.581)), (' A  29  THR  OG1', ' A 215  ASP  OD2', -0.438, (209.761, 191.738, 179.796)), (' B 385  THR  OG1', ' B 386  LYS  N  ', -0.438, (150.692, 148.084, 197.082)), (' B 565  PHE  HD1', ' B 576  VAL HG12', -0.438, (146.765, 135.129, 179.084)), (' C 195  LYS  HE3', ' C 202  LYS  HD2', -0.437, (166.834, 126.218, 183.264)), (' A 328  ARG  HD2', ' A 533  LEU HD12', -0.437, (161.205, 194.686, 194.986)), (' A1005  GLN  OE1', ' C1002  GLN  NE2', -0.436, (167.125, 157.771, 170.302)), (' C 497  PHE  CD2', ' C 507  PRO  HB3', -0.436, (183.931, 162.113, 222.896)), (' B 808  ASP  OD2', ' B 811  LYS  HG3', -0.436, (156.697, 205.068, 142.358)), (' A 722  VAL  HA ', ' A1064  HIS  O  ', -0.435, (183.752, 175.799, 128.432)), (' A 666  ILE HD11', ' A 672  ALA  HB2', -0.435, (181.887, 192.831, 157.935)), (' C 565  PHE  CD1', ' C 576  VAL HG12', -0.435, (196.95, 152.066, 181.441)), (' H 207  ASN  ND2', ' H 218  ASP  OD1', -0.434, (133.887, 198.261, 240.679)), (' B 815  ARG  HG3', ' B 815  ARG HH11', -0.434, (160.249, 197.571, 147.941)), (' H  50  TRP  NE1', ' H  59  ASN  HB2', -0.433, (181.186, 187.728, 232.965)), (' A 368  LEU  HB3', ' A 374  PHE  HE2', -0.433, (162.378, 170.792, 214.276)), (' C 365  TYR  HE2', ' C 392  PHE  CE1', -0.432, (190.524, 149.696, 198.336)), (' A 194  PHE  HD1', ' A 203  ILE HG12', -0.432, (204.643, 174.952, 194.714)), (' A 408  ARG  NH2', ' B 375  SER  O  ', -0.431, (160.499, 147.565, 210.236)), (' L 191  LYS  HG2', ' L 211  ASN  OD1', -0.431, (137.091, 214.355, 269.868)), (' A 564  GLN  NE2', ' A 577  ARG  O  ', -0.431, (154.285, 189.724, 194.511)), (' A1091  ARG  NH1', ' A1120  THR  O  ', -0.431, (161.919, 183.706, 101.723)), (' C 195  LYS  HE2', ' C 204  TYR  CE1', -0.43, (166.239, 124.415, 180.911)), (' L  48  LEU HD23', ' L  59  ILE HD12', -0.43, (167.506, 205.864, 223.221)), (' B 350  VAL HG22', ' B 422  ASN  HB3', -0.43, (173.488, 132.785, 206.515)), (' C 322  PRO  HA ', ' C 538  CYS  O  ', -0.43, (192.94, 136.88, 174.101)), (' A 385  THR  OG1', ' A 386  LYS  N  ', -0.427, (168.497, 172.739, 202.51)), (' A 210  ILE HG21', ' A 217  PRO  HG2', -0.427, (215.08, 181.863, 178.541)), (' A 396  TYR  HB2', ' A 514  SER  OG ', -0.426, (149.144, 171.725, 206.37)), (' A 726  ILE HG22', ' A 948  LEU HD13', -0.426, (182.52, 169.355, 143.029)), (' C 518  LEU  O  ', ' C 518  LEU HD12', -0.424, (191.641, 156.767, 186.653)), (' A 715  PRO  HB3', ' A1069  PRO  HB3', -0.424, (177.787, 188.556, 120.268)), (' B 564  GLN  NE2', ' B 577  ARG  HB3', -0.424, (145.48, 129.666, 180.765)), (' C 950  ASP  OD2', ' C 954  GLN  NE2', -0.423, (163.21, 150.926, 148.923)), (' C 290  ASP  HB3', ' C 293  LEU  HB2', -0.423, (174.158, 127.105, 164.484)), (' A 930  ALA  O  ', ' A 934  ILE HG12', -0.423, (190.479, 176.343, 130.295)), (' H 180  LEU HD13', ' H 186  TYR  CZ ', -0.423, (154.98, 193.376, 250.265)), (' H 161  THR HG23', ' H 209  ASN  HB3', -0.423, (142.178, 194.878, 239.291)), (' A  53  ASP  HB3', ' A  55  PHE  CE2', -0.423, (194.488, 174.754, 183.503)), (' L   7  SER  OG ', ' L  22  SER  HB2', -0.422, (176.579, 214.146, 237.451)), (' B 329  PHE  HE1', ' B 391  CYS  HB2', -0.421, (145.968, 136.098, 190.544)), (' A 310  LYS  HG3', ' A 600  PRO  HA ', -0.421, (189.536, 186.041, 155.982)), (' C 565  PHE  HD1', ' C 576  VAL HG12', -0.42, (196.849, 152.112, 181.304)), (' C 722  VAL  HA ', ' C1064  HIS  O  ', -0.42, (159.561, 152.937, 124.178)), (' C 220  PHE  CE2', ' C 285  ILE HG22', -0.419, (162.037, 124.022, 166.78)), (' B 715  PRO  HD3', ' C 894  LEU HD13', -0.419, (144.294, 173.745, 116.79)), (' C 457  ARG  NH1', ' D   1  NAG  O7 ', -0.418, (188.233, 180.773, 206.631)), (' A1028  LYS  NZ ', ' A1042  PHE  O  ', -0.418, (173.583, 172.69, 134.451)), (' C 329  PHE  HE2', ' C 391  CYS  HB2', -0.417, (194.878, 146.536, 191.377)), (' A 497  PHE  CD2', ' A 507  PRO  HB3', -0.417, (152.291, 156.032, 223.591)), (' B1011  GLN  OE1', ' B1014  ARG  NH1', -0.416, (161.003, 174.068, 160.49)), (' A 961  THR  O  ', ' A 965  GLN  HG2', -0.416, (180.184, 163.512, 169.123)), (' A 195  LYS  HE2', ' A 204  TYR  CE1', -0.415, (198.827, 172.519, 189.596)), (' C 930  ALA  O  ', ' C 934  ILE HG12', -0.414, (157.158, 146.293, 124.843)), (' L 137  LEU  HB2', ' L 176  LEU  HB3', -0.414, (151.294, 213.967, 250.569)), (' A  40  ASP  HB2', ' C 519  HIS  NE2', -0.414, (195.218, 164.061, 185.445)), (' B 779  GLN  O  ', ' B 783  ALA  HB3', -0.413, (172.346, 185.329, 143.226)), (' H   2  VAL  HA ', ' H  25  SER  O  ', -0.413, (164.916, 189.436, 217.533)), (' A 817  PHE  HE1', ' A 821  LEU HD11', -0.411, (197.262, 170.571, 135.33)), (' A 131  CYS  HB2', ' A 133  PHE  CE2', -0.411, (208.716, 175.045, 210.43)), (' B 125  ASN  ND2', ' B1302  NAG  H3 ', -0.411, (128.247, 189.488, 212.64)), (' B 220  PHE  CE2', ' B 285  ILE HG22', -0.41, (135.913, 182.676, 180.392)), (' L  38  GLN  O  ', ' L  46  ARG  N  ', -0.41, (165.582, 201.691, 228.547)), (' A 894  LEU  CD2', ' C1072  GLU  HG2', -0.41, (175.695, 154.09, 113.211)), (' A 802  PHE  CD1', ' A 805  ILE HD11', -0.409, (189.092, 167.274, 124.402)), (' B 321  GLN  HB3', ' B 322  PRO  HD2', -0.409, (135.409, 151.533, 179.008)), (' H 162  VAL HG22', ' H 208  VAL HG22', -0.408, (141.654, 199.261, 244.152)), (' A 363  ALA  O  ', ' A 527  PRO  HD3', -0.408, (161.908, 181.053, 208.912)), (' C1011  GLN  OE1', ' C1014  ARG  NH1', -0.407, (159.042, 155.367, 156.611)), (' B 385  THR  OG1', ' C 985  ASP  OD1', -0.407, (151.229, 149.419, 196.725)), (' B 442  ASP  OD1', ' B 451  TYR  OH ', -0.406, (165.383, 130.32, 217.256)), (' C1073  LYS  HB2', ' C1075  PHE  CE2', -0.406, (176.328, 154.13, 104.736)), (' A 787  GLN  O  ', ' A 788  ILE HD13', -0.406, (182.169, 151.856, 128.361)), (' B 565  PHE  CD1', ' B 576  VAL HG12', -0.406, (147.085, 135.21, 179.39)), (' C 220  PHE  HE2', ' C 285  ILE HG22', -0.406, (161.899, 123.963, 166.741)), (' A 853  GLN  HB2', ' A 858  LEU  HB2', -0.405, (185.471, 155.756, 163.716)), (' B 713  ALA  HA ', ' B1073  LYS  O  ', -0.405, (140.058, 171.787, 113.313)), (' B 387  LEU  HA ', ' B 387  LEU HD23', -0.405, (151.22, 141.722, 195.655)), (' C 359  SER  HA ', ' C 524  VAL HG23', -0.405, (200.421, 154.016, 199.676)), (' A 439  ASN  HA ', ' A 507  PRO  HG2', -0.404, (156.406, 157.222, 225.215)), (' B 376  THR  O  ', ' B 434  ILE  HA ', -0.404, (160.163, 141.987, 207.161)), (' B 354  ASN  O  ', ' B 398  ASP  HA ', -0.403, (163.661, 129.086, 203.812)), (' C 599  THR  HB ', ' C 608  VAL HG12', -0.402, (175.749, 133.02, 151.512)), (' A 376  THR  O  ', ' A 434  ILE  HA ', -0.402, (160.444, 164.078, 211.968)), (' A1048  HIS  HA ', ' A1066  THR HG22', -0.402, (177.679, 176.008, 126.299)), (' L  67  GLY  HA3', ' L  72  PHE  HA ', -0.402, (182.388, 211.764, 229.772)), (' H  31  THR  O  ', ' H  31  THR  OG1', -0.401, (178.375, 185.843, 218.402)), (' B 359  SER  HA ', ' B 524  VAL HG23', -0.401, (150.914, 127.734, 196.08)), (' B 105  ILE HD11', ' B 241  LEU HD21', -0.401, (120.545, 174.228, 207.062)), (' B 858  LEU HD23', ' B 959  LEU HD22', -0.4, (162.191, 180.09, 167.617)), (' L  12  SER  OG ', ' L 106  GLU  OE2', -0.4, (162.506, 218.3, 240.405)), (' B 704  SER  HB3', ' C 790  LYS  HE2', -0.4, (133.522, 160.689, 124.153)), (' H 154  ASP  HA ', ' H 185  LEU  HB3', -0.4, (147.945, 192.991, 253.475)), (' H  14  PRO  HD3', ' H 122  SER  O  ', -0.4, (157.783, 183.238, 251.596))]
handle_read_draw_probe_dots_unformatted("molprobity_probe.txt", 0, 0)
show_probe_dots(True, True)
gui = coot_molprobity_todo_list_gui(data=data)
