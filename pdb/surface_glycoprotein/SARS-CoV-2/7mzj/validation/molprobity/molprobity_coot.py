# script auto-generated by phenix.molprobity


from __future__ import absolute_import, division, print_function
from six.moves import cPickle as pickle
from six.moves import range
try :
  import gobject
except ImportError :
  gobject = None
import sys

class coot_extension_gui(object):
  def __init__(self, title):
    import gtk
    self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)
    scrolled_win = gtk.ScrolledWindow()
    self.outside_vbox = gtk.VBox(False, 2)
    self.inside_vbox = gtk.VBox(False, 0)
    self.window.set_title(title)
    self.inside_vbox.set_border_width(0)
    self.window.add(self.outside_vbox)
    self.outside_vbox.pack_start(scrolled_win, True, True, 0)
    scrolled_win.add_with_viewport(self.inside_vbox)
    scrolled_win.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)

  def finish_window(self):
    import gtk
    self.outside_vbox.set_border_width(2)
    ok_button = gtk.Button("  Close  ")
    self.outside_vbox.pack_end(ok_button, False, False, 0)
    ok_button.connect("clicked", lambda b: self.destroy_window())
    self.window.connect("delete_event", lambda a, b: self.destroy_window())
    self.window.show_all()

  def destroy_window(self, *args):
    self.window.destroy()
    self.window = None

  def confirm_data(self, data):
    for data_key in self.data_keys :
      outlier_list = data.get(data_key)
      if outlier_list is not None and len(outlier_list) > 0 :
        return True
    return False

  def create_property_lists(self, data):
    import gtk
    for data_key in self.data_keys :
      outlier_list = data[data_key]
      if outlier_list is None or len(outlier_list) == 0 :
        continue
      else :
        frame = gtk.Frame(self.data_titles[data_key])
        vbox = gtk.VBox(False, 2)
        frame.set_border_width(6)
        frame.add(vbox)
        self.add_top_widgets(data_key, vbox)
        self.inside_vbox.pack_start(frame, False, False, 5)
        list_obj = residue_properties_list(
          columns=self.data_names[data_key],
          column_types=self.data_types[data_key],
          rows=outlier_list,
          box=vbox)

# Molprobity result viewer
class coot_molprobity_todo_list_gui(coot_extension_gui):
  data_keys = [ "rama", "rota", "cbeta", "probe" ]
  data_titles = { "rama"  : "Ramachandran outliers",
                  "rota"  : "Rotamer outliers",
                  "cbeta" : "C-beta outliers",
                  "probe" : "Severe clashes" }
  data_names = { "rama"  : ["Chain", "Residue", "Name", "Score"],
                 "rota"  : ["Chain", "Residue", "Name", "Score"],
                 "cbeta" : ["Chain", "Residue", "Name", "Conf.", "Deviation"],
                 "probe" : ["Atom 1", "Atom 2", "Overlap"] }
  if (gobject is not None):
    data_types = { "rama" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "rota" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "cbeta" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT],
                   "probe" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT] }
  else :
    data_types = dict([ (s, []) for s in ["rama","rota","cbeta","probe"] ])

  def __init__(self, data_file=None, data=None):
    assert ([data, data_file].count(None) == 1)
    if (data is None):
      data = load_pkl(data_file)
    if not self.confirm_data(data):
      return
    coot_extension_gui.__init__(self, "MolProbity to-do list")
    self.dots_btn = None
    self.dots2_btn = None
    self._overlaps_only = True
    self.window.set_default_size(420, 600)
    self.create_property_lists(data)
    self.finish_window()

  def add_top_widgets(self, data_key, box):
    import gtk
    if data_key == "probe" :
      hbox = gtk.HBox(False, 2)
      self.dots_btn = gtk.CheckButton("Show Probe dots")
      hbox.pack_start(self.dots_btn, False, False, 5)
      self.dots_btn.connect("toggled", self.toggle_probe_dots)
      self.dots2_btn = gtk.CheckButton("Overlaps only")
      hbox.pack_start(self.dots2_btn, False, False, 5)
      self.dots2_btn.connect("toggled", self.toggle_all_probe_dots)
      self.dots2_btn.set_active(True)
      self.toggle_probe_dots()
      box.pack_start(hbox, False, False, 0)

  def toggle_probe_dots(self, *args):
    if self.dots_btn is not None :
      show_dots = self.dots_btn.get_active()
      overlaps_only = self.dots2_btn.get_active()
      if show_dots :
        self.dots2_btn.set_sensitive(True)
      else :
        self.dots2_btn.set_sensitive(False)
      show_probe_dots(show_dots, overlaps_only)

  def toggle_all_probe_dots(self, *args):
    if self.dots2_btn is not None :
      self._overlaps_only = self.dots2_btn.get_active()
      self.toggle_probe_dots()

class rsc_todo_list_gui(coot_extension_gui):
  data_keys = ["by_res", "by_atom"]
  data_titles = ["Real-space correlation by residue",
                 "Real-space correlation by atom"]
  data_names = {}
  data_types = {}

class residue_properties_list(object):
  def __init__(self, columns, column_types, rows, box,
      default_size=(380,200)):
    assert len(columns) == (len(column_types) - 1)
    if (len(rows) > 0) and (len(rows[0]) != len(column_types)):
      raise RuntimeError("Wrong number of rows:\n%s" % str(rows[0]))
    import gtk
    self.liststore = gtk.ListStore(*column_types)
    self.listmodel = gtk.TreeModelSort(self.liststore)
    self.listctrl = gtk.TreeView(self.listmodel)
    self.listctrl.column = [None]*len(columns)
    self.listctrl.cell = [None]*len(columns)
    for i, column_label in enumerate(columns):
      cell = gtk.CellRendererText()
      column = gtk.TreeViewColumn(column_label)
      self.listctrl.append_column(column)
      column.set_sort_column_id(i)
      column.pack_start(cell, True)
      column.set_attributes(cell, text=i)
    self.listctrl.get_selection().set_mode(gtk.SELECTION_SINGLE)
    for row in rows :
      self.listmodel.get_model().append(row)
    self.listctrl.connect("cursor-changed", self.OnChange)
    sw = gtk.ScrolledWindow()
    w, h = default_size
    if len(rows) > 10 :
      sw.set_size_request(w, h)
    else :
      sw.set_size_request(w, 30 + (20 * len(rows)))
    sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
    box.pack_start(sw, False, False, 5)
    inside_vbox = gtk.VBox(False, 0)
    sw.add(self.listctrl)

  def OnChange(self, treeview):
    import coot # import dependency
    selection = self.listctrl.get_selection()
    (model, tree_iter) = selection.get_selected()
    if tree_iter is not None :
      row = model[tree_iter]
      xyz = row[-1]
      if isinstance(xyz, tuple) and len(xyz) == 3 :
        set_rotation_centre(*xyz)
        set_zoom(30)
        graphics_draw()

def show_probe_dots(show_dots, overlaps_only):
  import coot # import dependency
  n_objects = number_of_generic_objects()
  sys.stdout.flush()
  if show_dots :
    for object_number in range(n_objects):
      obj_name = generic_object_name(object_number)
      if overlaps_only and not obj_name in ["small overlap", "bad overlap"] :
        sys.stdout.flush()
        set_display_generic_object(object_number, 0)
      else :
        set_display_generic_object(object_number, 1)
  else :
    sys.stdout.flush()
    for object_number in range(n_objects):
      set_display_generic_object(object_number, 0)

def load_pkl(file_name):
  pkl = open(file_name, "rb")
  data = pickle.load(pkl)
  pkl.close()
  return data

data = {}
data['rama'] = []
data['omega'] = [('C', ' 151 ', 'PRO', None, (19.376, 37.72799999999999, 24.884999999999987)), ('C', ' 153 ', 'PRO', None, (22.593, 36.179, 19.774)), ('D', ' 145 ', 'PRO', None, (14.778999999999993, 10.955, 6.556999999999997)), ('E', ' 145 ', 'PRO', None, (-5.171000000000002, 6.439999999999997, -1.024)), ('F', ' 151 ', 'PRO', None, (5.628000000000004, -19.169, -17.749)), ('F', ' 153 ', 'PRO', None, (7.9899999999999975, -16.826, -12.481999999999992)), ('H', ' 160 ', 'PRO', None, (-9.247999999999998, -65.459, 39.961)), ('H', ' 162 ', 'PRO', None, (-14.026000000000003, -61.838, 41.59099999999997)), ('L', '   8 ', 'PRO', None, (-13.940999999999999, -37.93299999999997, 61.325)), ('L', ' 142 ', 'PRO', None, (-20.74, -56.914, 70.541)), ('M', '   8 ', 'PRO', None, (4.849000000000002, 54.649, -55.868)), ('M', ' 142 ', 'PRO', None, (-2.273999999999999, 73.479, -64.791)), ('N', ' 160 ', 'PRO', None, (8.858, 82.188, -34.223)), ('N', ' 162 ', 'PRO', None, (3.9029999999999956, 78.587, -35.696999999999974))]
data['rota'] = []
data['cbeta'] = []
data['probe'] = [(' C 199  ILE HD12', ' C 201  ASN HD21', -0.931, (39.107, 27.999, 26.055)), (' H   9  GLY  HA2', ' H  18  LEU HD21', -0.888, (-10.953, -56.595, 32.284)), (' M  37  GLN  HB2', ' M  47  LEU HD11', -0.859, (-5.699, 57.69, -47.157)), (' D  74  LEU HD22', ' D  76  ILE HD11', -0.857, (3.252, 21.696, -6.269)), (' D  86  ASP  OD1', ' D 106  LYS  HD2', -0.85, (8.273, 22.265, 3.784)), (' C 167  VAL HG22', ' C 186  VAL HG22', -0.844, (34.027, 20.025, 18.922)), (' N  34  MET  HB3', ' N  81  LEU HD22', -0.815, (-0.103, 58.773, -25.488)), (' F  91  THR HG22', ' F 115  VAL  H  ', -0.81, (-4.694, -22.904, -12.85)), (' F  91  THR  CG2', ' F 115  VAL  H  ', -0.805, (-5.431, -22.206, -13.558)), (' H  99  THR HG21', ' H 113  PHE  HB3', -0.782, (-20.293, -40.589, 39.141)), (' F  89  GLU  O  ', ' F 301  HOH  O  ', -0.77, (-13.908, -21.027, -10.998)), (' N 208  ILE HG22', ' N 223  LYS  HA ', -0.769, (-11.584, 94.5, -41.87)), (' H 132  PRO  HB3', ' H 158  TYR  HB3', -0.765, (-13.192, -70.527, 42.995)), (' F  36  TRP  O  ', ' F  48  VAL HG12', -0.761, (-13.55, -25.062, -0.081)), (' C  72  ARG  HB3', ' C  79  LEU HD12', -0.745, (4.028, 52.627, 0.33)), (' C  91  THR HG23', ' C 114  THR  HA ', -0.742, (9.883, 38.813, 17.39)), (' C  51  ILE HG21', ' C  79  LEU HD11', -0.715, (3.082, 50.516, 1.213)), (' L  37  GLN  HB2', ' L  47  LEU HD11', -0.712, (-24.696, -40.902, 51.852)), (' F 167  VAL  HA ', ' F 186  VAL HG12', -0.712, (13.722, 1.409, -11.607)), (' F 174  LEU HD23', ' F 180  TYR  CE1', -0.706, (-0.198, -13.991, -16.452)), (' E 136  LEU HD12', ' E 182  LEU HD23', -0.705, (-2.81, 3.139, -26.953)), (' F 174  LEU HD23', ' F 180  TYR  CD1', -0.697, (0.348, -13.275, -16.688)), (' D  74  LEU HD22', ' D  76  ILE  CD1', -0.69, (3.493, 21.893, -6.765)), (' A 444  LYS  HG3', ' A 448  ASN  HB2', -0.684, (-16.016, -23.602, 37.454)), (' E 182  LEU  HG ', ' E 184  LEU  CD2', -0.682, (-3.769, 0.233, -27.629)), (' E 182  LEU  HG ', ' E 184  LEU HD21', -0.68, (-3.924, 0.708, -27.642)), (' C 202  VAL  CG2', ' C 211  VAL HG23', -0.678, (30.358, 31.079, 28.353)), (' C  11  LEU HD12', ' C  12  VAL  H  ', -0.675, (11.967, 42.958, 20.842)), (' M 116  VAL HG22', ' M 137  LEU HD13', -0.671, (-1.571, 84.848, -62.167)), (' D  86  ASP  OD1', ' D 106  LYS  HA ', -0.664, (7.277, 21.682, 3.486)), (' D 122  PHE  HB2', ' D 137  VAL HG22', -0.661, (23.009, 15.838, 27.795)), (' C  51  ILE HG21', ' C  79  LEU  CD1', -0.656, (3.343, 50.804, 0.488)), (' F 123  PRO  HB3', ' F 149  TYR  HB3', -0.653, (8.198, -13.182, -21.511)), (' B 410  ILE  O  ', ' B 425  LEU HD12', -0.653, (-14.116, 21.081, -26.201)), (' C  18  LEU HD12', ' C  19  ARG  H  ', -0.653, (10.977, 50.657, 13.886)), (' F 109  GLN  HA ', ' F 109  GLN  OE1', -0.653, (-1.271, -18.916, 4.831)), (' N  19  ARG  O  ', ' N 301  HOH  O  ', -0.65, (4.073, 69.897, -22.098)), (' M 133  VAL  CG2', ' M 180  LEU  HB3', -0.649, (7.033, 93.575, -56.134)), (' L 184  LYS  HE2', ' L 188  GLU  OE2', -0.648, (-9.65, -90.075, 54.787)), (' M 133  VAL HG23', ' M 180  LEU  HB3', -0.645, (6.764, 93.093, -56.164)), (' C 177  SER  HB3', ' C 179  LEU  HG ', -0.644, (13.651, 31.21, 30.433)), (' L  36  TYR  HE1', ' L  89  GLN  HG2', -0.638, (-18.164, -36.031, 45.02)), (' M   9  SER  OG ', ' M 301  HOH  O  ', -0.636, (10.24, 58.338, -52.676)), (' C  52  SER  HB3', ' C  57  SER  HB2', -0.633, (-5.326, 52.296, -1.99)), (' C  18  LEU HD12', ' C  19  ARG  N  ', -0.624, (10.161, 50.293, 14.116)), (' D 199  VAL  C  ', ' D 205  THR HG23', -0.618, (12.49, 6.877, 18.597)), (' C 156  VAL HG23', ' C 202  VAL HG12', -0.612, (30.39, 27.888, 23.89)), (' F 147  LYS  HA ', ' F 181  SER  OG ', -0.606, (4.693, -8.444, -22.518)), (' D 152  TRP  HB2', ' D 159  VAL HG11', -0.606, (9.586, 13.244, 29.09)), (' L  57  GLY  O  ', ' L 301  HOH  O  ', -0.605, (-33.128, -41.667, 48.399)), (' M 199  HIS  HB3', ' M 202  LEU HD12', -0.605, (-1.143, 81.242, -67.699)), (' B 393  THR HG22', ' B 517  LEU  HA ', -0.6, (-29.518, 18.811, -36.253)), (' L 126  LEU  O  ', ' L 184  LYS  HD2', -0.596, (-9.791, -87.003, 51.54)), (' C  77  ASN  ND2', ' C 302  HOH  O  ', -0.595, (13.654, 53.563, -7.554)), (' A 403  ARG  HG3', ' A 495  TYR  CE1', -0.593, (-20.141, -15.039, 28.513)), (' F 150  PHE  CE1', ' F 151  PRO  HB3', -0.59, (3.553, -20.428, -17.017)), (' C 123  PRO  HB3', ' C 149  TYR  HB3', -0.589, (23.023, 31.729, 27.664)), (' N 184  GLN  HG3', ' N 188  LEU  O  ', -0.586, (11.137, 85.412, -43.715)), (' H   5  VAL HG13', ' H 118  GLN HE22', -0.585, (-22.917, -53.727, 33.356)), (' L 114  PRO  HB3', ' L 140  PHE  HB3', -0.583, (-22.504, -63.473, 67.566)), (' F   2  VAL  HA ', ' F  26  GLY  HA3', -0.583, (-0.992, -27.036, 17.073)), (' F 158  TRP  CZ3', ' F 200  CYS  HB3', -0.582, (16.623, -1.362, -18.372)), (' N  69  ARG  NH2', ' N  92  ASP  OD2', -0.582, (17.03, 66.24, -29.792)), (' E  25  THR HG23', ' E  27  SER  H  ', -0.579, (-32.965, -15.128, 2.465)), (' F  48  VAL HG13', ' F  49  SER  N  ', -0.576, (-14.264, -27.504, -1.383)), (' M 151  VAL HG22', ' M 193  TYR  CD2', -0.575, (8.346, 97.551, -60.036)), (' D 150  VAL HG12', ' D 199  VAL HG22', -0.573, (14.481, 12.189, 20.128)), (' A 486  PHE  HB3', ' F  59  TYR  CE1', -0.572, (-20.614, -31.153, 7.43)), (' B 367  VAL  O  ', ' B 701  HOH  O  ', -0.57, (-7.527, 17.16, -45.908)), (' M 101  GLN  NE2', ' M 301  HOH  O  ', -0.566, (9.817, 56.917, -51.833)), (' N 202  LEU HD22', ' N 226  PRO  HG3', -0.565, (-14.21, 96.692, -50.593)), (' M 193  TYR  HB2', ' M 210  PHE  CE2', -0.561, (3.392, 97.984, -59.479)), (' E 132  ASN  HA ', ' E 186  PRO  HG2', -0.56, (3.524, -3.516, -37.15)), (' H  11  LEU  HB2', ' H 160  PRO  HG3', -0.56, (-8.368, -62.907, 37.027)), (' C 105  ASP  C  ', ' C 106  ILE HD13', -0.557, (7.457, 38.763, -7.725)), (' H  99  THR  CG2', ' H 113  PHE  HB3', -0.555, (-20.56, -40.534, 38.972)), (' B 393  THR  HA ', ' B 522  ALA  HA ', -0.555, (-30.281, 20.495, -40.75)), (' D 122  PHE  HB2', ' D 137  VAL  CG2', -0.555, (23.322, 15.819, 27.354)), (' M 137  LEU HD11', ' M 197  VAL HG11', -0.554, (-0.319, 84.165, -63.67)), (' C 146  VAL  CG1', ' C 202  VAL HG11', -0.552, (28.154, 27.518, 26.169)), (' B 393  THR HG21', ' B 518  LEU  H  ', -0.55, (-31.536, 19.526, -35.818)), (' D 136  LEU HD12', ' D 182  LEU HD23', -0.55, (15.361, 13.787, 31.813)), (' N 132  PRO  HB3', ' N 158  TYR  HB3', -0.548, (4.853, 87.436, -38.011)), (' C 146  VAL HG11', ' C 202  VAL HG11', -0.548, (27.984, 28.011, 26.191)), (' C 105  ASP  O  ', ' C 106  ILE HD13', -0.544, (7.357, 38.225, -7.184)), (' D  36  TRP  CE3', ' D  74  LEU HD12', -0.542, (0.249, 25.367, -4.28)), (' C  36  TRP  CD2', ' C  81  LEU HD12', -0.541, (4.924, 45.778, 7.271)), (' E  90  SER  OG ', ' E 100  LEU  O  ', -0.54, (-19.824, -17.587, 4.343)), (' H  69  ARG  NH2', ' H  92  ASP  OD2', -0.54, (-1.224, -49.295, 35.869)), (' L   4  MET  HE3', ' L  23  CYS  SG ', -0.54, (-13.008, -32.404, 50.767)), (' D  16  GLN  HG2', ' D  17  SER  N  ', -0.536, (5.395, 12.006, -8.516)), (' A 483  VAL HG22', ' A 484  GLU  O  ', -0.535, (-23.619, -35.0, 13.655)), (' C 130  PRO  HB3', ' C 141  ALA  O  ', -0.532, (31.739, 12.535, 25.634)), (' H 206  THR HG23', ' H 223  LYS  HD2', -0.53, (-33.27, -78.875, 47.506)), (' N 101  ASP  OD2', ' N 110  HIS  HA ', -0.529, (-3.223, 49.364, -30.057)), (' B 478  THR HG21', ' C  59  TYR  HE2', -0.526, (-9.477, 48.541, -0.241)), (' A 428  ASP  N  ', ' A 428  ASP  OD1', -0.525, (-41.695, -1.97, 26.561)), (' D  13  THR HG22', ' D  16  GLN HE21', -0.523, (8.498, 9.363, -5.972)), (' C 159  ASN  HA ', ' C 199  ILE HD11', -0.522, (40.584, 26.725, 24.53)), (' A 363  ALA  O  ', ' A 527  PRO  HD3', -0.521, (-38.036, -0.926, 51.464)), (' C 199  ILE  O  ', ' C 199  ILE HG13', -0.52, (38.251, 25.271, 25.196)), (' C 130  PRO  HD2', ' C 217  PRO  HA ', -0.519, (34.771, 13.353, 30.478)), (' C  36  TRP  CE2', ' C  81  LEU  HB2', -0.519, (5.886, 48.298, 6.794)), (' H  34  MET  HB3', ' H  81  LEU HD22', -0.518, (-17.883, -42.542, 30.622)), (' N   2  VAL HG12', ' N  27  PHE  HB3', -0.516, (-12.389, 57.379, -26.424)), (' C 172  ALA  HA ', ' C 182  LEU  HB3', -0.514, (20.803, 26.42, 21.301)), (' M 143  ARG  HE ', ' M 164  VAL HG11', -0.513, (3.545, 75.397, -55.953)), (' D  13  THR  H  ', ' D  16  GLN  NE2', -0.512, (7.999, 9.938, -4.979)), (' F 143  GLY  HA2', ' F 158  TRP  CH2', -0.511, (14.117, 0.378, -18.137)), (' E 165  THR HG23', ' E 180  SER  HB2', -0.509, (-4.01, -0.704, -16.035)), (' N 213  HIS  ND1', ' N 216  SER  HB3', -0.508, (4.229, 86.305, -32.569)), (' C  88  ALA  HA ', ' C 115  VAL  HB ', -0.507, (5.768, 39.588, 21.227)), (' A 376  THR  HB ', ' A 435  ALA  HB3', -0.506, (-24.477, -5.356, 36.394)), (' F  91  THR HG22', ' F 114  THR  HA ', -0.506, (-4.578, -22.425, -12.055)), (' N 132  PRO  HA ', ' N 157  ASP  O  ', -0.502, (6.205, 89.587, -37.911)), (' L  89  GLN  HG3', ' L  89  GLN  O  ', -0.5, (-16.591, -33.876, 45.43)), (' H  33  TRP  HE1', ' H  53  ARG  HG2', -0.5, (-19.697, -31.793, 28.077)), (' B 520  ALA  HB1', ' B 521  PRO  HD2', -0.499, (-36.072, 21.669, -39.902)), (' E  93  ASP  HB3', ' E  96  LEU  HG ', -0.499, (-27.924, -20.91, 0.474)), (' B 455  LEU HD11', ' D  54  GLN  HG3', -0.497, (-3.953, 34.417, -15.249)), (' N 172  LEU HD22', ' N 207  TYR  CD1', -0.495, (-14.893, 87.958, -46.796)), (' L 187  TYR  HA ', ' L 193  TYR  OH ', -0.495, (-9.192, -84.526, 61.885)), (' C  67  ARG  HD2', ' C  85  SER  HB2', -0.493, (-1.024, 48.215, 19.932)), (' F  83  MET  HE1', ' F 113  VAL HG11', -0.491, (-6.328, -26.779, -8.162)), (' F  91  THR HG22', ' F 115  VAL  N  ', -0.49, (-4.544, -22.934, -12.618)), (' H  33  TRP  NE1', ' H  53  ARG  HG2', -0.489, (-19.803, -32.335, 28.306)), (' M 211  ASN  O  ', ' M 212  ARG  HB2', -0.486, (1.053, 104.332, -58.517)), (' D  25  THR HG22', ' D  26  TYR  H  ', -0.486, (-17.782, 28.673, 0.516)), (' L  50  ALA  O  ', ' L  51  ALA  HB3', -0.486, (-22.292, -26.261, 48.728)), (' C 157  SER  OG ', ' C 301  HOH  O  ', -0.486, (33.953, 29.551, 17.625)), (' D  38  GLN  HB2', ' D  48  LEU HD11', -0.486, (7.034, 26.941, -5.404)), (' E 196  SER  CA ', ' E 209  THR HG23', -0.486, (-3.453, 10.15, -24.83)), (' E  36  TRP  CD2', ' E  74  LEU  HB2', -0.483, (-17.732, -8.308, 9.87)), (' C 183  SER  HG ', ' D 181  TYR  HH ', -0.483, (21.93, 21.243, 24.302)), (' M 139  ASN HD21', ' N 177  HIS  HE1', -0.482, (-8.491, 79.62, -55.437)), (' C 172  ALA  HB2', ' C 182  LEU HD23', -0.481, (21.503, 28.628, 21.368)), (' A 371  SER  O  ', ' A 372  ALA  HB3', -0.481, (-20.785, -1.446, 48.317)), (' D  13  THR HG22', ' D  16  GLN  NE2', -0.48, (7.83, 9.398, -5.69)), (' A 480  CYS  O  ', ' A 483  VAL HG12', -0.48, (-27.559, -36.044, 11.941)), (' A 342  PHE  HB2', ' I   1  NAG  H82', -0.479, (-28.628, -10.416, 47.697)), (' H 152  GLY  HA2', ' H 167  TRP  CZ2', -0.479, (-25.58, -72.113, 52.13)), (' D  28  ASN  HA ', ' D  92  TRP  O  ', -0.479, (-11.984, 33.539, -0.694)), (' M 116  VAL  HA ', ' M 136  LEU  O  ', -0.479, (-3.226, 86.576, -59.897)), (' C  52  SER  O  ', ' C  72  ARG  NH1', -0.479, (1.252, 52.391, -2.8)), (' F  48  VAL HG13', ' F  49  SER  H  ', -0.479, (-14.47, -27.362, -0.551)), (' E  28  ASN  OD1', ' E  29  ILE  N  ', -0.479, (-28.472, -14.333, 4.758)), (' A 478  THR  HB ', ' A 487  ASN HD21', -0.478, (-26.472, -29.774, 6.283)), (' C   2  VAL HG13', ' C  27  PHE  CD1', -0.477, (10.465, 46.455, -8.325)), (' M 199  HIS  CB ', ' M 202  LEU HD12', -0.476, (-0.884, 81.284, -67.698)), (' E  51  ALA  O  ', ' E  52  ASN  HB2', -0.476, (-23.65, -14.137, 16.432)), (' C 183  SER  OG ', ' D 181  TYR  OH ', -0.474, (21.556, 21.583, 24.152)), (' B 340  GLU  OE1', ' B 356  LYS  NZ ', -0.473, (-18.081, 32.247, -43.776)), (' H 152  GLY  HA2', ' H 167  TRP  CH2', -0.472, (-25.637, -72.674, 51.978)), (' F  47  TRP  CZ3', ' F  61  ALA  HB2', -0.471, (-19.66, -26.088, -1.687)), (' L  19  VAL HG22', ' L  75  ILE  HB ', -0.47, (-25.303, -38.846, 61.018)), (' L  24  ARG  NH1', ' L  25  ALA  O  ', -0.469, (-7.516, -26.865, 53.477)), (' F  35  THR HG21', ' F 104  PHE  CE1', -0.469, (-15.271, -24.401, 6.398)), (' N  20  LEU HD12', ' N  83  LEU HD23', -0.468, (7.018, 65.585, -27.443)), (' D   4  LEU HD11', ' D  91  THR HG22', -0.468, (-7.117, 31.067, 0.739)), (' F  36  TRP  CZ3', ' F  96  CYS  HB2', -0.467, (-6.382, -26.87, 3.251)), (' M 141  TYR  CG ', ' M 142  PRO  HA ', -0.467, (-2.901, 71.852, -63.147)), (' F 219  SER  O  ', ' F 219  SER  OG ', -0.467, (16.298, 8.275, -32.936)), (' N 165  VAL HG21', ' N 193  SER  OG ', -0.467, (-3.953, 84.112, -43.79)), (' N 172  LEU HD21', ' N 195  VAL HG21', -0.465, (-13.096, 86.25, -48.246)), (' B 381  GLY  O  ', ' B 382  VAL HG13', -0.465, (-21.301, 12.095, -32.695)), (' B 371  SER  O  ', ' B 372  ALA  HB3', -0.464, (-1.746, 17.657, -43.755)), (' M  49  TYR  O  ', ' M  53  SER  HB2', -0.463, (-7.422, 45.81, -41.668)), (' E  38  GLN  HB2', ' E  48  LEU HD11', -0.462, (-10.463, -9.096, 10.415)), (' D  51  ALA  O  ', ' D  52  ASN  HB2', -0.462, (-6.447, 30.862, -11.966)), (' N  53  ARG  HD2', ' N 306  HOH  O  ', -0.462, (-5.652, 47.629, -20.034)), (' A 368  LEU  O  ', ' A 371  SER  OG ', -0.461, (-26.418, -2.307, 46.991)), (' C 139  THR  HA ', ' C 189  PRO  HA ', -0.46, (36.814, 8.377, 19.489)), (' D 121  LEU HD13', ' D 138  CYS  HB2', -0.459, (18.747, 12.43, 26.578)), (' C  11  LEU HD12', ' C  12  VAL  N  ', -0.459, (12.704, 43.339, 21.341)), (' A 358  ILE HD11', ' A 397  ALA  HB2', -0.459, (-36.795, -10.387, 43.228)), (' F  86  LEU  HB3', ' F 115  VAL HG21', -0.459, (-7.638, -26.81, -13.345)), (' E  95  SER  C  ', ' E  96  LEU HD23', -0.458, (-28.872, -23.546, -1.74)), (' E  98  GLY  HA3', ' F  47  TRP  CE3', -0.458, (-20.945, -25.118, 0.93)), (' H  33  TRP  CD1', ' H  53  ARG  HG2', -0.458, (-19.789, -32.68, 28.661)), (' B 384  PRO  HA ', ' B 387  LEU HD12', -0.458, (-15.041, 13.574, -39.049)), (' C  17  SER  HA ', ' C  86  LEU HD23', -0.458, (5.847, 49.209, 18.728)), (' B 417  LYS  HD2', ' B 453  TYR  CD1', -0.457, (-5.876, 33.745, -18.708)), (' C 202  VAL HG22', ' C 211  VAL HG23', -0.457, (30.685, 30.432, 28.558)), (' F  53  GLY  HA2', ' F  72  ARG  NH1', -0.456, (-13.067, -34.9, 10.834)), (' E 196  SER  HB2', ' E 209  THR HG23', -0.455, (-3.71, 11.262, -24.892)), (' A 358  ILE HG22', ' A 361  CYS  SG ', -0.454, (-41.232, -9.434, 48.936)), (' B 417  LYS  HG3', ' B 723  HOH  O  ', -0.453, (-7.412, 32.572, -15.518)), (' M 187  TYR  HA ', ' M 193  TYR  OH ', -0.453, (9.308, 101.479, -56.768)), (' M  12  SER  OG ', ' M 108  LYS  HG3', -0.451, (-1.792, 64.565, -62.774)), (' C 143  GLY  HA2', ' C 158  TRP  CH2', -0.45, (32.067, 20.359, 24.837)), (' A 417  LYS  HD2', ' A 453  TYR  CD1', -0.45, (-23.732, -18.061, 23.547)), (' B 439  ASN  O  ', ' B 443  SER  HB2', -0.449, (4.6, 33.716, -34.365)), (' M 152  ASP  HA ', ' M 192  VAL  CG2', -0.449, (7.268, 100.829, -65.601)), (' M   4  MET  HE3', ' M  23  CYS  SG ', -0.448, (5.764, 48.883, -45.637)), (' F 196  GLN  HG2', ' F 198  TYR  CZ ', -0.448, (22.026, 6.153, -15.721)), (' E  98  GLY  HA3', ' F  47  TRP  CZ3', -0.448, (-21.009, -25.439, 1.107)), (' A 388  ASN  HB3', ' A 527  PRO  HD2', -0.447, (-37.702, 2.232, 51.339)), (' N 197  VAL HG11', ' N 207  TYR  CZ ', -0.447, (-15.792, 89.528, -49.391)), (' A 395  VAL  HA ', ' A 514  SER  O  ', -0.446, (-41.745, -7.085, 40.655)), (' A 338  PHE  CE1', ' A 358  ILE HD13', -0.446, (-36.921, -8.668, 45.953)), (' H  53  ARG  HG3', ' H  56  ASP  HB2', -0.445, (-19.229, -31.172, 26.418)), (' E  18  VAL HG22', ' E  19  SER  N  ', -0.443, (-16.82, 0.584, 9.656)), (' F 158  TRP  CH2', ' F 200  CYS  HB3', -0.442, (16.117, -1.457, -18.12)), (' F 157  SER  OG ', ' F 201  ASN  HB2', -0.442, (19.537, -7.794, -14.388)), (' H  75  ASP  OD1', ' H  77  SER  OG ', -0.442, (-20.616, -45.431, 17.887)), (' A 338  PHE  HE1', ' A 358  ILE HD13', -0.441, (-36.857, -8.653, 45.704)), (' C 154  VAL  CG2', ' C 182  LEU HD21', -0.441, (24.325, 29.279, 21.639)), (' L 124  GLU  N  ', ' L 124  GLU  OE1', -0.441, (-18.742, -84.501, 49.634)), (' H 156  LYS  HA ', ' H 190  SER  HB2', -0.439, (-12.253, -71.582, 49.477)), (' E 121  LEU HD13', ' E 138  CYS  HB2', -0.439, (-0.143, 4.887, -21.018)), (' C 149  TYR  CE1', ' C 154  VAL HG13', -0.439, (22.978, 32.398, 22.994)), (' D 200  THR HG23', ' D 205  THR  OG1', -0.438, (10.107, 5.467, 17.248)), (' H  17  SER  OG ', ' H  86  SER  HA ', -0.437, (-2.036, -51.652, 28.59)), (' A 357  ARG  HG2', ' A 359  SER  OG ', -0.436, (-44.739, -13.26, 45.04)), (' B 379  CYS  HA ', ' B 432  CYS  HA ', -0.436, (-14.799, 16.814, -32.604)), (' F 174  LEU HD13', ' F 175  GLN  O  ', -0.436, (-4.122, -13.424, -19.793)), (' F 216  GLU  HB3', ' F 217  PRO  HD2', -0.435, (20.562, 6.009, -26.281)), (' B 363  ALA  O  ', ' B 527  PRO  HD3', -0.435, (-18.833, 16.772, -46.377)), (' A 497  PHE  CD2', ' A 507  PRO  HB3', -0.435, (-18.838, -17.413, 34.717)), (' N 172  LEU HD22', ' N 207  TYR  HD1', -0.435, (-14.839, 88.484, -46.188)), (' N  93  THR HG23', ' N 123  THR  HA ', -0.434, (11.124, 73.405, -34.849)), (' C  47  TRP  CE3', ' D  98  GLY  HA3', -0.434, (-5.515, 41.532, 4.442)), (' N  39  GLN  C  ', ' N  94  ALA  HB1', -0.434, (7.865, 66.773, -37.159)), (' A 363  ALA  O  ', ' A 526  GLY  HA2', -0.433, (-38.975, -1.138, 51.28)), (' N  33  TRP  CE3', ' N  50  ARG  HD2', -0.432, (1.583, 49.809, -27.56)), (' C 130  PRO  HG3', ' C 142  LEU  HB3', -0.432, (33.966, 13.764, 27.085)), (' F  98  LYS  HE2', ' F 105  ASP  OD1', -0.431, (-11.331, -24.138, 14.085)), (' B 446  GLY  HA3', ' M  95  PRO  HD3', -0.431, (8.464, 44.106, -29.268)), (' D  48  LEU  O  ', ' D  56  PRO  HD2', -0.431, (3.56, 30.89, -11.088)), (' D 137  VAL HG12', ' D 181  TYR  CD2', -0.431, (19.806, 20.01, 27.426)), (' L 125  GLN  HG2', ' L 130  THR  O  ', -0.43, (-11.242, -81.83, 52.093)), (' D 198  GLN  HG2', ' D 207  GLU  HG3', -0.43, (14.22, 5.263, 24.965)), (' L  94  THR  N  ', ' L  95  PRO  HD2', -0.43, (-9.974, -28.617, 36.998)), (' H   6  GLU  OE2', ' H 117  GLY  HA3', -0.429, (-20.778, -48.945, 36.534)), (' C 159  ASN  HA ', ' C 199  ILE  CG1', -0.429, (39.961, 25.841, 25.149)), (' N  50  ARG  HG2', ' N  51  ILE  N  ', -0.429, (3.275, 53.228, -25.658)), (' H  50  ARG  HG2', ' H  51  ILE  N  ', -0.428, (-14.603, -36.721, 31.004)), (' L 181  THR  O  ', ' L 182  LEU HD23', -0.427, (-5.844, -77.734, 59.15)), (' H  85  MET  HE1', ' H 122  VAL HG11', -0.427, (-7.954, -53.176, 34.514)), (' M 139  ASN HD21', ' N 177  HIS  CE1', -0.425, (-8.379, 79.491, -54.896)), (' D  16  GLN  CG ', ' D  17  SER  N  ', -0.424, (5.664, 11.572, -8.328)), (' C  81  LEU HD22', ' C  83  MET  HG2', -0.424, (4.374, 47.611, 11.568)), (' B 414  GLN  HB3', ' B 414  GLN HE21', -0.423, (-9.632, 20.18, -18.533)), (' H  99  THR HG23', ' H 115  ILE  O  ', -0.422, (-22.105, -42.409, 38.166)), (' H 165  VAL  HA ', ' H 210  ASN  O  ', -0.421, (-23.712, -67.929, 44.592)), (' F 172  ALA  HA ', ' F 182  LEU  HB3', -0.421, (4.46, -7.606, -15.071)), (' M 184  LYS  O  ', ' M 188  GLU  HG3', -0.421, (9.943, 105.199, -51.571)), (' M 151  VAL HG22', ' M 193  TYR  HD2', -0.42, (7.855, 97.124, -59.343)), (' M  89  GLN  HB2', ' M  99  PHE  CD2', -0.419, (3.167, 54.102, -40.324)), (' D 149  THR  OG1', ' D 200  THR  HB ', -0.419, (8.881, 9.752, 17.082)), (' M 137  LEU HD11', ' M 197  VAL HG21', -0.419, (-0.11, 84.871, -62.6)), (' M 137  LEU  HB2', ' M 176  LEU  HB3', -0.418, (-0.075, 81.994, -58.458)), (' N 197  VAL HG11', ' N 207  TYR  CE1', -0.418, (-15.444, 88.913, -49.323)), (' C 146  VAL  O  ', ' C 146  VAL HG23', -0.418, (23.229, 27.082, 26.46)), (' F 174  LEU HD23', ' F 180  TYR  CZ ', -0.418, (-0.298, -14.687, -15.889)), (' E  49  ILE HD13', ' E  55  ARG  HG3', -0.417, (-16.366, -11.116, 17.703)), (' F 174  LEU HD22', ' F 179  LEU  O  ', -0.417, (-0.869, -13.176, -18.924)), (' H  32  ALA  O  ', ' H  74  ARG  NH2', -0.416, (-20.058, -37.268, 27.722)), (' H  74  ARG  HD3', ' H  76  ASP  OD1', -0.416, (-20.338, -39.514, 23.282)), (' N  11  LEU  HB2', ' N 160  PRO  HG3', -0.415, (9.644, 79.652, -31.644)), (' M  50  ALA  O  ', ' M  51  ALA  HB3', -0.415, (-4.451, 42.844, -43.361)), (' F 172  ALA  HB2', ' F 182  LEU HD23', -0.414, (5.568, -9.674, -14.52)), (' C 204  HIS  O  ', ' C 208  ASN  N  ', -0.413, (27.53, 39.354, 26.422)), (' F 139  THR  N  ', ' F 190  SER  OG ', -0.413, (15.251, 15.359, -15.4)), (' F  64  VAL HG21', ' F  68  PHE  CD2', -0.412, (-13.613, -28.932, -5.939)), (' E  64  SER  OG ', ' E  75  ALA  HB3', -0.412, (-18.806, -3.469, 16.307)), (' N 163  VAL HG12', ' N 213  HIS  CD2', -0.412, (2.868, 83.612, -35.551)), (' A 389  ASP  HA ', ' A 528  GLY  O  ', -0.412, (-42.11, 4.696, 50.713)), (' B 392  PHE  CD1', ' B 515  PHE  HB3', -0.411, (-24.113, 17.491, -35.938)), (' B 347  PHE  CE2', ' B 399  SER  HB2', -0.41, (-10.343, 30.659, -35.478)), (' L 159  ASN  N  ', ' L 159  ASN  OD1', -0.41, (-4.159, -73.707, 62.377)), (' A 490  PHE  CE2', ' A 492  LEU  HB2', -0.409, (-26.379, -26.928, 25.013)), (' M 152  ASP  HA ', ' M 192  VAL HG22', -0.409, (6.98, 101.278, -65.438)), (' C  81  LEU HD22', ' C  83  MET  CG ', -0.409, (4.845, 47.785, 12.005)), (' F 143  GLY  HA2', ' F 158  TRP  HH2', -0.408, (14.514, 0.18, -18.208)), (' B 393  THR  CG2', ' B 518  LEU  H  ', -0.408, (-31.143, 19.784, -36.11)), (' B 396  TYR  HB2', ' B 514  SER  OG ', -0.408, (-21.726, 24.944, -33.207)), (' D 136  LEU  HB2', ' D 182  LEU  HB3', -0.407, (15.992, 15.526, 30.861)), (' D 124  PRO  HD3', ' D 136  LEU  CD2', -0.407, (20.201, 13.542, 33.427)), (' C 205  LYS  C  ', ' C 208  ASN  H  ', -0.406, (27.172, 40.837, 25.261)), (' C  47  TRP  CZ3', ' D  98  GLY  HA3', -0.406, (-5.864, 41.914, 4.459)), (' M  97  ILE  HB ', ' N  47  TRP  CD2', -0.405, (6.738, 53.316, -33.345)), (' M 202  LEU HD22', ' M 206  VAL  CG2', -0.404, (-3.532, 86.181, -69.123)), (' M 113  ALA  HA ', ' M 114  PRO  HD3', -0.404, (-4.923, 79.916, -66.551)), (' F  48  VAL  CG1', ' F  49  SER  N  ', -0.403, (-14.36, -26.76, -1.125)), (' C   5  LEU  O  ', ' C  22  CYS  HA ', -0.403, (13.101, 47.836, 2.594)), (' N 213  HIS  CD2', ' N 215  PRO  HD2', -0.402, (3.288, 82.677, -33.307)), (' D  79  LEU HD21', ' D 107  LEU HD21', -0.401, (7.537, 17.778, -4.868)), (' H 183  LEU  HA ', ' H 183  LEU HD12', -0.401, (-6.962, -66.173, 49.271)), (' E 124  PRO  HD3', ' E 136  LEU HD23', -0.4, (2.382, 3.427, -28.174)), (' E  82  GLU  CD ', ' E  82  GLU  H  ', -0.4, (-2.063, -2.438, 13.143)), (' C  39  GLN  C  ', ' C  92  ALA  HB1', -0.4, (6.354, 36.195, 10.722))]
handle_read_draw_probe_dots_unformatted("molprobity_probe.txt", 0, 0)
show_probe_dots(True, True)
gui = coot_molprobity_todo_list_gui(data=data)
