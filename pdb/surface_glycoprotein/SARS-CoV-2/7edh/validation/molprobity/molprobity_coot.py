# script auto-generated by phenix.molprobity


from __future__ import absolute_import, division, print_function
from six.moves import cPickle as pickle
from six.moves import range
try :
  import gobject
except ImportError :
  gobject = None
import sys

class coot_extension_gui(object):
  def __init__(self, title):
    import gtk
    self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)
    scrolled_win = gtk.ScrolledWindow()
    self.outside_vbox = gtk.VBox(False, 2)
    self.inside_vbox = gtk.VBox(False, 0)
    self.window.set_title(title)
    self.inside_vbox.set_border_width(0)
    self.window.add(self.outside_vbox)
    self.outside_vbox.pack_start(scrolled_win, True, True, 0)
    scrolled_win.add_with_viewport(self.inside_vbox)
    scrolled_win.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)

  def finish_window(self):
    import gtk
    self.outside_vbox.set_border_width(2)
    ok_button = gtk.Button("  Close  ")
    self.outside_vbox.pack_end(ok_button, False, False, 0)
    ok_button.connect("clicked", lambda b: self.destroy_window())
    self.window.connect("delete_event", lambda a, b: self.destroy_window())
    self.window.show_all()

  def destroy_window(self, *args):
    self.window.destroy()
    self.window = None

  def confirm_data(self, data):
    for data_key in self.data_keys :
      outlier_list = data.get(data_key)
      if outlier_list is not None and len(outlier_list) > 0 :
        return True
    return False

  def create_property_lists(self, data):
    import gtk
    for data_key in self.data_keys :
      outlier_list = data[data_key]
      if outlier_list is None or len(outlier_list) == 0 :
        continue
      else :
        frame = gtk.Frame(self.data_titles[data_key])
        vbox = gtk.VBox(False, 2)
        frame.set_border_width(6)
        frame.add(vbox)
        self.add_top_widgets(data_key, vbox)
        self.inside_vbox.pack_start(frame, False, False, 5)
        list_obj = residue_properties_list(
          columns=self.data_names[data_key],
          column_types=self.data_types[data_key],
          rows=outlier_list,
          box=vbox)

# Molprobity result viewer
class coot_molprobity_todo_list_gui(coot_extension_gui):
  data_keys = [ "rama", "rota", "cbeta", "probe" ]
  data_titles = { "rama"  : "Ramachandran outliers",
                  "rota"  : "Rotamer outliers",
                  "cbeta" : "C-beta outliers",
                  "probe" : "Severe clashes" }
  data_names = { "rama"  : ["Chain", "Residue", "Name", "Score"],
                 "rota"  : ["Chain", "Residue", "Name", "Score"],
                 "cbeta" : ["Chain", "Residue", "Name", "Conf.", "Deviation"],
                 "probe" : ["Atom 1", "Atom 2", "Overlap"] }
  if (gobject is not None):
    data_types = { "rama" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "rota" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "cbeta" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT],
                   "probe" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT] }
  else :
    data_types = dict([ (s, []) for s in ["rama","rota","cbeta","probe"] ])

  def __init__(self, data_file=None, data=None):
    assert ([data, data_file].count(None) == 1)
    if (data is None):
      data = load_pkl(data_file)
    if not self.confirm_data(data):
      return
    coot_extension_gui.__init__(self, "MolProbity to-do list")
    self.dots_btn = None
    self.dots2_btn = None
    self._overlaps_only = True
    self.window.set_default_size(420, 600)
    self.create_property_lists(data)
    self.finish_window()

  def add_top_widgets(self, data_key, box):
    import gtk
    if data_key == "probe" :
      hbox = gtk.HBox(False, 2)
      self.dots_btn = gtk.CheckButton("Show Probe dots")
      hbox.pack_start(self.dots_btn, False, False, 5)
      self.dots_btn.connect("toggled", self.toggle_probe_dots)
      self.dots2_btn = gtk.CheckButton("Overlaps only")
      hbox.pack_start(self.dots2_btn, False, False, 5)
      self.dots2_btn.connect("toggled", self.toggle_all_probe_dots)
      self.dots2_btn.set_active(True)
      self.toggle_probe_dots()
      box.pack_start(hbox, False, False, 0)

  def toggle_probe_dots(self, *args):
    if self.dots_btn is not None :
      show_dots = self.dots_btn.get_active()
      overlaps_only = self.dots2_btn.get_active()
      if show_dots :
        self.dots2_btn.set_sensitive(True)
      else :
        self.dots2_btn.set_sensitive(False)
      show_probe_dots(show_dots, overlaps_only)

  def toggle_all_probe_dots(self, *args):
    if self.dots2_btn is not None :
      self._overlaps_only = self.dots2_btn.get_active()
      self.toggle_probe_dots()

class rsc_todo_list_gui(coot_extension_gui):
  data_keys = ["by_res", "by_atom"]
  data_titles = ["Real-space correlation by residue",
                 "Real-space correlation by atom"]
  data_names = {}
  data_types = {}

class residue_properties_list(object):
  def __init__(self, columns, column_types, rows, box,
      default_size=(380,200)):
    assert len(columns) == (len(column_types) - 1)
    if (len(rows) > 0) and (len(rows[0]) != len(column_types)):
      raise RuntimeError("Wrong number of rows:\n%s" % str(rows[0]))
    import gtk
    self.liststore = gtk.ListStore(*column_types)
    self.listmodel = gtk.TreeModelSort(self.liststore)
    self.listctrl = gtk.TreeView(self.listmodel)
    self.listctrl.column = [None]*len(columns)
    self.listctrl.cell = [None]*len(columns)
    for i, column_label in enumerate(columns):
      cell = gtk.CellRendererText()
      column = gtk.TreeViewColumn(column_label)
      self.listctrl.append_column(column)
      column.set_sort_column_id(i)
      column.pack_start(cell, True)
      column.set_attributes(cell, text=i)
    self.listctrl.get_selection().set_mode(gtk.SELECTION_SINGLE)
    for row in rows :
      self.listmodel.get_model().append(row)
    self.listctrl.connect("cursor-changed", self.OnChange)
    sw = gtk.ScrolledWindow()
    w, h = default_size
    if len(rows) > 10 :
      sw.set_size_request(w, h)
    else :
      sw.set_size_request(w, 30 + (20 * len(rows)))
    sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
    box.pack_start(sw, False, False, 5)
    inside_vbox = gtk.VBox(False, 0)
    sw.add(self.listctrl)

  def OnChange(self, treeview):
    import coot # import dependency
    selection = self.listctrl.get_selection()
    (model, tree_iter) = selection.get_selected()
    if tree_iter is not None :
      row = model[tree_iter]
      xyz = row[-1]
      if isinstance(xyz, tuple) and len(xyz) == 3 :
        set_rotation_centre(*xyz)
        set_zoom(30)
        graphics_draw()

def show_probe_dots(show_dots, overlaps_only):
  import coot # import dependency
  n_objects = number_of_generic_objects()
  sys.stdout.flush()
  if show_dots :
    for object_number in range(n_objects):
      obj_name = generic_object_name(object_number)
      if overlaps_only and not obj_name in ["small overlap", "bad overlap"] :
        sys.stdout.flush()
        set_display_generic_object(object_number, 0)
      else :
        set_display_generic_object(object_number, 1)
  else :
    sys.stdout.flush()
    for object_number in range(n_objects):
      set_display_generic_object(object_number, 0)

def load_pkl(file_name):
  pkl = open(file_name, "rb")
  data = pickle.load(pkl)
  pkl.close()
  return data

data = {}
data['rama'] = [('A', '  95 ', 'LYS', 0.003922074397718575, (146.8159999999999, 214.3, 230.85300000000007)), ('A', ' 566 ', 'ILE', 0.0063626898762271285, (213.0530000000001, 182.636, 213.759)), ('B', '  95 ', 'LYS', 0.008251028796444033, (242.5640000000001, 153.981, 227.92700000000002)), ('B', ' 342 ', 'THR', 0.007074087962182075, (235.0810000000001, 232.2120000000001, 268.059)), ('B', ' 689 ', 'ILE', 0.05545992639648524, (245.24500000000012, 190.098, 195.567)), ('C', ' 475 ', 'THR', 0.015313178271381353, (188.43500000000012, 177.06699999999998, 258.175)), ('C', ' 689 ', 'ILE', 0.05083800291787495, (212.372, 250.958, 195.451)), ('C', ' 847 ', 'ILE', 0.08993059643871397, (244.2600000000001, 212.367, 204.53700000000006))]
data['omega'] = []
data['rota'] = [('A', ' 961 ', 'LYS', 0.0, (193.71000000000012, 218.955, 217.37200000000004)), ('B', ' 567 ', 'ASP', 0.08762375464719904, (231.7790000000001, 225.681, 218.01300000000006)), ('B', ' 851 ', 'LYS', 0.0, (203.961, 186.704, 213.60700000000006)), ('C', ' 961 ', 'LYS', 0.0, (226.5210000000001, 223.15, 215.973))]
data['cbeta'] = []
data['probe'] = [(' B 428  GLY  HA3', ' B 510  LEU  O  ', -0.97, (228.335, 226.645, 248.12)), (' C 428  GLY  HA3', ' C 510  LEU  O  ', -0.898, (192.238, 219.273, 249.338)), (' B 710  ALA  HB3', ' C 891  LEU  HB3', -0.744, (231.496, 203.874, 158.28)), (' C 161  ASN HD21', ' W   1  NAG  H62', -0.738, (233.712, 254.287, 262.333)), (' A 122  THR HG22', ' A 123  ASN  H  ', -0.698, (154.968, 226.724, 245.487)), (' A1123  CYS  HB2', ' A1129  ILE HD13', -0.691, (208.562, 187.538, 141.64)), (' B 388  CYS  HB2', ' B 522  CYS  HA ', -0.682, (242.009, 224.253, 242.462)), (' A1016  ARG  NH2', ' C1014  GLU  OE1', -0.677, (212.912, 216.787, 193.671)), (' B 137  PRO  HA ', ' B 155  ARG  O  ', -0.676, (244.934, 159.089, 249.154)), (' C 307  LYS  HG2', ' C 661  ILE HD11', -0.672, (215.798, 242.077, 194.733)), (' C 326  PHE  O  ', ' C 577  GLN  NE2', -0.664, (181.459, 240.7, 239.467)), (' B 722  GLU  OE2', ' B1061  HIS  NE2', -0.66, (214.273, 197.165, 177.06)), (' A 314  ASN  ND2', ' B 734  ASP  OD2', -0.656, (194.339, 194.495, 215.519)), (' A 140  GLY  HA2', ' A 241  LEU  HB2', -0.653, (143.929, 213.775, 246.315)), (' B 343  ARG  HA ', ' B 506  ARG HH12', -0.653, (230.781, 231.569, 266.787)), (' B1084  ALA  HB2', ' B1123  CYS  HB3', -0.645, (226.754, 221.491, 140.261)), (' B 128  VAL HG21', ' B 228  ILE HD11', -0.637, (231.353, 172.697, 247.26)), (' C 376  CYS  HB2', ' C 381  PRO  HG3', -0.635, (200.77, 223.81, 249.288)), (' C 129  CYS  HB3', ' C 163  CYS  HA ', -0.634, (239.413, 250.544, 254.359)), (' A  61  ASN  HB3', ' A2001  NAG  N2 ', -0.624, (162.869, 195.986, 222.85)), (' A 134  CYS  SG ', ' A 155  ARG  NH2', -0.623, (151.581, 208.996, 256.873)), (' C 990  ILE  O  ', ' C 994  ILE HG12', -0.622, (222.725, 210.565, 227.516)), (' C 473  GLY  HA2', ' C 480  VAL  HA ', -0.621, (184.474, 179.675, 262.459)), (' B 290  LEU  HG ', ' B 291  ASP  H  ', -0.62, (241.279, 185.043, 212.566)), (' C 388  CYS  HA ', ' C 522  CYS  HB3', -0.619, (187.907, 231.232, 243.543)), (' C 454  ARG  H  ', ' C 454  ARG  HD3', -0.616, (192.094, 191.794, 258.367)), (' B 376  CYS  HB3', ' B 381  PRO  HG3', -0.616, (229.641, 216.465, 249.07)), (' B 140  GLY  O  ', ' B 152  SER  N  ', -0.607, (240.292, 149.831, 246.091)), (' B 339  PHE  HE1', ' B 508  VAL HG11', -0.601, (232.871, 226.66, 257.06)), (' C 480  VAL HG23', ' C 481  GLU  H  ', -0.601, (186.905, 179.844, 266.331)), (' B 191  PHE  HD1', ' B 200  ILE HD12', -0.598, (233.79, 169.169, 236.288)), (' B 498  TYR  HE1', ' B 502  TYR  HB3', -0.597, (215.275, 223.296, 271.574)), (' C 380  SER  HB3', ' C 383  LYS  HB2', -0.596, (200.065, 228.904, 243.793)), (' A 129  CYS  HB3', ' A 131  PHE  HE1', -0.595, (163.144, 215.347, 254.969)), (' C 350  TRP  O  ', ' C 463  ARG  NH1', -0.593, (183.214, 210.215, 257.71)), (' C 393  TYR  HB2', ' C 511  SER  HB3', -0.593, (187.12, 218.18, 248.957)), (' C 228  ILE HG13', ' C 229  GLY  H  ', -0.591, (234.128, 245.242, 243.872)), (' C 126  ILE HG21', ' C 226  LEU HD21', -0.59, (239.913, 249.313, 242.816)), (' A  34  ARG  NH1', ' A 218  SER  OG ', -0.59, (162.201, 213.319, 223.263)), (' C 575  ASP  OD2', ' C 578  THR  OG1', -0.589, (177.994, 242.593, 232.418)), (' C 300  LEU HD12', ' C 305  VAL HG12', -0.586, (221.887, 239.328, 203.711)), (' B 774  ASN  OD1', ' B1016  ARG  NH1', -0.586, (201.694, 203.764, 190.593)), (' B1008  GLN  OE1', ' B1011  ARG  NH1', -0.585, (210.654, 199.001, 203.784)), (' A 137  PRO  HA ', ' A 155  ARG  O  ', -0.584, (151.327, 208.869, 251.593)), (' B 400  ARG HH22', ' B 494  PHE  HB3', -0.583, (218.085, 228.195, 272.785)), (' C 270  ARG  NH1', ' C 287  ASP  OD2', -0.581, (221.926, 248.904, 219.106)), (' B 124  VAL HG13', ' B 171  PRO  HA ', -0.58, (229.162, 158.252, 238.16)), (' A 227  PRO  HB2', ' C 354  ARG  NH1', -0.577, (177.732, 219.075, 247.127)), (' C 452  LEU  HB2', ' C 490  GLN HE22', -0.573, (194.369, 198.312, 264.445)), (' A 863  THR HG22', ' A 866  MET  HE2', -0.572, (198.159, 237.236, 188.632)), (' C 850  GLN  N  ', ' C 850  GLN  OE1', -0.57, (239.135, 213.267, 209.138)), (' C 347  VAL HG21', ' C 415  ILE HD11', -0.57, (193.046, 205.882, 261.488)), (' A  98  ILE HG23', ' A 240  ALA  HB3', -0.569, (146.655, 213.074, 241.554)), (' C 453  PHE  HZ ', ' C 486  TYR  HB2', -0.566, (191.243, 190.433, 266.478)), (' A 156  VAL HG23', ' A 157  TYR  HD1', -0.565, (155.595, 213.333, 253.243)), (' B 355  ILE  HB ', ' B 392  VAL HG22', -0.564, (237.242, 230.475, 249.017)), (' C 995  THR  O  ', ' C 999  GLN  HG2', -0.564, (217.333, 212.68, 220.984)), (' C 716  THR  HA ', ' C 923  GLN HE22', -0.563, (221.91, 232.029, 161.197)), (' C 475  THR  H  ', ' C 476  PRO  HD3', -0.563, (187.385, 178.37, 256.855)), (' B 342  THR  OG1', ' B 343  ARG  N  ', -0.56, (233.799, 233.582, 267.367)), (' C 609  TYR  O  ', ' C 645  GLY  HA3', -0.556, (201.603, 242.403, 204.744)), (' B  53  ASP  HB3', ' B  55  PHE  CE1', -0.555, (230.291, 181.33, 225.066)), (' B  98  ILE HG23', ' B 240  ALA  HB3', -0.554, (243.908, 153.944, 238.71)), (' B 423  PRO  HD3', ' B 460  PRO  HB3', -0.551, (220.505, 232.241, 245.821)), (' B 498  TYR  OH ', ' B 502  TYR  O  ', -0.55, (217.358, 225.349, 271.294)), (' B 330  THR  HA ', ' B 359  VAL HG21', -0.548, (249.599, 225.519, 246.367)), (' A 128  VAL HG12', ' A 165  PHE  HB3', -0.543, (168.858, 217.15, 251.778)), (' B 108  LEU  HG ', ' B 234  ARG HH21', -0.542, (245.266, 172.728, 248.49)), (' C 532  LYS  NZ ', ' C 551  GLU  OE1', -0.54, (179.058, 245.45, 224.112)), (' C 660  ASP  HB2', ' C 670  SER  HB3', -0.538, (212.087, 244.374, 190.56)), (' C 718  SER  OG ', ' C1063  THR  OG1', -0.537, (219.881, 228.15, 168.857)), (' A 902  ARG  NH1', ' A1046  LEU  O  ', -0.536, (198.715, 218.519, 166.661)), (' B 723  ILE HG12', ' B1058  VAL HG22', -0.535, (213.506, 190.515, 184.211)), (' B 974  LEU HD23', ' B 978  LEU HD23', -0.532, (202.299, 194.161, 232.037)), (' A 277  ASN  ND2', ' A 281  THR  OG1', -0.532, (168.639, 223.942, 215.944)), (' C 571  ASP  OD1', ' C 572  ALA  N  ', -0.532, (182.755, 232.646, 222.05)), (' B 799  PHE  HD1', ' B 802  ILE HD11', -0.532, (207.462, 184.901, 170.815)), (' B 104  PHE  HB2', ' B 115  LEU  HB2', -0.531, (236.108, 171.476, 244.033)), (' A1102  THR HG22', ' A1109  PRO  HA ', -0.531, (193.961, 200.977, 146.416)), (' B 292  PRO  HB2', ' B 605  VAL HG21', -0.531, (240.316, 189.443, 206.415)), (' B 292  PRO  O  ', ' B 296  THR HG23', -0.53, (236.971, 189.298, 208.205)), (' A 274  LEU HD22', ' A 282  ILE HD13', -0.53, (172.314, 215.901, 220.574)), (' A 789  PRO  HG3', ' C 704  TYR  HB3', -0.53, (193.412, 235.941, 162.795)), (' B 732  SER  OG ', ' B 856  THR  OG1', -0.528, (198.101, 194.126, 208.938)), (' B 767  ILE  O  ', ' B 771  GLN  HG2', -0.528, (201.033, 200.626, 198.303)), (' B 376  CYS  HA ', ' B 429  CYS  HB2', -0.526, (226.751, 220.277, 249.924)), (' B 387  LEU HD11', ' C 980  ARG  HG2', -0.524, (233.876, 218.357, 237.823)), (' C 355  ILE  HB ', ' C 392  VAL  HB ', -0.524, (184.446, 223.979, 250.914)), (' B 703  ALA  HB2', ' S   2  NAG  H5 ', -0.523, (242.632, 204.754, 159.435)), (' C 228  ILE HG13', ' C 229  GLY  N  ', -0.521, (233.907, 244.595, 244.419)), (' A 123  ASN HD21', ' A 168  VAL HG22', -0.52, (161.432, 226.255, 248.805)), (' B 390  THR  O  ', ' B 520  THR  OG1', -0.519, (240.591, 231.168, 242.892)), (' A  94  GLU  O  ', ' A  96  SER  N  ', -0.519, (147.596, 213.534, 232.601)), (' A 961  LYS  HG3', ' A 961  LYS  O  ', -0.517, (193.192, 217.444, 218.67)), (' B 203  LYS  HE3', ' B 218  SER  HB2', -0.517, (231.805, 165.511, 220.396)), (' A  64  TRP  HD1', ' A  65  PHE  N  ', -0.516, (153.648, 200.681, 231.91)), (' B 608  LEU HD12', ' B 647  LEU HD21', -0.516, (242.671, 199.261, 199.765)), (' B 123  ASN HD21', ' B 168  VAL HG22', -0.515, (225.364, 159.469, 245.538)), (' C 106  THR  HA ', ' C 233  THR HG22', -0.514, (225.793, 255.48, 245.108)), (' A 126  ILE HD13', ' A 226  LEU HD11', -0.512, (166.313, 219.038, 244.034)), (' A  81  VAL HG11', ' A 234  ARG  HE ', -0.511, (162.428, 199.22, 246.375)), (' C 802  ILE HD11', ' C 928  ILE HD11', -0.509, (232.543, 224.518, 171.224)), (' B 865  GLU  OE1', ' B 869  GLN  NE2', -0.509, (193.313, 183.51, 184.146)), (' B 718  SER  OG ', ' B1063  THR  OG1', -0.508, (220.483, 193.181, 169.524)), (' A 877  GLY  O  ', ' A 881  SER  OG ', -0.506, (200.312, 230.181, 167.039)), (' A 554  LYS  HB2', ' A 581  ILE HG21', -0.505, (208.437, 168.657, 219.921)), (' A 161  ASN  OD1', ' A 162  ASN  N  ', -0.505, (165.638, 212.66, 261.92)), (' B 733  VAL HG12', ' B 855  LEU HD23', -0.504, (203.811, 195.089, 212.204)), (' B 753  TYR  OH ', ' B 991  ASP  OD2', -0.504, (205.025, 208.647, 228.162)), (' A 852  PHE  CE1', ' C 586  PRO  HB3', -0.504, (193.953, 235.085, 218.749)), (' B 458  LEU HD13', ' B 462  GLU  OE2', -0.502, (217.021, 239.159, 252.395)), (' A 712  PRO  HA ', ' A1069  GLU  HA ', -0.502, (188.176, 198.695, 157.577)), (' C 109  ASP  OD1', ' C 110  SER  N  ', -0.501, (229.822, 259.431, 255.661)), (' C 102  TRP  HB3', ' C 104  PHE  HE1', -0.501, (236.217, 256.509, 239.35)), (' B 273  LEU HD23', ' B 303  PHE  HE1', -0.501, (229.071, 182.135, 211.43)), (' B 487  PHE  CD1', ' B 488  PRO  HD2', -0.498, (212.029, 245.011, 266.512)), (' C 465  ILE  O  ', ' C 465  ILE HG13', -0.497, (179.806, 201.374, 258.477)), (' C 850  GLN  HG3', ' C 856  THR HG22', -0.497, (237.22, 210.85, 209.365)), (' B 140  GLY  HA2', ' B 241  LEU  HB2', -0.497, (244.072, 150.823, 243.757)), (' C 518  PRO  HG3', ' C 561  GLN  HG3', -0.494, (178.811, 228.834, 234.145)), (' C 390  THR  O  ', ' C 520  THR  OG1', -0.494, (181.456, 226.347, 243.953)), (' B 287  ASP  O  ', ' B 294  SER  HB3', -0.494, (236.242, 184.675, 213.412)), (' C 202  SER  OG ', ' C 203  LYS  N  ', -0.494, (242.691, 252.373, 227.39)), (' A 172  PHE  HB3', ' A 187  ARG HH12', -0.489, (157.225, 219.552, 236.357)), (' A 565  ASP  O  ', ' A 569  THR  OG1', -0.489, (210.665, 182.611, 216.755)), (' C 767  ILE HD11', ' C1009  LEU HD23', -0.488, (218.993, 207.687, 201.529)), (' A  94  GLU  OE1', ' A  97  ASN  ND2', -0.488, (153.009, 214.959, 234.87)), (' A 583  ASP  OD1', ' A 584  ILE  N  ', -0.487, (203.224, 175.525, 218.795)), (' C 388  CYS  HA ', ' C 522  CYS  CB ', -0.486, (188.179, 231.664, 243.562)), (' B 386  ASP  OD2', ' B 525  LYS  NZ ', -0.486, (245.07, 214.481, 240.207)), (' B 487  PHE  HD1', ' B 488  PRO  HD2', -0.486, (211.796, 245.498, 266.022)), (' B1016  ARG  HE ', ' B1020  ASN  ND2', -0.485, (204.255, 206.824, 189.441)), (' B 819  LEU HD21', ' B 935  LEU HD13', -0.484, (214.501, 184.454, 182.745)), (' C 566  ILE  H  ', ' C 566  ILE HD12', -0.484, (185.226, 225.408, 215.135)), (' B 399  ILE HG13', ' B 400  ARG  H  ', -0.483, (218.14, 227.46, 263.396)), (' C 475  THR  H  ', ' C 476  PRO  CD ', -0.482, (187.861, 179.06, 256.661)), (' B 314  ASN  HA ', ' B 591  GLY  HA2', -0.482, (237.279, 201.532, 211.843)), (' B 445  ASN  O  ', ' B 491  SER  OG ', -0.482, (218.084, 235.118, 272.966)), (' B 427  THR  O  ', ' B 427  THR  OG1', -0.482, (224.592, 226.273, 247.912)), (' B 454  ARG  NH2', ' B 470  TYR  OH ', -0.481, (202.29, 244.292, 258.021)), (' C 101  GLY  HA3', ' C 238  LEU HD12', -0.48, (240.945, 261.321, 241.724)), (' B 609  TYR  HE2', ' B 648  ILE HD12', -0.48, (247.095, 197.438, 207.91)), (' A 863  THR  H  ', ' A 866  MET  HE2', -0.48, (198.722, 236.129, 189.273)), (' C 760  LEU HD22', ' C1005  VAL HG21', -0.479, (220.945, 207.943, 210.933)), (' C 537  ASN  HB3', ' C 546  THR HG22', -0.479, (196.104, 238.954, 227.915)), (' C 324  VAL HG22', ' C 539  ASN  HB3', -0.479, (191.042, 239.325, 236.239)), (' C 487  PHE  CE2', ' C 489  LEU  HB2', -0.478, (186.601, 197.638, 268.837)), (' B1103  GLN HE21', ' B1106  PHE  HB3', -0.478, (220.711, 198.344, 152.14)), (' B 452  LEU HD22', ' B 490  GLN  OE1', -0.476, (210.596, 238.371, 265.355)), (' B 850  GLN  N  ', ' B 850  GLN  OE1', -0.476, (198.82, 186.554, 210.872)), (' B 609  TYR  O  ', ' B 645  GLY  HA3', -0.475, (243.422, 203.722, 204.354)), (' B1016  ARG  HE ', ' B1020  ASN HD21', -0.474, (204.371, 207.241, 189.793)), (' C 314  ASN  HA ', ' C 591  GLY  HA2', -0.474, (206.763, 238.547, 211.942)), (' C 530  LEU  H  ', ' C 530  LEU HD23', -0.474, (183.326, 247.174, 231.839)), (' A 710  ALA  HB3', ' B 891  LEU  HB3', -0.473, (192.726, 194.2, 159.605)), (' B 726  VAL HG22', ' B1056  GLY  HA2', -0.472, (206.85, 194.314, 188.864)), (' C 753  TYR  OH ', ' C 991  ASP  OD1', -0.472, (218.009, 207.601, 227.638)), (' C 129  CYS  CB ', ' C 163  CYS  HA ', -0.472, (238.957, 251.414, 254.356)), (' B  81  VAL HG22', ' B 236  GLN HE21', -0.471, (247.207, 171.237, 244.053)), (' B1016  ARG  NH2', ' B1020  ASN  OD1', -0.47, (202.556, 206.273, 188.037)), (' C 575  ASP  N  ', ' C 575  ASP  OD1', -0.47, (178.235, 238.591, 231.361)), (' B 428  GLY  CA ', ' B 510  LEU  O  ', -0.47, (228.158, 225.849, 247.944)), (' A 639  VAL HG12', ' A 648  ILE HG12', -0.469, (179.863, 184.674, 208.016)), (' B 561  GLN  O  ', ' B 574  ARG  HG2', -0.469, (246.758, 230.544, 227.618)), (' B 198  PHE  CE2', ' B 200  ILE HD11', -0.469, (231.936, 170.865, 238.949)), (' C 358  CYS  HB2', ' C 521  VAL HG23', -0.469, (183.553, 230.014, 249.751)), (' C 224  VAL HG12', ' C 226  LEU HD12', -0.469, (240.163, 246.138, 238.935)), (' A 274  LEU HD23', ' A 285  ALA  HB2', -0.468, (172.647, 213.109, 218.831)), (' C 571  ASP  O  ', ' C 584  ILE  N  ', -0.467, (184.505, 236.222, 222.338)), (' B 395  ASP  OD2', ' B 420  TYR  OH ', -0.467, (225.502, 232.145, 251.461)), (' B 333  CYS  HB2', ' B 358  CYS  HB3', -0.466, (243.873, 227.63, 249.715)), (' A 930  LYS  HB2', ' A 930  LYS  HE2', -0.466, (179.429, 214.756, 171.922)), (' A 723  ILE HG13', ' A1058  VAL HG22', -0.465, (191.393, 218.172, 183.91)), (' B 575  ASP  N  ', ' B 575  ASP  OD1', -0.465, (251.518, 227.109, 228.555)), (' A 897  MET  HE1', ' C1074  THR HG21', -0.464, (197.546, 228.654, 152.375)), (' C 354  ARG HH21', ' C 393  TYR  HE1', -0.462, (180.453, 216.995, 249.482)), (' B 339  PHE  HB2', ' N   1  NAG  H82', -0.462, (237.841, 225.037, 260.671)), (' B 296  THR HG22', ' B 594  VAL HG21', -0.461, (235.504, 191.696, 206.029)), (' B 277  ASN  ND2', ' B 281  THR  OG1', -0.461, (223.306, 168.241, 214.608)), (' C 983  PRO  N  ', ' C 984  PRO  HD2', -0.46, (228.113, 207.15, 240.595)), (' B 709  ILE HD11', ' B1093  VAL HG12', -0.459, (230.099, 205.78, 150.39)), (' C 767  ILE  O  ', ' C 771  GLN  HG2', -0.458, (224.847, 208.525, 197.286)), (' J   1  NAG  H4 ', ' J   2  NAG  H2 ', -0.458, (184.413, 196.188, 139.477)), (' C 399  ILE HD11', ' C 415  ILE HG21', -0.457, (196.696, 207.19, 260.245)), (' B 212  ASP  N  ', ' B 212  ASP  OD1', -0.455, (247.613, 163.51, 218.068)), (' A  61  ASN  HB3', ' A2001  NAG  HN2', -0.455, (161.908, 195.885, 222.846)), (' C 847  ILE  O  ', ' C 847  ILE HG22', -0.455, (245.391, 211.948, 206.474)), (' C1113  THR HG23', ' C1115  HIS  H  ', -0.454, (206.873, 217.357, 138.042)), (' A 101  GLY  HA3', ' A 238  LEU HD12', -0.454, (155.632, 212.202, 246.057)), (' I   1  NAG  O3 ', ' I   2  NAG  N2 ', -0.454, (175.46, 229.722, 167.868)), (' B 341  ALA  O  ', ' B 343  ARG  N  ', -0.452, (233.54, 233.094, 266.548)), (' A1137  PRO  O  ', ' A1140  PRO  HD2', -0.452, (201.707, 205.577, 128.6)), (' B 350  TRP  CZ3', ' B 352  ARG  HB2', -0.451, (227.616, 236.911, 253.219)), (' C 233  THR HG21', ' X   1  NAG  H61', -0.451, (222.658, 255.325, 244.764)), (' A 191  PHE  HD1', ' A 200  ILE HG12', -0.451, (165.516, 213.586, 238.715)), (' B 284  ASP  N  ', ' B 284  ASP  OD1', -0.451, (228.452, 174.372, 212.345)), (' B 452  LEU  H  ', ' B 452  LEU HD23', -0.449, (210.608, 238.769, 262.645)), (' B  53  ASP  HB3', ' B  55  PHE  HE1', -0.448, (229.861, 181.082, 225.055)), (' G   1  NAG  H4 ', ' G   2  NAG  H2 ', -0.448, (190.799, 173.23, 208.627)), (' B 893  ILE HD12', ' B 894  PRO  HD2', -0.448, (199.056, 191.767, 156.585)), (' C 333  CYS  HB2', ' C 358  CYS  HB3', -0.448, (183.813, 231.872, 252.752)), (' B 823  VAL  HB ', ' B 942  LEU HD12', -0.447, (214.999, 185.286, 190.491)), (' B 548  VAL HG12', ' B 585  THR  O  ', -0.447, (246.13, 215.556, 217.875)), (' C 903  PHE  HE1', ' C1046  LEU HD11', -0.447, (221.74, 223.096, 161.607)), (' B 111  LYS  O  ', ' B 112  THR  OG1', -0.447, (240.312, 176.113, 252.473)), (' B 770  GLU  OE2', ' B1016  ARG  HD3', -0.446, (201.881, 206.202, 193.365)), (' C 307  LYS  HG3', ' C 597  PRO  HA ', -0.446, (217.673, 244.381, 195.203)), (' A1115  HIS  ND1', ' A1115  HIS  O  ', -0.446, (205.633, 206.86, 139.908)), (' A 185  ASN  HB3', ' A 204  HIS  CE1', -0.445, (152.535, 218.165, 228.721)), (' A 139  LEU  HB2', ' A 240  ALA  HA ', -0.445, (148.607, 213.611, 245.678)), (' B 985  GLU  O  ', ' B 989  GLN  HG2', -0.445, (208.713, 202.571, 236.609)), (' B 115  LEU HD11', ' B 230  ILE HG21', -0.444, (232.883, 174.501, 245.681)), (' C 449  LEU HD12', ' C 489  LEU  HB3', -0.443, (187.674, 200.961, 268.134)), (' C 126  ILE  HB ', ' C 167  TYR  HB3', -0.442, (243.003, 248.98, 244.018)), (' B 927  ALA  O  ', ' B 931  ILE HG23', -0.442, (219.143, 184.735, 173.277)), (' A 156  VAL HG23', ' A 157  TYR  CD1', -0.442, (155.543, 213.819, 253.828)), (' B 127  LYS  NZ ', ' B 166  GLU  OE2', -0.442, (228.992, 163.624, 252.805)), (' A 538  PHE  CZ ', ' A 584  ILE HD13', -0.439, (202.705, 179.494, 224.944)), (' B1114  THR  O  ', ' B1114  THR HG22', -0.439, (215.867, 212.183, 136.891)), (' A 227  PRO  HB2', ' C 354  ARG HH12', -0.438, (177.18, 218.674, 247.28)), (' B 641  GLN  NE2', ' B 645  GLY  O  ', -0.438, (247.009, 205.391, 202.02)), (' A 799  PHE  HD1', ' A 802  ILE HD11', -0.437, (188.906, 225.329, 170.61)), (' B 400  ARG  NH1', ' B 498  TYR  OH ', -0.437, (217.762, 225.77, 271.694)), (' C 433  TRP  NE1', ' C 506  ARG  HB2', -0.436, (194.665, 219.699, 264.87)), (' B 974  LEU  HA ', ' B 977  ILE HG22', -0.436, (206.527, 195.178, 231.992)), (' B 717  ILE HD12', ' B 920  ILE HG23', -0.436, (216.478, 188.816, 161.633)), (' B 400  ARG  NH2', ' B 492  TYR  HB3', -0.435, (217.301, 229.453, 271.068)), (' C 406  GLN  HB3', ' C 416  ALA  HB2', -0.435, (199.519, 205.986, 255.318)), (' A 901  TYR  CE2', ' C1104  ARG  HD3', -0.434, (203.563, 223.061, 156.363)), (' A  37  TYR  HB3', ' A 220  LEU HD12', -0.434, (168.01, 214.312, 227.457)), (' A1077  ALA  O  ', ' A1129  ILE HG13', -0.433, (204.851, 188.785, 143.977)), (' B 659  CYS  HB2', ' B 694  MET  HG3', -0.433, (238.678, 200.14, 186.829)), (' P   1  NAG  O4 ', ' P   1  NAG  O7 ', -0.433, (242.336, 217.35, 149.076)), (' A 325  ARG  NH2', ' A 575  ASP  OD2', -0.433, (202.494, 167.904, 230.569)), (' C 778  VAL HG22', ' C1023  ALA  HB2', -0.433, (222.967, 209.932, 184.248)), (' A 124  VAL HG13', ' A 171  PRO  HA ', -0.432, (158.081, 223.269, 241.313)), (' B 453  PHE  HE1', ' B 470  TYR  HB2', -0.432, (207.803, 244.966, 260.108)), (' B 445  ASN  HA ', ' B 494  PHE  CE1', -0.432, (220.58, 232.257, 274.385)), (' A 275  LYS  HB3', ' A 284  ASP  OD1', -0.431, (173.075, 216.179, 213.595)), (' B  94  GLU  O  ', ' B  96  SER  N  ', -0.43, (242.624, 154.954, 229.971)), (' C 124  VAL HG13', ' C 171  PRO  HA ', -0.429, (248.479, 253.099, 237.065)), (' A 718  SER  OG ', ' A1063  THR  OG1', -0.429, (190.098, 210.161, 170.393)), (' B 552  SER  HB2', ' B 583  ASP  HB2', -0.428, (249.557, 225.272, 218.31)), (' B 434  ASN  HA ', ' B 505  TYR  CD1', -0.428, (224.46, 221.537, 266.544)), (' B 187  ARG  CZ ', ' B 204  HIS  HB2', -0.428, (233.147, 159.877, 227.859)), (' A 110  SER  OG ', ' A 132  GLN  OE1', -0.427, (160.449, 206.47, 259.859)), (' B 534  LYS  HB3', ' B 536  VAL HG13', -0.427, (251.674, 211.346, 223.718)), (' C 395  ASP  O  ', ' C 508  VAL  HA ', -0.427, (190.816, 217.817, 258.269)), (' B 472  ALA  HB3', ' B 477  CYS  HB3', -0.427, (200.173, 248.747, 259.257)), (' C 739  ILE  O  ', ' C 997  ARG  NH1', -0.426, (228.054, 212.906, 222.817)), (' C1070  LYS  HE3', ' C1072  PHE  CE2', -0.426, (207.521, 237.319, 148.894)), (' C 109  ASP  OD2', ' C 111  LYS  NZ ', -0.426, (225.761, 260.132, 255.271)), (' B 550  THR HG23', ' B 583  ASP  HB3', -0.426, (250.232, 222.447, 217.261)), (' A 902  ARG  NH1', ' A1047  MET  HB3', -0.425, (197.985, 219.503, 166.829)), (' B 399  ILE  HA ', ' B 399  ILE HD12', -0.425, (219.302, 229.75, 263.22)), (' B 116  LEU HD11', ' B 156  VAL HG11', -0.425, (238.808, 162.237, 248.378)), (' B 324  VAL  H  ', ' B 528  THR HG22', -0.425, (251.204, 216.387, 234.28)), (' C 961  LYS  HG3', ' C 961  LYS  O  ', -0.425, (225.26, 224.307, 217.387)), (' B 739  ILE HD11', ' B 750  LEU HD22', -0.423, (199.662, 202.393, 222.587)), (' C 535  CYS  HB2', ' C 587  CYS  HB3', -0.423, (194.019, 243.265, 220.038)), (' C 805  ASP  N  ', ' C 805  ASP  OD1', -0.422, (243.926, 221.0, 175.983)), (' B 274  LEU HD23', ' B 285  ALA  HB2', -0.422, (230.261, 177.215, 217.363)), (' B  37  TYR  HB3', ' B 220  LEU  HB2', -0.421, (230.479, 171.58, 225.764)), (' C  30  ASN  ND2', ' C  61  ASN  OD1', -0.42, (223.041, 262.568, 219.972)), (' C 363  SER  O  ', ' C 367  ASN  ND2', -0.42, (198.144, 235.328, 256.506)), (' C 376  CYS  HA ', ' C 429  CYS  HB2', -0.419, (199.045, 220.678, 250.622)), (' C 708  SER  HA ', ' C1072  PHE  O  ', -0.418, (199.259, 234.433, 152.029)), (' B 613  ASN  O  ', ' B 615  THR  N  ', -0.418, (250.673, 205.824, 208.998)), (' B 339  PHE  HE2', ' B 365  LEU HD11', -0.418, (235.674, 222.462, 256.536)), (' A 125  VAL HG22', ' A 127  LYS  HG3', -0.418, (161.335, 219.27, 251.042)), (' B 400  ARG  HB2', ' B 403  GLU  OE1', -0.418, (215.695, 226.492, 264.147)), (' B 525  LYS  HA ', ' B 525  LYS  HD2', -0.417, (248.409, 215.99, 243.611)), (' A 982  ASP  O  ', ' A 986  ALA  N  ', -0.417, (206.793, 224.89, 239.591)), (' C 125  VAL HG21', ' V   1  NAG  H61', -0.416, (248.941, 255.183, 246.211)), (' B 161  ASN  OD1', ' B 162  ASN  N  ', -0.416, (234.125, 169.171, 259.397)), (' A 861  LEU HD11', ' C 694  MET  HE1', -0.416, (204.785, 238.0, 190.647)), (' C 976  ASP  O  ', ' C 980  ARG  HG3', -0.415, (232.333, 217.182, 235.945)), (' A 540  PHE  O  ', ' A 543  LEU  HG ', -0.414, (207.107, 178.364, 231.492)), (' B 961  LYS  HB2', ' B 961  LYS  HE2', -0.414, (215.434, 191.423, 215.274)), (' C 925  ASN  O  ', ' C 928  ILE HG22', -0.414, (232.608, 230.812, 167.689)), (' C 453  PHE  CD2', ' C 488  PRO  HB3', -0.413, (190.309, 193.369, 263.315)), (' A 196  GLY  HA2', ' A 229  GLY  HA2', -0.413, (176.631, 212.291, 245.978)), (' B 464  ASP  N  ', ' B 464  ASP  OD1', -0.413, (218.768, 241.827, 254.822)), (' C 296  THR  OG1', ' C 594  VAL HG21', -0.412, (216.585, 242.492, 206.143)), (' A 108  LEU  HB3', ' A 133  PHE  HD2', -0.412, (159.589, 204.558, 252.186)), (' C 419  ASN HD21', ' C 451  ARG  HB3', -0.411, (190.761, 200.409, 260.348)), (' B 663  ILE  HB ', ' B 667  ILE  O  ', -0.411, (240.577, 201.42, 194.612)), (' C 333  CYS  SG ', ' C 334  PRO  HD2', -0.411, (182.177, 229.136, 254.744)), (' C 346  SER  HB3', ' C 448  TYR  HA ', -0.411, (189.311, 208.55, 267.318)), (' A 129  CYS  HB3', ' A 131  PHE  CE1', -0.411, (163.107, 214.861, 255.388)), (' A 108  LEU HD22', ' A 133  PHE  HE2', -0.411, (161.293, 205.265, 250.635)), (' B 654  ASN  HB3', ' B2006  NAG  H2 ', -0.411, (254.492, 200.381, 188.159)), (' A 963  LEU  HA ', ' A 963  LEU HD23', -0.41, (199.041, 220.612, 221.304)), (' B 186  LEU  O  ', ' B 204  HIS  HA ', -0.409, (235.269, 161.114, 225.42)), (' C1036  ARG  H  ', ' C1036  ARG  HG2', -0.409, (212.542, 214.436, 170.514)), (' B 430  VAL HG22', ' B 509  VAL HG23', -0.409, (225.511, 225.681, 252.226)), (' A 108  LEU  HB3', ' A 133  PHE  CD2', -0.408, (159.821, 204.681, 252.192)), (' B 913  LEU HD12', ' B 920  ILE HD12', -0.408, (214.635, 189.576, 157.304)), (' C 588  SER  HB3', ' C 612  VAL  HB ', -0.408, (197.807, 242.592, 212.617)), (' B 446  TYR  HA ', ' B 491  SER  OG ', -0.407, (218.209, 236.1, 272.813)), (' B1046  LEU  HA ', ' B1046  LEU HD23', -0.407, (212.568, 196.869, 164.772)), (' B 307  LYS  HE2', ' B 661  ILE HD11', -0.407, (237.051, 190.28, 193.378)), (' C 167  TYR  HE1', ' C 169  SER  HB2', -0.405, (246.698, 246.375, 240.35)), (' C 102  TRP  HB3', ' C 104  PHE  CE1', -0.404, (235.845, 256.703, 239.608)), (' C 608  LEU HD13', ' C 647  LEU  HB3', -0.403, (204.856, 245.386, 201.61)), (' B 728  MET  HE2', ' B 771  GLN HE21', -0.403, (205.432, 199.823, 199.36)), (' C 982  ASP  N  ', ' C 982  ASP  OD1', -0.403, (228.34, 210.938, 241.18)), (' C 875  LEU  HA ', ' C 878  THR HG22', -0.403, (231.372, 214.361, 170.583)), (' C1079  CYS  HB3', ' C1123  CYS  HB3', -0.403, (190.8, 220.916, 140.718)), (' C 194  ILE HG22', ' C 195  ASP  OD2', -0.403, (228.247, 239.109, 236.515)), (' C 928  ILE  HA ', ' C 931  ILE HG22', -0.403, (230.078, 229.892, 172.036)), (' C 205  THR  O  ', ' C 205  THR HG23', -0.403, (247.964, 256.953, 221.126)), (' B 399  ILE HG23', ' B 400  ARG  O  ', -0.402, (219.271, 225.179, 263.33)), (' C 119  ASN  ND2', ' C 173  LEU HD21', -0.402, (245.285, 257.15, 236.313)), (' B 919  LEU  O  ', ' B 923  GLN  HG3', -0.402, (219.681, 184.642, 160.702)), (' C  79  ASN HD21', ' C 239  LEU HD23', -0.401, (236.448, 267.904, 240.252)), (' A 673  THR  HA ', ' A 687  GLN  HA ', -0.401, (169.146, 193.327, 193.23)), (' I   1  NAG  H4 ', ' I   2  NAG  H2 ', -0.4, (175.483, 227.619, 169.542)), (' A 808  LYS  HG3', ' A 812  ARG  O  ', -0.4, (184.547, 234.004, 179.907)), (' A 217  PHE  CE2', ' A 284  ASP  HA ', -0.4, (168.519, 213.727, 214.715))]
handle_read_draw_probe_dots_unformatted("molprobity_probe.txt", 0, 0)
show_probe_dots(True, True)
gui = coot_molprobity_todo_list_gui(data=data)
