# script auto-generated by phenix.molprobity


from __future__ import absolute_import, division, print_function
from six.moves import cPickle as pickle
from six.moves import range
try :
  import gobject
except ImportError :
  gobject = None
import sys

class coot_extension_gui(object):
  def __init__(self, title):
    import gtk
    self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)
    scrolled_win = gtk.ScrolledWindow()
    self.outside_vbox = gtk.VBox(False, 2)
    self.inside_vbox = gtk.VBox(False, 0)
    self.window.set_title(title)
    self.inside_vbox.set_border_width(0)
    self.window.add(self.outside_vbox)
    self.outside_vbox.pack_start(scrolled_win, True, True, 0)
    scrolled_win.add_with_viewport(self.inside_vbox)
    scrolled_win.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)

  def finish_window(self):
    import gtk
    self.outside_vbox.set_border_width(2)
    ok_button = gtk.Button("  Close  ")
    self.outside_vbox.pack_end(ok_button, False, False, 0)
    ok_button.connect("clicked", lambda b: self.destroy_window())
    self.window.connect("delete_event", lambda a, b: self.destroy_window())
    self.window.show_all()

  def destroy_window(self, *args):
    self.window.destroy()
    self.window = None

  def confirm_data(self, data):
    for data_key in self.data_keys :
      outlier_list = data.get(data_key)
      if outlier_list is not None and len(outlier_list) > 0 :
        return True
    return False

  def create_property_lists(self, data):
    import gtk
    for data_key in self.data_keys :
      outlier_list = data[data_key]
      if outlier_list is None or len(outlier_list) == 0 :
        continue
      else :
        frame = gtk.Frame(self.data_titles[data_key])
        vbox = gtk.VBox(False, 2)
        frame.set_border_width(6)
        frame.add(vbox)
        self.add_top_widgets(data_key, vbox)
        self.inside_vbox.pack_start(frame, False, False, 5)
        list_obj = residue_properties_list(
          columns=self.data_names[data_key],
          column_types=self.data_types[data_key],
          rows=outlier_list,
          box=vbox)

# Molprobity result viewer
class coot_molprobity_todo_list_gui(coot_extension_gui):
  data_keys = [ "rama", "rota", "cbeta", "probe" ]
  data_titles = { "rama"  : "Ramachandran outliers",
                  "rota"  : "Rotamer outliers",
                  "cbeta" : "C-beta outliers",
                  "probe" : "Severe clashes" }
  data_names = { "rama"  : ["Chain", "Residue", "Name", "Score"],
                 "rota"  : ["Chain", "Residue", "Name", "Score"],
                 "cbeta" : ["Chain", "Residue", "Name", "Conf.", "Deviation"],
                 "probe" : ["Atom 1", "Atom 2", "Overlap"] }
  if (gobject is not None):
    data_types = { "rama" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "rota" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "cbeta" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT],
                   "probe" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT] }
  else :
    data_types = dict([ (s, []) for s in ["rama","rota","cbeta","probe"] ])

  def __init__(self, data_file=None, data=None):
    assert ([data, data_file].count(None) == 1)
    if (data is None):
      data = load_pkl(data_file)
    if not self.confirm_data(data):
      return
    coot_extension_gui.__init__(self, "MolProbity to-do list")
    self.dots_btn = None
    self.dots2_btn = None
    self._overlaps_only = True
    self.window.set_default_size(420, 600)
    self.create_property_lists(data)
    self.finish_window()

  def add_top_widgets(self, data_key, box):
    import gtk
    if data_key == "probe" :
      hbox = gtk.HBox(False, 2)
      self.dots_btn = gtk.CheckButton("Show Probe dots")
      hbox.pack_start(self.dots_btn, False, False, 5)
      self.dots_btn.connect("toggled", self.toggle_probe_dots)
      self.dots2_btn = gtk.CheckButton("Overlaps only")
      hbox.pack_start(self.dots2_btn, False, False, 5)
      self.dots2_btn.connect("toggled", self.toggle_all_probe_dots)
      self.dots2_btn.set_active(True)
      self.toggle_probe_dots()
      box.pack_start(hbox, False, False, 0)

  def toggle_probe_dots(self, *args):
    if self.dots_btn is not None :
      show_dots = self.dots_btn.get_active()
      overlaps_only = self.dots2_btn.get_active()
      if show_dots :
        self.dots2_btn.set_sensitive(True)
      else :
        self.dots2_btn.set_sensitive(False)
      show_probe_dots(show_dots, overlaps_only)

  def toggle_all_probe_dots(self, *args):
    if self.dots2_btn is not None :
      self._overlaps_only = self.dots2_btn.get_active()
      self.toggle_probe_dots()

class rsc_todo_list_gui(coot_extension_gui):
  data_keys = ["by_res", "by_atom"]
  data_titles = ["Real-space correlation by residue",
                 "Real-space correlation by atom"]
  data_names = {}
  data_types = {}

class residue_properties_list(object):
  def __init__(self, columns, column_types, rows, box,
      default_size=(380,200)):
    assert len(columns) == (len(column_types) - 1)
    if (len(rows) > 0) and (len(rows[0]) != len(column_types)):
      raise RuntimeError("Wrong number of rows:\n%s" % str(rows[0]))
    import gtk
    self.liststore = gtk.ListStore(*column_types)
    self.listmodel = gtk.TreeModelSort(self.liststore)
    self.listctrl = gtk.TreeView(self.listmodel)
    self.listctrl.column = [None]*len(columns)
    self.listctrl.cell = [None]*len(columns)
    for i, column_label in enumerate(columns):
      cell = gtk.CellRendererText()
      column = gtk.TreeViewColumn(column_label)
      self.listctrl.append_column(column)
      column.set_sort_column_id(i)
      column.pack_start(cell, True)
      column.set_attributes(cell, text=i)
    self.listctrl.get_selection().set_mode(gtk.SELECTION_SINGLE)
    for row in rows :
      self.listmodel.get_model().append(row)
    self.listctrl.connect("cursor-changed", self.OnChange)
    sw = gtk.ScrolledWindow()
    w, h = default_size
    if len(rows) > 10 :
      sw.set_size_request(w, h)
    else :
      sw.set_size_request(w, 30 + (20 * len(rows)))
    sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
    box.pack_start(sw, False, False, 5)
    inside_vbox = gtk.VBox(False, 0)
    sw.add(self.listctrl)

  def OnChange(self, treeview):
    import coot # import dependency
    selection = self.listctrl.get_selection()
    (model, tree_iter) = selection.get_selected()
    if tree_iter is not None :
      row = model[tree_iter]
      xyz = row[-1]
      if isinstance(xyz, tuple) and len(xyz) == 3 :
        set_rotation_centre(*xyz)
        set_zoom(30)
        graphics_draw()

def show_probe_dots(show_dots, overlaps_only):
  import coot # import dependency
  n_objects = number_of_generic_objects()
  sys.stdout.flush()
  if show_dots :
    for object_number in range(n_objects):
      obj_name = generic_object_name(object_number)
      if overlaps_only and not obj_name in ["small overlap", "bad overlap"] :
        sys.stdout.flush()
        set_display_generic_object(object_number, 0)
      else :
        set_display_generic_object(object_number, 1)
  else :
    sys.stdout.flush()
    for object_number in range(n_objects):
      set_display_generic_object(object_number, 0)

def load_pkl(file_name):
  pkl = open(file_name, "rb")
  data = pickle.load(pkl)
  pkl.close()
  return data

data = {}
data['rama'] = [('A', ' 145 ', 'THR', 0.030376700451391972, (36.074, -10.241, -54.358999999999995)), ('C', ' 235 ', 'ASP', 0.04099003326412811, (20.07400000000001, 10.490999999999998, -1.542)), ('J', ' 153 ', 'ASP', 0.01607955512562394, (25.504000000000012, 27.367, 156.406)), ('K', ' 382 ', 'VAL', 0.09788843649113552, (52.49199999999999, 37.145, 55.62299999999999)), ('U', ' 171 ', 'LYS', 0.04990390449520466, (115.539, -1.873, -39.17499999999999))]
data['omega'] = [('A', ' 157 ', 'PRO', None, (53.85199999999999, -0.277, -25.988999999999994)), ('A', ' 159 ', 'PRO', None, (48.349000000000004, -2.837, -26.236999999999995)), ('B', '   8 ', 'PRO', None, (43.247, -35.455000000000005, -26.171999999999997)), ('B', ' 143 ', 'PRO', None, (41.16899999999999, -27.197999999999997, -42.748999999999995)), ('C', ' 165 ', 'PRO', None, (47.04999999999999, 24.099999999999994, 20.473999999999997)), ('C', ' 167 ', 'PRO', None, (49.102, 18.219, 19.619)), ('D', '   8 ', 'PRO', None, (69.904, 13.484, -4.127)), ('D', ' 146 ', 'PRO', None, (48.49900000000001, 8.729, -9.916999999999998)), ('E', ' 165 ', 'PRO', None, (98.65100000000001, -43.208, 20.389)), ('E', ' 167 ', 'PRO', None, (96.562, -37.48500000000001, 19.387)), ('F', '   8 ', 'PRO', None, (75.74000000000004, -32.823, -4.098999999999999)), ('F', ' 146 ', 'PRO', None, (97.03300000000006, -28.156, -9.973)), ('H', ' 157 ', 'PRO', None, (83.723, -53.07899999999998, 73.50899999999999)), ('H', ' 159 ', 'PRO', None, (89.31600000000002, -50.39299999999997, 73.32799999999997)), ('I', ' 157 ', 'PRO', None, (35.16199999999999, 41.855, 125.27299999999997)), ('I', ' 159 ', 'PRO', None, (40.651, 39.026, 125.57599999999996)), ('J', '   8 ', 'PRO', None, (45.703, 6.630000000000001, 125.40399999999997)), ('J', ' 143 ', 'PRO', None, (47.71, 14.623, 141.87099999999998)), ('L', '   8 ', 'PRO', None, (94.629, -17.887000000000004, 73.273)), ('L', ' 143 ', 'PRO', None, (96.485, -26.593999999999998, 56.587)), ('M', ' 165 ', 'PRO', None, (38.96000000000001, -10.144, 119.782)), ('M', ' 167 ', 'PRO', None, (40.928, -15.817, 118.75799999999998)), ('N', '   8 ', 'PRO', None, (61.85699999999999, -20.669, 95.19699999999997)), ('N', ' 146 ', 'PRO', None, (40.285, -25.494999999999997, 89.34999999999998)), ('O', ' 165 ', 'PRO', None, (-9.599999999999998, -1.299, 78.89899999999997)), ('O', ' 167 ', 'PRO', None, (-7.505, 4.463, 79.786)), ('P', '   8 ', 'PRO', None, (13.314000000000004, 9.552, 103.58599999999998)), ('P', ' 146 ', 'PRO', None, (-8.410000000000002, 14.207, 109.294)), ('T', ' 157 ', 'PRO', None, (92.006, -19.079999999999995, -25.913)), ('T', ' 159 ', 'PRO', None, (97.57599999999998, -16.506, -26.06299999999999)), ('U', '   8 ', 'PRO', None, (102.385, 16.238, -26.33)), ('U', ' 143 ', 'PRO', None, (104.543, 7.387, -43.03799999999998))]
data['rota'] = [('B', '  34 ', 'LEU', 0.2994745592618228, (41.217, -32.385, -9.23)), ('D', ' 115 ', 'VAL', 0.2985624995822619, (47.6, 4.679, -12.744)), ('S', ' 483 ', 'VAL', 0.29158084359543607, (91.54, -19.72, 105.81999999999996))]
data['cbeta'] = []
data['probe'] = [(' H 220  LYS  H  ', ' H 220  LYS  HD2', -0.879, (94.73, -61.241, 53.973)), (' U 122  PRO  HD3', ' U 134  VAL HG12', -0.8, (88.951, -13.737, -50.807)), (' F   4  MET  HE3', ' F  96  GLN  HG2', -0.779, (67.141, -34.37, 9.532)), (' J 110  ARG HH21', ' J 113  ALA  HB2', -0.737, (52.782, 17.108, 144.881)), (' I 136  PRO  HG3', ' I 148  LEU  HB3', -0.732, (46.035, 38.695, 150.667)), (' U 134  VAL HG22', ' U 181  LEU  HB3', -0.716, (87.589, -9.507, -47.986)), (' U 191  HIS  O  ', ' U 213  ARG  NH1', -0.715, (82.795, -13.456, -57.538)), (' M 137  PRO  HB3', ' M 163  TYR  HB3', -0.712, (32.397, -12.925, 117.262)), (' O  32  VAL  O  ', ' O  74  ARG  NH2', -0.708, (18.098, 14.904, 69.349)), (' A   7  SER  HG ', ' A  21  SER  HG ', -0.696, (46.855, -4.154, -8.574)), (' L 191  HIS  O  ', ' L 213  ARG  NH1', -0.679, (74.3, -47.625, 40.982)), (' T 129  PRO  HB3', ' T 155  TYR  HB3', -0.675, (92.829, -20.564, -33.331)), (' E  51  ILE HD13', ' E  74  ARG  HG3', -0.658, (72.315, -32.926, 31.528)), (' J  18  ARG  HG3', ' J  77  SER  HA ', -0.648, (60.282, 5.86, 123.376)), (' K 357  ARG  NH2', ' K 396  TYR  OH ', -0.645, (50.431, 17.321, 56.913)), (' U 169  ASP  OD1', ' U 170  SER  N  ', -0.641, (112.468, -2.444, -37.454)), (' F  60  ARG  NH1', ' F  68  PHE  O  ', -0.63, (72.328, -15.36, 2.418)), (' D  60  ARG  NH1', ' D  68  PHE  O  ', -0.63, (73.249, -4.047, 2.289)), (' E 141  PRO  HD3', ' E 227  LYS  HD3', -0.628, (115.943, -33.56, 15.595)), (' N  24  LYS  HD2', ' N  76  GLU  HG3', -0.625, (71.467, -21.127, 96.785)), (' N  46  PRO  HG2', ' N 170  GLU  HG3', -0.621, (45.872, -24.16, 104.333)), (' H 129  PRO  HB3', ' H 155  TYR  HB3', -0.618, (84.766, -54.209, 65.975)), (' H 178  ALA  HA ', ' H 188  LEU  HB3', -0.617, (87.935, -45.609, 64.517)), (' S 439  ASN  O  ', ' S 443  SER  OG ', -0.612, (75.111, -42.875, 123.207)), (' M 104  TYR  O  ', ' S 444  LYS  NZ ', -0.609, (72.587, -32.542, 121.026)), (' S 376  THR  HB ', ' S 435  ALA  HB3', -0.602, (88.519, -47.94, 130.559)), (' K 393  THR  HA ', ' K 522  ALA  HA ', -0.602, (52.476, 22.605, 47.82)), (' B  21  LEU HD13', ' B  74  LEU HD23', -0.601, (35.981, -31.684, -21.19)), (' b 384  PRO  HA ', ' b 387  LEU HD12', -0.6, (103.485, -13.564, 44.66)), (' D 147  ARG  NH2', ' D 302  HOH  O  ', -0.591, (51.428, 17.252, -0.064)), (' O  33  TRP  CD2', ' O  52  LYS  HG2', -0.589, (22.772, 12.665, 73.191)), (' P 168  VAL HG22', ' P 180  LEU HD12', -0.588, (-10.805, 7.495, 99.599)), (' E  65  PRO  O  ', ' E  69  ARG  NH2', -0.584, (77.185, -48.03, 19.81)), (' C   2  VAL  HA ', ' C  26  GLY  HA3', -0.58, (65.111, -1.491, 28.6)), (' O  93  THR HG23', ' O 128  THR  HA ', -0.577, (-0.579, -1.467, 80.275)), (' N  60  ARG  NH1', ' N  68  PHE  O  ', -0.574, (64.259, -38.296, 101.43)), (' P 118  PRO  HB3', ' P 144  PHE  HB3', -0.57, (-14.773, 14.517, 105.248)), (' C  52  LYS  HE2', ' C  59  THR  HB ', -0.57, (81.506, 15.016, 27.637)), (' H 205  ILE  HA ', ' H 220  LYS  HA ', -0.568, (97.004, -57.969, 54.527)), (' T 136  PRO  HG3', ' T 148  LEU  HB3', -0.567, (104.017, -16.97, -51.116)), (' S 453  TYR  OH ', ' S 493  GLN  OE1', -0.564, (89.292, -37.755, 113.328)), (' D 194  HIS  O  ', ' D 216  ARG  NH1', -0.561, (19.471, 23.609, 0.154)), (' S 393  THR  HA ', ' S 522  ALA  HA ', -0.561, (101.035, -33.961, 150.801)), (' N  72  GLY  HA3', ' N  77  PHE  HA ', -0.56, (71.912, -27.191, 99.862)), (' J 138  LEU HD12', ' J 177  LEU HD23', -0.555, (40.587, 22.267, 142.592)), (' M  34  MET  HB3', ' M  81  LEU HD22', -0.554, (61.08, -22.782, 126.221)), (' N   4  MET  HE3', ' N  96  GLN  HG2', -0.553, (70.805, -18.928, 109.171)), (' U 115  PRO  HD3', ' U 200  HIS  CD2', -0.552, (102.655, 4.011, -48.323)), (' O  85  MET  HB3', ' O  88  LEU HD21', -0.552, (6.552, -2.503, 73.59)), (' J 122  PRO  HD3', ' J 134  VAL HG22', -0.551, (31.827, 35.291, 149.2)), (' O  51  ILE HD13', ' O  74  ARG  HB2', -0.55, (16.94, 8.387, 66.859)), (' O 137  PRO  HB3', ' O 163  TYR  HB3', -0.547, (-15.817, 1.848, 80.893)), (' M  52  LYS  O  ', ' M  74  ARG  NH1', -0.543, (67.854, -23.225, 129.823)), (' P 191  TYR  O  ', ' P 197  TYR  OH ', -0.543, (-33.065, -1.925, 97.538)), (' U  94  SER  OG ', ' U  95  SER  N  ', -0.54, (95.845, 10.6, -0.179)), (' U 115  PRO  HD3', ' U 200  HIS  HD2', -0.538, (102.924, 4.669, -48.469)), (' C  34  MET  HB3', ' C  81  LEU HD22', -0.534, (69.609, 11.263, 26.631)), (' E  95  VAL  HA ', ' E 126  LEU  HA ', -0.533, (87.933, -37.368, 19.351)), (' J  36  TRP  HB2', ' J  49  ILE  HB ', -0.532, (52.915, 12.114, 113.389)), (' L 168  GLN  HB3', ' L 175  TYR  CE2', -0.53, (98.119, -31.656, 63.119)), (' F 113  ARG  NH1', ' F 114  THR  O  ', -0.526, (96.998, -21.396, -9.886)), (' S 418  ILE  HA ', ' S 422  ASN HD22', -0.525, (94.883, -37.472, 120.132)), (' C  40  ALA  HB3', ' C  43  LYS  HB2', -0.523, (61.344, 21.754, 11.248)), (' b 350  VAL HG22', ' b 422  ASN  HB3', -0.521, (101.422, -1.957, 24.289)), (' b 372  ALA  HB3', ' b 374  PHE  CZ ', -0.521, (91.408, -12.046, 39.974)), (' O 145  SER  HB2', ' O 234  CYS  HB3', -0.52, (-33.178, 13.059, 96.311)), (' b 398  ASP  OD2', ' b 423  TYR  OH ', -0.519, (104.679, -2.217, 33.65)), (' O  52  LYS  O  ', ' O  74  ARG  NH1', -0.519, (19.302, 11.429, 68.283)), (' K 376  THR  HB ', ' K 435  ALA  HB3', -0.518, (40.113, 36.124, 67.298)), (' N 171  GLN  HG3', ' N 178  TYR  CZ ', -0.517, (44.222, -26.212, 96.436)), (' D 168  VAL HG22', ' D 180  LEU HD12', -0.516, (45.599, 15.076, -0.8)), (' F 119  SER  HB2', ' F 142  ASN  HB2', -0.516, (107.388, -24.848, -2.972)), (' T 133  PRO  HB2', ' T 221  VAL HG13', -0.516, (99.787, -20.588, -48.147)), (' O   9  GLY  HA3', ' O  18  LEU HD21', -0.515, (0.067, 1.433, 71.337)), (' H  67  ARG  NH1', ' H  85  SER  O  ', -0.514, (73.871, -40.403, 86.57)), (' b 417  LYS  HE2', ' b 455  LEU HD12', -0.511, (102.996, -3.056, 13.345)), (' P  13  VAL  HB ', ' P  17  GLU  HB2', -0.507, (6.554, 20.347, 108.594)), (' D  45  LYS  NZ ', ' D 301  HOH  O  ', -0.506, (57.187, 1.986, 4.075)), (' T  12  LYS  NZ ', ' T  17  SER  O  ', -0.506, (88.079, -15.303, -11.299)), (' C 117  LYS  HE3', ' C 120  TYR  CE1', -0.504, (65.756, -0.849, 20.287)), (' E 213  ILE HG12', ' E 228  LYS  HG2', -0.502, (116.399, -25.656, 19.734)), (' L 110  ARG  NH1', ' L 111  THR  O  ', -0.502, (103.172, -27.459, 54.304)), (' J  48  LEU HD23', ' J  59  ILE HD12', -0.501, (57.42, 17.12, 115.13)), (' T  18  VAL  O  ', ' T  82  GLU  HA ', -0.501, (90.419, -10.284, -7.794)), (' H   2  VAL HG23', ' H  27  PHE  HD1', -0.5, (104.47, -40.705, 95.856)), (' H 111  ASP  N  ', ' H 111  ASP  OD1', -0.497, (101.595, -33.043, 92.358)), (' P  72  GLY  HA3', ' P  77  PHE  HA ', -0.496, (23.743, 15.582, 98.601)), (' G 403  ARG HH21', ' G 505  TYR  HD2', -0.496, (52.36, -7.95, 15.456)), (' F  67  ARG  NH1', ' F  88  ASP  OD2', -0.494, (82.106, -17.481, 0.214)), (' H  36  TRP  CE2', ' H  81  MET  HB2', -0.492, (87.882, -41.067, 92.795)), (' U 126  GLN  NE2', ' U 133  SER  OG ', -0.492, (88.667, -16.861, -43.711)), (' B 168  GLN  HB3', ' B 175  TYR  CZ ', -0.49, (40.159, -22.044, -36.207)), (' D 122  ILE HG13', ' D 212  LYS  HB3', -0.489, (30.313, 13.111, -3.362)), (' N  39  LEU HD22', ' N  77  PHE  CG ', -0.488, (70.991, -25.957, 103.655)), (' F 118  PRO  HB3', ' F 144  PHE  HB3', -0.488, (103.346, -27.782, -6.543)), (' b 347  PHE  CD2', ' b 509  ARG  HG2', -0.488, (92.199, -3.709, 31.371)), (' A  99  PRO  HA ', ' A 111  ASP  OD1', -0.488, (35.626, -20.377, -5.564)), (' H  91  THR HG23', ' H 120  THR  HA ', -0.488, (82.766, -45.067, 78.027)), (' D 130  LEU  O  ', ' D 188  LYS  HD2', -0.488, (22.809, 25.779, 11.875)), (' E  71  THR  HB ', ' E  84  GLN  HB3', -0.487, (76.881, -42.795, 31.203)), (' P 130  LEU  O  ', ' P 188  LYS  HD2', -0.487, (-33.621, -3.513, 87.091)), (' b 357  ARG  NH1', ' b 359  SER  OG ', -0.482, (104.142, 5.414, 47.056)), (' U 160  ASN  N  ', ' U 160  ASN  OD1', -0.479, (82.431, -5.451, -44.198)), (' T 108  ASP  OD2', ' b 477  SER  OG ', -0.478, (113.234, 10.354, -0.34)), (' A  18  VAL  O  ', ' A  82  GLU  HA ', -0.477, (55.395, -8.731, -8.108)), (' O  34  MET  SD ', ' O 100  THR HG22', -0.477, (13.644, 16.007, 73.134)), (' H 136  PRO  HB2', ' H 223  PRO  HG3', -0.476, (95.42, -52.301, 44.572)), (' F  87  GLU  N  ', ' F  87  GLU  OE1', -0.476, (88.156, -17.526, 0.747)), (' G 454  ARG  NH1', ' G 702  HOH  O  ', -0.476, (40.969, -25.344, 16.947)), (' J 151  LYS  HB2', ' J 195  ALA  HB3', -0.475, (29.896, 24.783, 153.587)), (' I 129  PRO  HD2', ' I 215  THR HG21', -0.475, (38.307, 47.308, 132.357)), (' N 118  PRO  HB3', ' N 144  PHE  HB3', -0.472, (33.689, -25.872, 92.876)), (' L  19  ALA  HB2', ' L  79  LEU HD11', -0.47, (105.101, -21.223, 71.166)), (' E 147  LYS  HB3', ' F 122  ILE HG23', -0.469, (117.836, -30.405, -1.032)), (' F 141  LEU HD13', ' F 180  LEU HD22', -0.469, (105.183, -33.898, -2.725)), (' J 172  ASP  OD1', ' J 174  THR  OG1', -0.467, (53.062, 23.057, 141.23)), (' D 118  PRO  HB3', ' D 144  PHE  HB3', -0.465, (42.299, 7.953, -6.454)), (' E  70  PHE  HA ', ' E  84  GLN  O  ', -0.464, (77.84, -43.803, 27.722)), (' B 172  ASP  OD1', ' B 174  THR  OG1', -0.463, (35.487, -18.822, -42.282)), (' E   2  VAL HG23', ' E  27  PHE  CD1', -0.462, (78.524, -20.293, 27.158)), (' P  39  LEU HD22', ' P  77  PHE  CG ', -0.461, (22.763, 14.704, 94.903)), (' P  60  ARG  NH1', ' P  68  PHE  O  ', -0.461, (16.159, 27.054, 96.353)), (' A  32  SER  OG ', ' A  33  ALA  N  ', -0.46, (40.256, -17.795, -0.201)), (' O 157  GLY  HA2', ' O 172  TRP  CH2', -0.459, (-22.021, 14.785, 86.891)), (' P  39  LEU  HG ', ' P  40  ALA  N  ', -0.459, (20.454, 15.076, 91.047)), (' D 138  VAL HG22', ' D 183  THR HG23', -0.459, (35.08, 18.139, 5.452)), (' M  12  VAL HG11', ' M  88  LEU HD13', -0.458, (50.813, -7.354, 124.746)), (' K 439  ASN  O  ', ' K 443  SER  OG ', -0.458, (26.656, 31.474, 75.191)), (' U 136  CYS  HB2', ' U 150  TRP  CH2', -0.458, (92.517, -6.872, -49.049)), (' J  21  LEU HD23', ' J 104  THR  HB ', -0.457, (48.472, 11.329, 122.704)), (' N  97  TYR  HA ', ' N 100  THR  O  ', -0.456, (70.35, -21.348, 115.117)), (' P  87  GLU  N  ', ' P  87  GLU  OE1', -0.455, (0.434, 24.905, 98.293)), (' D   4  MET  HE3', ' D  96  GLN  HG2', -0.455, (78.565, 15.138, 9.991)), (' G 439  ASN  O  ', ' G 443  SER  OG ', -0.455, (62.312, -10.56, 24.02)), (' L 110  ARG  HG2', ' L 111  THR  N  ', -0.452, (104.636, -26.061, 56.342)), (' N  43  GLN  HG3', ' N  92  TYR  CE2', -0.452, (56.31, -29.782, 104.313)), (' D 191  TYR  O  ', ' D 197  TYR  OH ', -0.452, (23.739, 25.141, 1.151)), (' N 201  VAL  HB ', ' N 210  VAL HG12', -0.452, (27.677, -21.803, 89.767)), (' J  67  GLY  HA3', ' J  72  PHE  HA ', -0.452, (49.735, 2.457, 113.2)), (' b 354  ASN  O  ', ' b 398  ASP  HA ', -0.451, (99.534, 0.519, 34.566)), (' O  11  LEU  HB2', ' O 165  PRO  HG3', -0.45, (-6.373, -1.839, 76.337)), (' K 433  VAL HG22', ' K 512  VAL HG22', -0.449, (46.592, 31.503, 65.279)), (' I 210  HIS  CD2', ' I 212  PRO  HD2', -0.448, (39.8, 43.543, 127.086)), (' C 137  PRO  HD2', ' C 223  THR HG21', -0.448, (38.248, 19.262, 22.535)), (' E  12  VAL HG11', ' E  88  LEU HD13', -0.448, (86.905, -46.156, 25.31)), (' K 347  PHE  CE2', ' K 399  SER  HB2', -0.447, (37.929, 25.353, 65.778)), (' L 168  GLN  HB3', ' L 175  TYR  CZ ', -0.447, (97.915, -31.102, 63.486)), (' O  34  MET  HB3', ' O  81  LEU HD22', -0.447, (13.046, 11.753, 72.292)), (' C  73  SER  HB2', ' C  82  TYR  HB2', -0.446, (68.643, 17.24, 33.372)), (' M 204  SER  HA ', ' M 207  LEU  HG ', -0.446, (19.028, -34.635, 106.378)), (' H 105  SER  OG ', ' H 106  CYS  N  ', -0.446, (105.103, -29.849, 102.551)), (' I  89  GLU  H  ', ' I  89  GLU  HG2', -0.446, (26.358, 27.411, 118.94)), (' K 454  ARG  NH2', ' K 469  SER  OG ', -0.445, (47.405, 14.354, 80.388)), (' I  64  PHE  O  ', ' I  68  VAL HG12', -0.445, (30.117, 24.1, 105.574)), (' D 113  ARG  HG2', ' D 114  THR  H  ', -0.445, (51.453, 1.47, -9.711)), (' T 210  HIS  CD2', ' T 212  PRO  HD2', -0.444, (96.696, -21.172, -27.355)), (' M 117  LYS  HE2', ' M 120  TYR  CE1', -0.444, (57.804, -34.9, 119.911)), (' G 433  VAL HG12', ' G 512  VAL HG13', -0.444, (41.829, -11.475, 34.429)), (' O  95  VAL  HA ', ' O 126  LEU  HA ', -0.444, (1.145, 4.931, 79.636)), (' E 137  PRO  HD2', ' E 223  THR HG21', -0.443, (107.348, -38.565, 22.62)), (' H 180  LEU HD23', ' H 181  GLN  O  ', -0.442, (77.07, -44.873, 67.763)), (' N  91  ILE HG13', ' N 107  THR  H  ', -0.442, (56.72, -22.138, 102.618)), (' I  38  ARG  HB3', ' I  48  ILE HD11', -0.442, (37.112, 26.147, 112.656)), (' F  95  GLN  HB2', ' F 103  PHE  CD1', -0.441, (74.147, -31.101, 11.563)), (' H  16  THR HG22', ' H  17  SER  H  ', -0.441, (76.462, -48.791, 88.536)), (' P 163  ASN  N  ', ' P 163  ASN  OD1', -0.441, (-20.568, -5.375, 99.863)), (' B  48  LEU HD11', ' B  87  TYR  HE2', -0.44, (34.245, -27.095, -19.911)), (' O 147  LYS  HB3', ' P 122  ILE HG22', -0.439, (-28.588, 11.734, 100.427)), (' C 111  PRO  HB3', ' b 499  PRO  HG3', -0.439, (80.42, -8.07, 21.107)), (' M   3  GLN  HG2', ' M   5  VAL HG23', -0.439, (51.219, -30.156, 126.752)), (' P  41  TRP  CE2', ' P  79  LEU  HB2', -0.439, (16.547, 16.636, 96.132)), (' K 350  VAL HG22', ' K 422  ASN  HB3', -0.439, (44.67, 24.323, 74.888)), (' F  71  SER  OG ', ' F  72  GLY  N  ', -0.438, (64.918, -23.098, -0.46)), (' H  99  PRO  HA ', ' H 111  ASP  OD1', -0.438, (101.823, -33.483, 94.095)), (' G 408  ARG  NH2', ' G 703  HOH  O  ', -0.438, (39.726, -6.17, 19.071)), (' B 168  GLN  HB3', ' B 175  TYR  CE1', -0.437, (40.241, -21.795, -36.196)), (' I  91  THR HG23', ' I 120  THR  HA ', -0.437, (33.961, 33.26, 120.451)), (' K 448  ASN  HB3', ' K 497  PHE  HB2', -0.436, (29.981, 27.076, 78.73)), (' T   2  VAL  HA ', ' T  25  SER  O  ', -0.435, (113.336, -9.214, -4.288)), (' D 168  VAL HG22', ' D 180  LEU  CD1', -0.434, (45.586, 15.481, -1.032)), (' T  11  VAL HG21', ' T 157  PRO  HG3', -0.433, (91.782, -18.472, -21.832)), (' M   2  VAL  HA ', ' M  26  GLY  HA3', -0.433, (56.872, -35.463, 127.77)), (' O 227  LYS  HA ', ' O 227  LYS  HD2', -0.433, (-26.572, 10.694, 79.182)), (' U  62  ARG  HD2', ' U  78  ARG  O  ', -0.432, (119.332, 10.935, -24.858)), (' F   4  MET  HE1', ' F  25  SER  HB3', -0.432, (65.597, -34.496, 6.885)), (' b 408  ARG  O  ', ' b 414  GLN  HG3', -0.432, (106.069, -12.972, 25.82)), (' M 121  TRP  CE3', ' N  50  PRO  HD2', -0.431, (56.36, -24.749, 115.279)), (' N 113  ARG  HG2', ' N 114  THR  N  ', -0.431, (43.31, -32.534, 89.093)), (' J  62  ARG  NE ', ' J  83  ASP  OD2', -0.431, (61.537, 14.678, 123.194)), (' b 336  CYS  SG ', ' b 363  ALA  HB2', -0.431, (98.727, -4.442, 49.157)), (' O  40  ALA  HB3', ' O  43  LYS  HB2', -0.43, (5.254, 1.206, 88.361)), (' M 217  ASN  ND2', ' M 224  LYS  HE2', -0.43, (34.347, -22.795, 126.032)), (' b 347  PHE  CE2', ' b 399  SER  HB2', -0.43, (94.641, -2.502, 33.5)), (' K 454  ARG  HA ', ' K 492  LEU HD23', -0.43, (43.985, 20.237, 81.326)), (' I  51  ILE HG13', ' I  58  THR HG22', -0.429, (38.274, 25.217, 97.718)), (' J  36  TRP  CE2', ' J  74  LEU  HB2', -0.429, (51.17, 8.799, 116.366)), (' U  48  LEU HD11', ' U  87  TYR  HE2', -0.429, (111.439, 7.357, -19.974)), (' N  67  ARG  NH1', ' N  88  ASP  OD1', -0.429, (54.509, -36.15, 100.949)), (' C  70  PHE  HA ', ' C  84  GLN  O  ', -0.428, (67.781, 24.33, 28.031)), (' P  71  SER  OG ', ' P  72  GLY  N  ', -0.428, (23.635, 19.069, 100.426)), (' M 102  GLY  HA2', ' M 105  TYR  HE2', -0.427, (68.193, -26.97, 116.678)), (' K 497  PHE  CE2', ' K 507  PRO  HB3', -0.427, (33.369, 28.931, 75.977)), (' F  41  TRP  CE2', ' F  79  LEU  HB2', -0.427, (72.33, -25.367, 2.601)), (' M 147  LYS  HE2', ' M 235  ASP  CB ', -0.426, (14.325, -24.311, 96.704)), (' E  34  MET  HB3', ' E  81  LEU HD22', -0.426, (76.128, -30.55, 27.038)), (' N  91  ILE HD11', ' N 106  GLY  HA3', -0.426, (57.042, -19.609, 103.815)), (' G 387  LEU  O  ', ' G 387  LEU HD23', -0.426, (40.706, -9.129, 48.749)), (' N  87  GLU  N  ', ' N  87  GLU  OE1', -0.425, (49.088, -36.148, 100.267)), (' F 163  ASN  N  ', ' F 163  ASN  OD1', -0.425, (109.557, -47.608, -0.727)), (' N 168  VAL HG12', ' N 169  THR  O  ', -0.425, (40.568, -22.377, 99.958)), (' G 412  PRO  HG3', ' G 429  PHE  HB3', -0.425, (34.892, -9.434, 33.743)), (' S 502  GLY  O  ', ' S 506  GLN  HG3', -0.425, (80.352, -48.599, 120.175)), (' I  38  ARG  HG2', ' I  46  GLU  HB2', -0.424, (36.498, 22.782, 114.464)), (' B  36  TRP  HB2', ' B  49  ILE  HB ', -0.424, (36.122, -29.917, -14.543)), (' B 188  TYR  O  ', ' B 194  TYR  OH ', -0.424, (63.779, -6.985, -53.6)), (' D  43  GLN  HG3', ' D  92  TYR  CE2', -0.423, (64.559, 4.556, 4.992)), (' S 458  LYS  HA ', ' S 458  LYS  HD3', -0.423, (103.63, -30.074, 112.344)), (' U  36  TRP  HB2', ' U  49  ILE  HB ', -0.422, (109.622, 10.719, -14.436)), (' I 164  TRP  HB3', ' I 169  LEU HD23', -0.422, (52.06, 40.491, 142.683)), (' D 112  LYS  HA ', ' D 145  TYR  OH ', -0.421, (54.972, 6.669, -8.964)), (' C 140  PHE  CE2', ' D 129  GLN  HG3', -0.421, (31.119, 21.51, 13.557)), (' T  39  GLN  NE2', ' T  43  GLN  O  ', -0.421, (98.507, 1.043, -22.268)), (' M 181  VAL  C  ', ' M 182  HIS  HD1', -0.42, (34.397, -30.147, 107.705)), (' G 354  ASN  O  ', ' G 398  ASP  HA ', -0.42, (46.215, -19.953, 34.649)), (' J  39  GLN  O  ', ' J  85  ALA  HB1', -0.42, (50.959, 20.401, 123.037)), (' M 102  GLY  HA3', ' N 101  LEU HD11', -0.42, (67.563, -24.444, 117.595)), (' E 234  CYS  HA ', ' F 218  GLU  O  ', -0.419, (125.858, -31.408, 1.474)), (' b 502  GLY  O  ', ' b 506  GLN  HG3', -0.419, (88.533, -14.003, 20.705)), (' G 490  PHE  CD1', ' G 491  PRO  HD2', -0.419, (46.112, -27.754, 13.261)), (' S 336  CYS  HB2', ' S 363  ALA  HB2', -0.419, (88.634, -38.376, 148.472)), (' H  12  LYS  HE3', ' H  17  SER  O  ', -0.418, (79.277, -49.142, 87.947)), (' H 220  LYS  HD2', ' H 220  LYS  N  ', -0.418, (94.997, -60.724, 54.438)), (' N 145  TYR  CG ', ' N 146  PRO  HA ', -0.418, (42.073, -26.494, 90.822)), (' B  79  LEU  HA ', ' B  79  LEU HD23', -0.417, (29.21, -29.831, -26.415)), (' H 148  LEU HD13', ' H 221  VAL HG11', -0.417, (95.772, -52.901, 52.079)), (' K 502  GLY  O  ', ' K 506  GLN  HG3', -0.417, (32.073, 37.071, 78.413)), (' M  20  LEU HD13', ' M  85  MET  HE2', -0.417, (52.879, -12.927, 125.951)), (' b 380  TYR  CE2', ' b 412  PRO  HD2', -0.416, (108.918, -12.985, 32.116)), (' K 403  ARG  HG2', ' K 505  TYR  HA ', -0.416, (36.305, 34.321, 79.887)), (' G 339  GLY  O  ', ' G 343  ASN  HB2', -0.416, (57.464, -16.355, 40.972)), (' M 102  GLY  HA2', ' M 105  TYR  CE2', -0.415, (68.245, -27.046, 116.777)), (' H  39  GLN  HB2', ' H  45  LEU HD23', -0.415, (90.515, -33.981, 81.232)), (' A  91  THR HG23', ' A 120  THR  HA ', -0.415, (54.926, -8.366, -21.381)), (' G 367  VAL  O  ', ' G 371  SER  N  ', -0.414, (53.767, -5.446, 44.971)), (' L  21  LEU HD23', ' L 104  THR  HB ', -0.414, (97.485, -22.476, 75.651)), (' E 187  VAL HG11', ' F 166  GLU  O  ', -0.413, (100.901, -39.39, 3.834)), (' K 347  PHE  CD2', ' K 509  ARG  HG2', -0.413, (35.127, 26.893, 67.53)), (' E 137  PRO  HB3', ' E 163  TYR  HB3', -0.413, (105.133, -40.354, 18.179)), (' E  30  ARG  HG3', ' E  31  ASP  OD1', -0.413, (69.174, -22.115, 33.71)), (' S 390  LEU  HA ', ' S 390  LEU HD12', -0.413, (101.586, -43.938, 151.921)), (' B   7  SER  HA ', ' B   8  PRO  HA ', -0.412, (45.698, -35.679, -25.63)), (' I  47  TRP  CE2', ' J  98  TRP  HB2', -0.41, (39.331, 17.479, 106.318)), (' F 112  LYS  HA ', ' F 145  TYR  OH ', -0.41, (90.672, -25.966, -9.001)), (' H  55  SER  HA ', ' S 455  LEU HD11', -0.41, (91.0, -35.608, 109.741)), (' B 165  VAL HG22', ' B 177  LEU  HB2', -0.41, (48.26, -17.754, -39.629)), (' L 126  GLN  HG2', ' L 131  THR  O  ', -0.41, (78.331, -53.193, 54.009)), (' E  56  ASP  OD1', ' G 346  ARG  NH1', -0.409, (60.804, -25.508, 28.897)), (' D 160  GLN  HG3', ' D 163  ASN HD21', -0.409, (32.623, 28.127, -1.51)), (' B 152  VAL HG21', ' B 157  GLN HE21', -0.409, (63.735, -12.714, -50.383)), (' E 102  GLY  HA2', ' E 105  TYR  HE2', -0.409, (69.341, -26.362, 17.114)), (' M 109  VAL  O  ', ' S 444  LYS  HE2', -0.409, (72.517, -35.467, 123.69)), (' D 120  VAL HG11', ' D 201  VAL HG21', -0.409, (36.511, 11.985, -6.89)), (' H  16  THR HG22', ' H  17  SER  N  ', -0.409, (76.482, -49.053, 88.139)), (' G 357  ARG  HG3', ' G 396  TYR  CE1', -0.408, (40.785, -23.444, 42.347)), (' L  92  TYR  HA ', ' L  98  TRP  CD1', -0.408, (90.036, -25.115, 93.893)), (' C 137  PRO  HB3', ' C 163  TYR  HB3', -0.408, (40.486, 20.632, 18.333)), (' A 149  GLY  HA2', ' A 164  TRP  CH2', -0.408, (42.861, -3.099, -44.817)), (' K 453  TYR  OH ', ' K 493  GLN  OE1', -0.408, (40.326, 26.599, 85.691)), (' F  83  SER  O  ', ' F  83  SER  OG ', -0.407, (81.182, -15.196, -4.734)), (' b 379  CYS  SG ', ' b 384  PRO  HG3', -0.407, (102.991, -15.228, 42.069)), (' B  84  PHE  CD2', ' B 108  ILE HG13', -0.406, (33.022, -25.803, -32.226)), (' I 178  ALA  HA ', ' I 188  LEU  HB3', -0.406, (38.789, 34.016, 133.706)), (' H 178  ALA  HB2', ' H 188  LEU HD23', -0.405, (88.489, -46.644, 66.884)), (' T 111  ASP  HB3', ' U  47  LEU HD23', -0.405, (111.401, 3.711, -8.743)), (' N 141  LEU HD13', ' N 180  LEU HD22', -0.405, (31.935, -20.031, 96.474)), (' H  12  LYS  HA ', ' H  12  LYS  HD2', -0.404, (79.028, -51.448, 84.169)), (' L  82  GLU  N  ', ' L  82  GLU  OE1', -0.404, (109.99, -31.275, 72.304)), (' P  97  TYR  HA ', ' P 100  THR  O  ', -0.404, (22.251, 10.243, 83.827)), (' P  67  ARG  H  ', ' P  67  ARG  HG3', -0.403, (10.314, 28.841, 98.604)), (' C 142  LEU HD21', ' D 138  VAL HG21', -0.403, (34.048, 15.631, 6.718)), (' G 520  ALA  HB1', ' G 521  PRO  HD2', -0.403, (33.291, -24.793, 51.878)), (' O  64  ALA  HB3', ' O  65  PRO  HD3', -0.403, (17.179, -3.61, 83.333)), (' S 360  ASN  HA ', ' S 523  THR  HB ', -0.403, (94.946, -32.301, 152.943)), (' H 156  PHE  HA ', ' H 157  PRO  HA ', -0.403, (83.238, -51.271, 71.94)), (' F  45  LYS  HG2', ' F  90  ALA  HB2', -0.403, (85.954, -24.834, 5.523)), (' C  12  VAL HG11', ' C  88  LEU HD13', -0.402, (58.492, 26.803, 25.371)), (' U  62  ARG HH21', ' U  83  ASP  CG ', -0.401, (117.23, 6.777, -24.123)), (' U  16  GLY  HA2', ' U  78  ARG  HG3', -0.401, (121.012, 12.829, -29.26)), (' S 354  ASN  O  ', ' S 398  ASP  HA ', -0.4, (91.631, -33.894, 134.152)), (' N  51  LYS  HB2', ' N  51  LYS  HE3', -0.4, (54.269, -31.195, 110.738)), (' I  36  TRP  CE2', ' I  81  MET  HB2', -0.4, (39.189, 29.38, 105.531))]
handle_read_draw_probe_dots_unformatted("molprobity_probe.txt", 0, 0)
show_probe_dots(True, True)
gui = coot_molprobity_todo_list_gui(data=data)
