# script auto-generated by phenix.molprobity


from __future__ import absolute_import, division, print_function
from six.moves import cPickle as pickle
from six.moves import range
try :
  import gobject
except ImportError :
  gobject = None
import sys

class coot_extension_gui(object):
  def __init__(self, title):
    import gtk
    self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)
    scrolled_win = gtk.ScrolledWindow()
    self.outside_vbox = gtk.VBox(False, 2)
    self.inside_vbox = gtk.VBox(False, 0)
    self.window.set_title(title)
    self.inside_vbox.set_border_width(0)
    self.window.add(self.outside_vbox)
    self.outside_vbox.pack_start(scrolled_win, True, True, 0)
    scrolled_win.add_with_viewport(self.inside_vbox)
    scrolled_win.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)

  def finish_window(self):
    import gtk
    self.outside_vbox.set_border_width(2)
    ok_button = gtk.Button("  Close  ")
    self.outside_vbox.pack_end(ok_button, False, False, 0)
    ok_button.connect("clicked", lambda b: self.destroy_window())
    self.window.connect("delete_event", lambda a, b: self.destroy_window())
    self.window.show_all()

  def destroy_window(self, *args):
    self.window.destroy()
    self.window = None

  def confirm_data(self, data):
    for data_key in self.data_keys :
      outlier_list = data.get(data_key)
      if outlier_list is not None and len(outlier_list) > 0 :
        return True
    return False

  def create_property_lists(self, data):
    import gtk
    for data_key in self.data_keys :
      outlier_list = data[data_key]
      if outlier_list is None or len(outlier_list) == 0 :
        continue
      else :
        frame = gtk.Frame(self.data_titles[data_key])
        vbox = gtk.VBox(False, 2)
        frame.set_border_width(6)
        frame.add(vbox)
        self.add_top_widgets(data_key, vbox)
        self.inside_vbox.pack_start(frame, False, False, 5)
        list_obj = residue_properties_list(
          columns=self.data_names[data_key],
          column_types=self.data_types[data_key],
          rows=outlier_list,
          box=vbox)

# Molprobity result viewer
class coot_molprobity_todo_list_gui(coot_extension_gui):
  data_keys = [ "rama", "rota", "cbeta", "probe" ]
  data_titles = { "rama"  : "Ramachandran outliers",
                  "rota"  : "Rotamer outliers",
                  "cbeta" : "C-beta outliers",
                  "probe" : "Severe clashes" }
  data_names = { "rama"  : ["Chain", "Residue", "Name", "Score"],
                 "rota"  : ["Chain", "Residue", "Name", "Score"],
                 "cbeta" : ["Chain", "Residue", "Name", "Conf.", "Deviation"],
                 "probe" : ["Atom 1", "Atom 2", "Overlap"] }
  if (gobject is not None):
    data_types = { "rama" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "rota" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "cbeta" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT],
                   "probe" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT] }
  else :
    data_types = dict([ (s, []) for s in ["rama","rota","cbeta","probe"] ])

  def __init__(self, data_file=None, data=None):
    assert ([data, data_file].count(None) == 1)
    if (data is None):
      data = load_pkl(data_file)
    if not self.confirm_data(data):
      return
    coot_extension_gui.__init__(self, "MolProbity to-do list")
    self.dots_btn = None
    self.dots2_btn = None
    self._overlaps_only = True
    self.window.set_default_size(420, 600)
    self.create_property_lists(data)
    self.finish_window()

  def add_top_widgets(self, data_key, box):
    import gtk
    if data_key == "probe" :
      hbox = gtk.HBox(False, 2)
      self.dots_btn = gtk.CheckButton("Show Probe dots")
      hbox.pack_start(self.dots_btn, False, False, 5)
      self.dots_btn.connect("toggled", self.toggle_probe_dots)
      self.dots2_btn = gtk.CheckButton("Overlaps only")
      hbox.pack_start(self.dots2_btn, False, False, 5)
      self.dots2_btn.connect("toggled", self.toggle_all_probe_dots)
      self.dots2_btn.set_active(True)
      self.toggle_probe_dots()
      box.pack_start(hbox, False, False, 0)

  def toggle_probe_dots(self, *args):
    if self.dots_btn is not None :
      show_dots = self.dots_btn.get_active()
      overlaps_only = self.dots2_btn.get_active()
      if show_dots :
        self.dots2_btn.set_sensitive(True)
      else :
        self.dots2_btn.set_sensitive(False)
      show_probe_dots(show_dots, overlaps_only)

  def toggle_all_probe_dots(self, *args):
    if self.dots2_btn is not None :
      self._overlaps_only = self.dots2_btn.get_active()
      self.toggle_probe_dots()

class rsc_todo_list_gui(coot_extension_gui):
  data_keys = ["by_res", "by_atom"]
  data_titles = ["Real-space correlation by residue",
                 "Real-space correlation by atom"]
  data_names = {}
  data_types = {}

class residue_properties_list(object):
  def __init__(self, columns, column_types, rows, box,
      default_size=(380,200)):
    assert len(columns) == (len(column_types) - 1)
    if (len(rows) > 0) and (len(rows[0]) != len(column_types)):
      raise RuntimeError("Wrong number of rows:\n%s" % str(rows[0]))
    import gtk
    self.liststore = gtk.ListStore(*column_types)
    self.listmodel = gtk.TreeModelSort(self.liststore)
    self.listctrl = gtk.TreeView(self.listmodel)
    self.listctrl.column = [None]*len(columns)
    self.listctrl.cell = [None]*len(columns)
    for i, column_label in enumerate(columns):
      cell = gtk.CellRendererText()
      column = gtk.TreeViewColumn(column_label)
      self.listctrl.append_column(column)
      column.set_sort_column_id(i)
      column.pack_start(cell, True)
      column.set_attributes(cell, text=i)
    self.listctrl.get_selection().set_mode(gtk.SELECTION_SINGLE)
    for row in rows :
      self.listmodel.get_model().append(row)
    self.listctrl.connect("cursor-changed", self.OnChange)
    sw = gtk.ScrolledWindow()
    w, h = default_size
    if len(rows) > 10 :
      sw.set_size_request(w, h)
    else :
      sw.set_size_request(w, 30 + (20 * len(rows)))
    sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
    box.pack_start(sw, False, False, 5)
    inside_vbox = gtk.VBox(False, 0)
    sw.add(self.listctrl)

  def OnChange(self, treeview):
    import coot # import dependency
    selection = self.listctrl.get_selection()
    (model, tree_iter) = selection.get_selected()
    if tree_iter is not None :
      row = model[tree_iter]
      xyz = row[-1]
      if isinstance(xyz, tuple) and len(xyz) == 3 :
        set_rotation_centre(*xyz)
        set_zoom(30)
        graphics_draw()

def show_probe_dots(show_dots, overlaps_only):
  import coot # import dependency
  n_objects = number_of_generic_objects()
  sys.stdout.flush()
  if show_dots :
    for object_number in range(n_objects):
      obj_name = generic_object_name(object_number)
      if overlaps_only and not obj_name in ["small overlap", "bad overlap"] :
        sys.stdout.flush()
        set_display_generic_object(object_number, 0)
      else :
        set_display_generic_object(object_number, 1)
  else :
    sys.stdout.flush()
    for object_number in range(n_objects):
      set_display_generic_object(object_number, 0)

def load_pkl(file_name):
  pkl = open(file_name, "rb")
  data = pickle.load(pkl)
  pkl.close()
  return data

data = {}
data['rama'] = []
data['omega'] = []
data['rota'] = []
data['cbeta'] = []
data['probe'] = [(' B 391  CYS  HA ', ' B 525  CYS  HB3', -0.917, (151.791, 193.976, 141.546)), (' A 391  CYS  HA ', ' A 525  CYS  HB3', -0.904, (202.695, 184.066, 141.545)), (' C 379  CYS  HA ', ' C 432  CYS  HB3', -0.874, (170.33, 159.737, 135.436)), (' C 391  CYS  HA ', ' C 525  CYS  HB3', -0.858, (168.446, 145.428, 141.935)), (' B 379  CYS  HA ', ' B 432  CYS  HB3', -0.836, (163.203, 185.83, 135.69)), (' B 433  VAL HG12', ' B 512  VAL HG22', -0.817, (167.362, 190.376, 130.918)), (' A 379  CYS  HA ', ' A 432  CYS  HB3', -0.778, (189.822, 178.305, 135.611)), (' A  99  ASN HD22', ' A1301  BLA HMB2', -0.704, (159.16, 233.097, 150.268)), (' A 131  CYS  HA ', ' A 166  CYS  HB3', -0.695, (165.231, 219.027, 129.849)), (' B 131  CYS  HA ', ' B 166  CYS  HB3', -0.694, (140.728, 144.335, 129.526)), (' C 213  VAL HG23', ' C 214  ARG  HG2', -0.686, (231.137, 146.073, 164.547)), (' A 213  VAL HG23', ' A 214  ARG  HG2', -0.681, (171.332, 237.753, 164.317)), (' A 129  LYS  HG2', ' A 169  GLU  HG2', -0.68, (159.152, 220.86, 132.913)), (' C 153  MET  HE3', ' C1302  NAG  H3 ', -0.672, (247.769, 157.829, 138.09)), (' B  61  ASN  HB3', ' M   1  NAG  HN2', -0.671, (126.05, 156.596, 161.914)), (' C 414  GLN  O  ', ' C 424  LYS  NZ ', -0.668, (159.843, 170.631, 135.413)), (' B 213  VAL HG23', ' B 214  ARG  HG2', -0.666, (121.442, 139.438, 164.465)), (' B 153  MET  HE3', ' B1302  NAG  H3 ', -0.656, (122.576, 119.33, 138.129)), (' B 403  ARG  NH2', ' B 504  GLY  O  ', -0.654, (177.694, 183.582, 117.402)), (' B 538  CYS  HB3', ' B 551  VAL HG23', -0.654, (140.483, 187.41, 163.95)), (' C  61  ASN  HB3', ' X   1  NAG  HN2', -0.652, (213.883, 141.466, 162.008)), (' A 414  GLN  O  ', ' A 424  LYS  NZ ', -0.651, (184.895, 163.708, 135.778)), (' A 153  MET  HE3', ' A1302  NAG  H3 ', -0.651, (152.673, 246.445, 138.025)), (' A 310  LYS  NZ ', ' A 663  ASP  OD1', -0.641, (178.549, 204.773, 193.688)), (' B 389  ASP  OD1', ' B 528  LYS  NZ ', -0.641, (147.457, 185.957, 142.212)), (' B 414  GLN  O  ', ' B 424  LYS  NZ ', -0.639, (178.146, 188.648, 135.616)), (' A 354  ASN  HB3', ' A 399  SER  HB3', -0.636, (200.046, 169.293, 125.016)), (' C 615  VAL HG13', ' C 634  ARG  HB2', -0.633, (186.807, 139.941, 174.129)), (' C 379  CYS  HA ', ' C 432  CYS  CB ', -0.631, (170.449, 158.963, 135.191)), (' C 129  LYS  HG2', ' C 169  GLU  HG2', -0.627, (222.287, 164.454, 133.082)), (' C 389  ASP  OD1', ' C 528  LYS  NZ ', -0.626, (178.062, 144.844, 142.288)), (' B 436  TRP  HE1', ' B 509  ARG  HD3', -0.625, (162.831, 190.375, 118.393)), (' A 433  VAL HG22', ' A 512  VAL HG22', -0.621, (191.081, 172.579, 131.595)), (' B 310  LYS  NZ ', ' B 663  ASP  OD1', -0.617, (146.105, 162.959, 193.595)), (' B 379  CYS  HA ', ' B 432  CYS  CB ', -0.614, (163.329, 185.629, 135.241)), (' B 523  THR HG23', ' B 524  VAL HG23', -0.612, (153.453, 200.356, 138.72)), (' C 433  VAL HG22', ' C 512  VAL HG22', -0.609, (164.42, 160.495, 131.181)), (' B 129  LYS  HG2', ' B 169  GLU  HG2', -0.607, (141.091, 137.553, 133.179)), (' A  28  TYR  CE2', ' V   1  NAG  H5 ', -0.607, (185.668, 226.706, 158.071)), (' V   1  NAG  H61', ' V   2  NAG  HN2', -0.606, (188.611, 226.148, 157.226)), (' A 389  ASP  OD1', ' A 528  LYS  NZ ', -0.605, (198.321, 192.01, 142.471)), (' C 523  THR HG23', ' C 524  VAL HG23', -0.601, (162.169, 142.809, 139.125)), (' B 376  THR  HB ', ' B 435  ALA  HB3', -0.595, (166.154, 183.88, 125.871)), (' A  61  ASN  HB3', ' V   1  NAG  HN2', -0.589, (182.822, 224.67, 161.868)), (' A 615  VAL HG13', ' A 634  ARG  HB2', -0.589, (197.77, 202.815, 173.695)), (' A 804  GLN HE21', ' J   1  NAG  H62', -0.588, (152.108, 201.257, 213.732)), (' C  34  ARG  NH1', ' C 217  PRO  O  ', -0.588, (221.574, 155.38, 165.684)), (' A 523  THR HG23', ' A 524  VAL HG23', -0.584, (207.865, 179.493, 139.108)), (' B  34  ARG  NH1', ' B 217  PRO  O  ', -0.581, (134.325, 142.803, 165.719)), (' A  99  ASN HD21', ' A 190  ARG HH22', -0.571, (158.082, 232.376, 152.306)), (' B 915  VAL  O  ', ' B 919  ASN  ND2', -0.57, (160.754, 158.241, 232.811)), (' C 131  CYS  HA ', ' C 166  CYS  HB3', -0.569, (217.148, 159.965, 130.114)), (' B 319  ARG  O  ', ' B 636  TYR  OH ', -0.568, (141.326, 176.514, 165.801)), (' B 454  ARG  HD2', ' B 491  PRO  HB2', -0.567, (185.255, 200.468, 123.758)), (' B 244  LEU HD13', ' B 258  TRP  HB2', -0.565, (117.642, 134.404, 141.177)), (' g   2  NAG  H3 ', ' g   2  NAG  H83', -0.565, (166.652, 143.076, 253.759)), (' L   2  NAG  H3 ', ' L   2  NAG  H83', -0.564, (205.291, 182.893, 254.199)), (' W   2  NAG  H3 ', ' W   2  NAG  H83', -0.564, (151.515, 196.788, 254.18)), (' C 804  GLN HE21', ' e   1  NAG  H62', -0.561, (208.723, 180.105, 213.864)), (' C 436  TRP  NE1', ' C 509  ARG  HB2', -0.56, (165.994, 157.557, 120.081)), (' A 379  CYS  HA ', ' A 432  CYS  CB ', -0.559, (189.561, 178.326, 135.172)), (' A 319  ARG  O  ', ' A 636  TYR  OH ', -0.555, (192.705, 202.046, 165.683)), (' A  22  THR  O  ', ' A  78  ARG  NH1', -0.554, (181.271, 239.915, 148.215)), (' B 977  LEU HD11', ' B 993  ILE HG12', -0.554, (177.611, 159.439, 154.73)), (' A  93  ALA  HB3', ' A 266  TYR  HB2', -0.551, (170.19, 226.301, 156.776)), (' C 376  THR  HB ', ' C 435  ALA  HB3', -0.551, (169.669, 162.052, 125.655)), (' C 436  TRP  HE1', ' C 509  ARG  HD3', -0.55, (166.16, 156.632, 118.406)), (' C 437  ASN  HA ', ' C 508  TYR  CD1', -0.549, (168.783, 163.078, 118.805)), (' C 132  GLU  HB2', ' C 164  ASN  O  ', -0.547, (216.94, 157.258, 126.988)), (' A 376  THR  HB ', ' A 435  ALA  HB3', -0.547, (186.683, 176.57, 125.996)), (' C 454  ARG  HD2', ' C 491  PRO  HB2', -0.546, (146.915, 170.835, 124.107)), (' A 244  LEU HD13', ' A 258  TRP  HB2', -0.543, (168.199, 243.495, 141.09)), (' A 130  VAL  O  ', ' A 130  VAL HG13', -0.54, (164.375, 216.845, 132.48)), (' C 406  GLU  O  ', ' C 410  ILE HG12', -0.54, (163.677, 167.5, 127.695)), (' A 454  ARG  HD2', ' A 491  PRO  HB2', -0.539, (191.433, 152.0, 123.734)), (' C 354  ASN  HB3', ' C 399  SER  HB3', -0.538, (156.807, 154.527, 125.192)), (' A  34  ARG  NH1', ' A 217  PRO  O  ', -0.538, (167.245, 225.231, 165.975)), (' C 361  CYS  HB3', ' C 524  VAL HG22', -0.536, (163.908, 142.665, 136.33)), (' A 792  PRO  HG3', ' B 707  TYR  HB3', -0.535, (146.833, 184.763, 222.989)), (' C 437  ASN  HA ', ' C 508  TYR  HD1', -0.534, (168.913, 162.837, 119.234)), (' C 234  ASN  OD1', ' b   1  NAG  N2 ', -0.533, (204.018, 153.815, 138.199)), (' B 722  VAL HG22', ' B1065  VAL HG22', -0.53, (163.316, 156.13, 215.754)), (' C 244  LEU HD13', ' C 258  TRP  HB2', -0.53, (237.563, 145.284, 140.97)), (' A 102  ARG  HG3', ' A 141  LEU HD12', -0.529, (162.663, 233.431, 143.102)), (' B  91  TYR  OH ', ' B 191  GLU  OE2', -0.527, (136.089, 144.027, 159.739)), (' C1050  MET  HE2', ' C1052  PHE  CE1', -0.527, (193.228, 180.924, 216.714)), (' C 538  CYS  HB3', ' C 551  VAL HG23', -0.526, (179.847, 138.347, 164.364)), (' C 319  ARG  O  ', ' C 636  TYR  OH ', -0.525, (189.143, 144.79, 165.818)), (' B 855  PHE  CE2', ' C 589  PRO  HD2', -0.524, (175.502, 144.221, 167.491)), (' B 342  PHE  HE2', ' B 368  LEU HD11', -0.524, (156.178, 191.99, 127.983)), (' B 437  ASN  HA ', ' B 508  TYR  HD2', -0.522, (166.413, 184.806, 118.943)), (' B 234  ASN  OD1', ' Q   1  NAG  N2 ', -0.522, (141.829, 159.11, 138.324)), (' A  28  TYR  HE2', ' V   1  NAG  H5 ', -0.521, (185.779, 227.276, 157.829)), (' C 452  LEU HD21', ' C 492  LEU HD13', -0.52, (146.935, 165.7, 118.738)), (' A 234  ASN  OD1', ' G   1  NAG  N2 ', -0.519, (177.468, 210.342, 138.142)), (' A 361  CYS  HB3', ' A 524  VAL HG22', -0.519, (207.017, 181.519, 135.968)), (' A 922  LEU HD11', ' I   1  NAG  H5 ', -0.519, (168.428, 202.481, 228.184)), (' B 437  ASN  HA ', ' B 508  TYR  CD2', -0.518, (166.663, 184.556, 118.605)), (' B 792  PRO  HG3', ' C 707  TYR  HB3', -0.518, (179.432, 145.425, 222.774)), (' B 287  ASP  HB3', ' B 306  PHE  HE2', -0.518, (146.873, 147.889, 172.074)), (' A 406  GLU  HA ', ' A 409  GLN  NE2', -0.517, (182.687, 165.506, 126.509)), (' A 273  ARG HH21', ' A 292  ALA  HB3', -0.515, (178.998, 210.094, 165.162)), (' C  22  THR  O  ', ' C  78  ARG  NH1', -0.515, (227.74, 135.637, 148.298)), (' B 130  VAL  O  ', ' B 130  VAL HG13', -0.515, (142.9, 144.844, 132.886)), (' A 287  ASP  HB3', ' A 306  PHE  HE1', -0.514, (165.227, 211.544, 172.123)), (' C 452  LEU HD11', ' C 492  LEU  HB3', -0.514, (148.067, 167.763, 117.83)), (' B 188  ASN  ND2', ' B 190  ARG  NH2', -0.512, (133.643, 132.215, 154.501)), (' C 402  ILE  O  ', ' C 508  TYR  HB2', -0.512, (165.168, 164.864, 120.866)), (' B 403  ARG  HB2', ' B 406  GLU  OE1', -0.512, (177.2, 187.344, 121.832)), (' B 615  VAL HG13', ' B 634  ARG  HB2', -0.51, (138.034, 180.473, 173.851)), (' C  91  TYR  OH ', ' C 191  GLU  OE2', -0.508, (219.972, 156.317, 159.833)), (' B 916  LEU HD12', ' B 923  ILE HD12', -0.507, (163.47, 156.217, 228.424)), (' C 273  ARG HH21', ' C 292  ALA  HB3', -0.507, (203.102, 152.677, 165.374)), (' A 199  GLY  HA2', ' A 232  GLY  HA2', -0.506, (168.835, 208.056, 139.198)), (' C 130  VAL HG21', ' C 231  ILE HG21', -0.506, (213.086, 161.4, 135.826)), (' A  91  TYR  OH ', ' A 191  GLU  OE2', -0.504, (167.356, 222.72, 159.927)), (' B 273  ARG HH21', ' B 292  ALA  HB3', -0.504, (141.065, 160.969, 165.458)), (' B 599  THR  HB ', ' B 608  VAL HG12', -0.502, (141.944, 162.047, 181.877)), (' C 146  HIS  CE1', ' C 148  ASN HD22', -0.5, (253.646, 152.1, 139.3)), (' A 855  PHE  CE2', ' B 589  PRO  HD2', -0.499, (147.583, 188.384, 167.807)), (' C 190  ARG  HG2', ' C 207  HIS  HD2', -0.499, (227.73, 161.362, 154.601)), (' A 452  LEU HD11', ' A 492  LEU  HB3', -0.498, (193.138, 154.865, 117.858)), (' A 146  HIS  CE1', ' A 148  ASN HD22', -0.497, (154.003, 253.768, 138.97)), (' A 880  GLY  O  ', ' A 884  SER  OG ', -0.497, (153.799, 179.522, 218.772)), (' A 418  ILE HD13', ' A 421  TYR  HD2', -0.497, (185.509, 156.17, 130.175)), (' A 589  PRO  HD2', ' C 855  PHE  CE2', -0.493, (200.314, 190.384, 167.643)), (' B  99  ASN  OD1', ' B1301  BLA HMB2', -0.493, (131.393, 131.784, 150.128)), (' B 131  CYS  HB2', ' B 133  PHE  CZ ', -0.492, (137.478, 142.06, 131.062)), (' A 707  TYR  HB3', ' C 792  PRO  HG3', -0.492, (197.102, 193.16, 222.928)), (' B 146  HIS  CE1', ' B 148  ASN HD22', -0.492, (115.502, 116.967, 139.382)), (' B  22  THR  O  ', ' B  78  ARG  NH1', -0.491, (114.248, 147.466, 148.349)), (' C 316  SER  OG ', ' C 317  ASN  N  ', -0.491, (191.044, 152.61, 170.692)), (' A 131  CYS  HB2', ' A 133  PHE  CZ ', -0.491, (164.628, 222.654, 131.408)), (' A 316  SER  OG ', ' A 317  ASN  N  ', -0.49, (185.081, 199.879, 170.759)), (' A 563  GLN  O  ', ' A 577  ARG  NH2', -0.49, (214.51, 180.343, 155.616)), (' C  97  LYS  HE2', ' C 262  ALA  HB3', -0.49, (236.387, 148.683, 155.817)), (' A 437  ASN  HA ', ' A 508  TYR  CD1', -0.489, (187.072, 175.292, 118.964)), (' B 854  LYS  HA ', ' B 858  LEU  O  ', -0.489, (176.404, 150.911, 174.56)), (' B 320  VAL  HB ', ' B 590  CYS  HB3', -0.487, (140.97, 181.912, 165.784)), (' A 977  LEU HD11', ' A 993  ILE HG12', -0.487, (159.661, 178.966, 154.884)), (' A 452  LEU HD21', ' A 492  LEU HD13', -0.485, (195.492, 154.917, 118.763)), (' B 568  ASP  OD1', ' B 569  ILE HD12', -0.485, (156.224, 196.044, 168.965)), (' M   1  NAG  H61', ' M   2  NAG  HN2', -0.485, (122.357, 160.233, 157.192)), (' C 130  VAL  O  ', ' C 130  VAL HG13', -0.485, (215.664, 162.353, 133.224)), (' C  28  TYR  CE1', ' X   1  NAG  H5 ', -0.484, (214.655, 138.455, 158.522)), (' A 437  ASN  HA ', ' A 508  TYR  HD1', -0.484, (187.373, 175.738, 118.877)), (' C 287  ASP  HB3', ' C 306  PHE  HE2', -0.483, (211.1, 163.768, 172.097)), (' B 436  TRP  NE1', ' B 509  ARG  HD3', -0.483, (162.745, 189.953, 119.18)), (' A 320  VAL  HB ', ' A 590  CYS  HB3', -0.482, (197.614, 199.675, 165.915)), (' C 563  GLN  O  ', ' C 577  ARG  NH2', -0.482, (159.557, 136.728, 155.668)), (' B 568  ASP  OD1', ' B 569  ILE  N  ', -0.482, (156.572, 195.273, 167.822)), (' C  81  ASN  O  ', ' C 239  GLN  NE2', -0.48, (223.09, 145.146, 141.855)), (' B 102  ARG  HG3', ' B 141  LEU HD12', -0.48, (128.779, 134.468, 142.694)), (' C 342  PHE  HD1', ' C 436  TRP  HH2', -0.48, (166.401, 153.381, 123.611)), (' B 342  PHE  CE2', ' B 368  LEU HD11', -0.479, (156.218, 191.592, 127.526)), (' B 146  HIS  CE1', ' B 148  ASN  HB2', -0.479, (116.763, 115.512, 140.021)), (' B 231  ILE HG22', ' B 233  ILE HG23', -0.477, (145.189, 150.006, 135.474)), (' B 361  CYS  HB3', ' B 524  VAL HG22', -0.476, (151.937, 199.418, 136.44)), (' A 146  HIS  CE1', ' A 148  ASN  HB2', -0.475, (152.81, 253.798, 139.506)), (' B 146  HIS  HE1', ' B 148  ASN  HB2', -0.475, (116.605, 115.315, 139.764)), (' B 574  ASP  N  ', ' B 574  ASP  OD1', -0.474, (151.708, 195.567, 162.948)), (' B 398  ASP  HB2', ' B 512  VAL  HB ', -0.474, (167.014, 194.357, 130.968)), (' C 922  LEU HD11', ' d   1  NAG  H5 ', -0.473, (201.708, 165.628, 228.312)), (' B 393  THR  HA ', ' B 523  THR HG22', -0.473, (154.942, 200.208, 141.438)), (' C 130  VAL HG12', ' C 168  PHE  HB3', -0.472, (216.177, 164.048, 134.428)), (' C 146  HIS  HE1', ' C 148  ASN  HB2', -0.471, (254.408, 153.889, 139.784)), (' A  99  ASN  ND2', ' A1301  BLA HMB2', -0.471, (158.915, 233.009, 150.264)), (' B 452  LEU HD21', ' B 492  LEU HD13', -0.471, (180.694, 202.356, 118.769)), (' A 538  CYS  HB3', ' A 551  VAL HG23', -0.471, (202.68, 196.928, 164.612)), (' C 403  ARG  HD2', ' C 505  TYR  HA ', -0.47, (164.396, 170.627, 116.202)), (' M   1  NAG  H61', ' M   2  NAG  N2 ', -0.47, (122.119, 159.912, 157.349)), (' A 442  ASP  OD1', ' A 451  TYR  OH ', -0.469, (195.37, 169.765, 114.133)), (' A 550  GLY  HA2', ' A 589  PRO  HA ', -0.468, (200.271, 194.35, 163.237)), (' C 231  ILE HG22', ' C 233  ILE HG23', -0.467, (210.241, 161.197, 135.466)), (' C 734  THR HG22', ' C 860  VAL HG22', -0.466, (191.562, 185.477, 180.948)), (' B 316  SER  OG ', ' B 317  ASN  N  ', -0.466, (147.392, 170.924, 170.763)), (' B 406  GLU  HA ', ' B 409  GLN  NE2', -0.466, (177.751, 185.311, 126.554)), (' A 146  HIS  HE1', ' A 148  ASN  HB2', -0.465, (152.593, 253.659, 139.499)), (' C 405  ASP  O  ', ' C 408  ARG  N  ', -0.464, (166.015, 170.151, 126.714)), (' C 146  HIS  CE1', ' C 148  ASN  HB2', -0.464, (254.017, 153.431, 139.558)), (' B 563  GLN  O  ', ' B 577  ARG  NH2', -0.463, (149.133, 206.052, 155.596)), (' A 361  CYS  SG ', ' A 362  VAL  N  ', -0.46, (207.243, 185.092, 134.774)), (' A 882  ILE HG13', ' A 883  THR HG23', -0.459, (151.391, 185.2, 219.718)), (' B1116  THR  HB ', ' B1140  PRO  HD3', -0.459, (165.264, 175.205, 250.645)), (' A 483  VAL HG13', ' A 485  GLY  H  ', -0.458, (189.398, 139.289, 116.503)), (' C 280  ASN  OD1', ' C 284  THR  N  ', -0.456, (215.029, 172.365, 167.533)), (' C 190  ARG  HG2', ' C 207  HIS  CD2', -0.455, (227.472, 161.333, 154.6)), (' C 728  PRO  O  ', ' C1021  SER  OG ', -0.454, (185.904, 177.005, 196.862)), (' B 882  ILE HG13', ' B 883  THR HG23', -0.454, (176.077, 148.789, 219.446)), (' C 146  HIS  HB2', ' C 153  MET  HE1', -0.453, (248.035, 154.83, 139.7)), (' B 404  GLY  HA2', ' B 508  TYR  HD1', -0.453, (171.798, 184.196, 121.301)), (' A  64  TRP  HE1', ' A 264  ALA  HB1', -0.453, (172.185, 233.664, 157.362)), (' A 393  THR  HA ', ' A 523  THR HG22', -0.453, (206.904, 178.585, 141.414)), (' A 363  ALA  O  ', ' A 527  PRO  HD3', -0.453, (202.749, 189.535, 135.564)), (' A  58  PHE  HB3', ' A  59  PHE  HD1', -0.452, (175.685, 217.938, 168.108)), (' B 363  ALA  O  ', ' B 527  PRO  HD3', -0.452, (147.273, 191.814, 135.346)), (' A  64  TRP  CD1', ' A 266  TYR  CE1', -0.452, (173.253, 231.186, 158.388)), (' B 483  VAL HG13', ' B 485  GLY  H  ', -0.451, (197.356, 205.352, 116.58)), (' X   1  NAG  H61', ' X   2  NAG  HN2', -0.451, (212.818, 135.752, 157.833)), (' A 538  CYS  HA ', ' A 550  GLY  O  ', -0.45, (202.944, 196.892, 161.587)), (' V   1  NAG  H61', ' V   2  NAG  N2 ', -0.449, (188.72, 226.887, 157.691)), (' C 102  ARG  HG3', ' C 141  LEU HD12', -0.449, (231.629, 154.802, 142.376)), (' A  81  ASN  O  ', ' A 239  GLN  NE2', -0.448, (175.471, 231.263, 141.798)), (' C1116  THR  HB ', ' C1140  PRO  HD3', -0.448, (178.487, 166.031, 250.237)), (' A 770  ILE HD11', ' A1012  LEU HD23', -0.448, (165.611, 174.32, 182.725)), (' C  58  PHE  HB3', ' C  59  PHE  HD1', -0.448, (211.582, 151.683, 168.238)), (' C 816  SER  OG ', ' C 819  GLU  HG3', -0.448, (200.62, 183.718, 205.982)), (' C 393  THR  HA ', ' C 523  THR HG22', -0.447, (161.836, 144.206, 141.358)), (' C 882  ILE HG13', ' C 883  THR HG23', -0.446, (195.453, 188.969, 219.777)), (' C 770  ILE  O  ', ' C 774  GLN  HG2', -0.445, (183.122, 185.922, 187.365)), (' C 599  THR  HB ', ' C 608  VAL HG12', -0.445, (201.4, 152.592, 182.047)), (' B 770  ILE HD11', ' B1012  LEU HD23', -0.444, (178.725, 166.375, 182.625)), (' C 483  VAL HG13', ' C 485  GLY  H  ', -0.444, (136.098, 178.911, 116.523)), (' C 367  VAL  O  ', ' C 371  SER  HB2', -0.443, (176.457, 148.543, 125.97)), (' B  97  LYS  HE2', ' B 262  ALA  HB3', -0.443, (120.873, 133.723, 155.646)), (' B 372  ALA  HB3', ' B 374  PHE  CE2', -0.443, (156.191, 186.18, 122.986)), (' C 363  ALA  O  ', ' C 527  PRO  HD3', -0.443, (173.084, 142.185, 135.133)), (' B 452  LEU HD11', ' B 492  LEU  HB3', -0.441, (181.854, 200.422, 118.369)), (' A1116  THR  HB ', ' A1140  PRO  HD3', -0.441, (179.699, 181.848, 250.603)), (' A  27  ALA  HB3', ' A  64  TRP  HE3', -0.441, (177.949, 233.907, 158.047)), (' A 716  THR  N  ', ' A1071  GLN  O  ', -0.441, (178.963, 197.586, 229.518)), (' B 410  ILE HG22', ' B 433  VAL HG11', -0.441, (169.832, 188.529, 131.474)), (' B 506  GLN  N  ', ' B 506  GLN  OE1', -0.44, (172.827, 182.853, 114.91)), (' C 770  ILE HD11', ' C1012  LEU HD23', -0.44, (178.781, 182.117, 182.726)), (' B 770  ILE  O  ', ' B 774  GLN  HG2', -0.439, (179.641, 160.923, 187.559)), (' A 770  ILE  O  ', ' A 774  GLN  HG2', -0.439, (160.155, 176.142, 187.562)), (' C 722  VAL HG22', ' C1065  VAL HG22', -0.439, (195.709, 173.906, 215.695)), (' C 804  GLN  NE2', ' e   1  NAG  H62', -0.436, (208.712, 180.413, 213.706)), (' A  34  ARG  NH1', ' A 219  GLY  O  ', -0.436, (165.99, 223.277, 166.27)), (' B  64  TRP  CD1', ' B 266  TYR  CE2', -0.435, (125.936, 145.195, 158.545)), (' C 506  GLN  N  ', ' C 506  GLN  OE1', -0.434, (167.837, 168.965, 114.898)), (' A 722  VAL HG22', ' A1065  VAL HG22', -0.434, (164.004, 192.738, 215.766)), (' C 977  LEU HD11', ' C 993  ILE HG12', -0.432, (185.637, 184.73, 155.102)), (' B 146  HIS  HB2', ' B 153  MET  HE1', -0.431, (120.632, 120.275, 139.639)), (' C 405  ASP  OD1', ' C 406  GLU  N  ', -0.431, (163.684, 171.401, 124.103)), (' C 361  CYS  SG ', ' C 362  VAL  N  ', -0.43, (166.856, 140.873, 134.778)), (' C 825  LYS  HB2', ' C 945  LEU HD12', -0.429, (201.39, 175.306, 197.52)), (' B 983  ARG  NH2', ' C 381  GLY  O  ', -0.429, (169.646, 157.615, 144.802)), (' B 130  VAL HG12', ' B 168  PHE  HB3', -0.429, (144.224, 143.282, 134.628)), (' X   1  NAG  H61', ' X   2  NAG  N2 ', -0.429, (213.191, 136.183, 157.767)), (' A 401  VAL HG12', ' A 509  ARG  HG2', -0.428, (193.226, 171.94, 119.227)), (' C 569  ILE  H  ', ' C 569  ILE HD12', -0.428, (164.628, 148.531, 169.168)), (' A1102  TRP  HB2', ' A1135  ASN  ND2', -0.427, (188.666, 189.445, 245.618)), (' C 199  GLY  HA2', ' C 232  GLY  HA2', -0.427, (206.541, 162.508, 139.177)), (' C 383  SER  HB3', ' C 386  LYS  HB2', -0.427, (177.198, 154.216, 141.627)), (' C 226  LEU  HG ', ' C 227  VAL HG13', -0.427, (219.88, 167.922, 147.637)), (' B 716  THR  N  ', ' B1071  GLN  O  ', -0.426, (151.994, 166.741, 229.541)), (' B 550  GLY  HA2', ' B 589  PRO  HA ', -0.426, (144.608, 186.977, 163.652)), (' B 819  GLU  OE1', ' B1055  SER  OG ', -0.426, (172.415, 148.997, 202.299)), (' A 759  PHE  CD2', ' A1001  LEU HD21', -0.425, (166.626, 170.657, 166.169)), (' A 538  CYS  HB3', ' A 551  VAL  CG2', -0.425, (202.568, 197.412, 164.393)), (' A 506  GLN  N  ', ' A 506  GLN  OE1', -0.425, (182.534, 171.47, 114.917)), (' B 728  PRO  O  ', ' B1021  SER  OG ', -0.425, (171.048, 163.181, 197.001)), (' C 442  ASP  OD1', ' C 451  TYR  OH ', -0.425, (159.979, 158.546, 114.195)), (' A 900  MET  HB3', ' A 900  MET  HE2', -0.425, (158.194, 182.298, 230.656)), (' A 894  LEU  HB3', ' B 713  ALA  HB3', -0.425, (151.451, 174.725, 226.654)), (' A 715  PRO  HA ', ' A1072  GLU  HA ', -0.424, (181.018, 197.27, 228.589)), (' A 503  VAL  HA ', ' A 506  GLN HE22', -0.423, (179.866, 173.806, 113.93)), (' A 404  GLY  HA2', ' A 508  TYR  CD2', -0.423, (183.903, 172.13, 120.989)), (' C 721  SER  OG ', ' C1066  THR  OG1', -0.423, (192.799, 167.968, 216.126)), (' B 715  PRO  HA ', ' B1072  GLU  HA ', -0.422, (151.699, 168.56, 228.625)), (' A 569  ILE  H  ', ' A 569  ILE HD12', -0.422, (201.479, 178.885, 168.724)), (' B  98  SER  HB3', ' B 181  GLY  HA2', -0.421, (123.523, 128.625, 151.365)), (' A 142  GLY  HA3', ' A 156  GLU  HB2', -0.42, (163.899, 240.118, 137.498)), (' B 440  ASN  OD1', ' B 441  LEU  HG ', -0.418, (161.586, 189.336, 111.57)), (' B 418  ILE HD13', ' B 421  TYR  HD2', -0.417, (184.83, 193.019, 130.271)), (' A 410  ILE HG22', ' A 433  VAL HG21', -0.416, (188.776, 171.836, 131.9)), (' A 130  VAL HG12', ' A 168  PHE  HB3', -0.416, (162.544, 215.947, 134.524)), (' B 361  CYS  SG ', ' B 362  VAL  N  ', -0.415, (148.739, 197.715, 134.948)), (' A 336  CYS  HB3', ' A 361  CYS  HB2', -0.415, (208.262, 181.808, 133.555)), (' A 391  CYS  HA ', ' A 525  CYS  CB ', -0.415, (202.759, 185.039, 142.172)), (' A 146  HIS  HB2', ' A 153  MET  HE1', -0.414, (154.549, 247.969, 139.556)), (' B1076  THR  OG1', ' B1097  SER  OG ', -0.414, (148.37, 178.716, 239.58)), (' A 139  PRO  HA ', ' A 158  ARG  O  ', -0.414, (169.282, 233.928, 135.713)), (' B 324  GLU  O  ', ' B 539  VAL  HB ', -0.414, (139.052, 184.911, 155.815)), (' B 145  TYR  HB3', ' B 247  SER  HB3', -0.414, (116.61, 125.296, 143.719)), (' A 125  ASN  ND2', ' A 172  SER  O  ', -0.413, (150.699, 225.282, 138.957)), (' A 816  SER  OG ', ' A 819  GLU  HG3', -0.412, (153.062, 192.579, 206.467)), (' C 979  ASP  O  ', ' C 983  ARG  HG2', -0.412, (192.734, 183.146, 148.78)), (' A 353  TRP  HE1', ' A 466  ARG  HA ', -0.412, (197.249, 160.305, 130.488)), (' A 190  ARG  HG2', ' A 207  HIS  CD2', -0.411, (159.248, 226.764, 154.859)), (' C 452  LEU HD12', ' C 493  GLN  O  ', -0.41, (150.88, 168.078, 117.406)), (' C1101  HIS  CD2', ' f   1  NAG  H5 ', -0.41, (189.465, 153.519, 247.632)), (' A 437  ASN  N  ', ' A 437  ASN  OD1', -0.41, (188.188, 178.714, 118.736)), (' B 199  GLY  HA2', ' B 232  GLY  HA2', -0.409, (147.991, 152.557, 139.157)), (' C  34  ARG  NH1', ' C 219  GLY  O  ', -0.409, (220.697, 157.475, 166.414)), (' C 880  GLY  O  ', ' C 884  SER  OG ', -0.409, (189.491, 189.981, 218.757)), (' A 130  VAL HG11', ' A 231  ILE  CD1', -0.409, (164.471, 214.219, 135.166)), (' B 816  SER  OG ', ' B 819  GLU  HG3', -0.408, (169.54, 146.967, 206.028)), (' A  98  SER  HB3', ' A 181  GLY  HA2', -0.408, (160.133, 241.254, 151.277)), (' B 140  PHE  CZ ', ' B 158  ARG  HD2', -0.408, (121.146, 136.985, 135.436)), (' C 490  PHE  CE2', ' C 492  LEU  HB2', -0.408, (145.464, 168.71, 118.706)), (' C 916  LEU HD12', ' C 923  ILE HD12', -0.407, (195.502, 173.806, 228.619)), (' A 903  ALA  HB2', ' A 916  LEU HD23', -0.407, (162.826, 187.326, 230.66)), (' B 273  ARG  NH2', ' B 292  ALA  HB3', -0.407, (140.808, 160.647, 165.343)), (' B 786  LYS  HG3', ' B 787  GLN  HG2', -0.407, (189.552, 153.192, 212.368)), (' B 404  GLY  O  ', ' B 407  VAL  HB ', -0.406, (172.531, 183.492, 124.434)), (' A 915  VAL  O  ', ' A 919  ASN  ND2', -0.406, (167.016, 193.869, 232.76)), (' A 490  PHE  CE2', ' A 492  LEU  HB2', -0.406, (193.971, 151.802, 118.496)), (' B 662  CYS  HB2', ' B 697  MET  SD ', -0.406, (146.23, 172.719, 197.034)), (' A 452  LEU HD12', ' A 493  GLN  O  ', -0.406, (191.255, 157.285, 117.397)), (' A 273  ARG  NH2', ' A 292  ALA  HB3', -0.405, (179.221, 210.237, 165.168)), (' A 728  PRO  O  ', ' A1021  SER  OG ', -0.405, (166.395, 182.987, 196.956)), (' B1102  TRP  HB2', ' B1135  ASN  ND2', -0.404, (154.375, 179.438, 245.937)), (' B1116  THR HG22', ' B1138  TYR  HB3', -0.404, (162.556, 174.559, 250.37)), (' B 139  PRO  HA ', ' B 158  ARG  O  ', -0.404, (125.38, 140.21, 135.655)), (' C 342  PHE  HD1', ' C 436  TRP  CH2', -0.403, (166.902, 153.341, 123.609)), (' A 172  SER  OG ', ' A 173  GLN  N  ', -0.403, (150.002, 223.06, 141.777)), (' A  61  ASN  HB3', ' V   1  NAG  N2 ', -0.403, (183.324, 224.605, 162.354)), (' C 819  GLU  OE1', ' C1055  SER  OG ', -0.402, (197.428, 185.221, 202.451)), (' C 984  LEU  HA ', ' C 984  LEU HD23', -0.402, (188.079, 183.691, 144.068)), (' C 903  ALA  HB2', ' C 916  LEU HD23', -0.402, (191.848, 178.034, 230.68)), (' A 979  ASP  O  ', ' A 983  ARG  HG2', -0.402, (157.629, 185.756, 149.129)), (' B 984  LEU  HA ', ' B 984  LEU HD23', -0.401, (174.86, 157.999, 144.146)), (' B1101  HIS  CD2', ' U   1  NAG  H5 ', -0.401, (148.866, 171.807, 247.549)), (' A 342  PHE  HD1', ' A 436  TRP  CH2', -0.401, (196.523, 178.598, 123.857)), (' B 404  GLY  HA2', ' B 508  TYR  CD1', -0.401, (171.333, 183.941, 121.103)), (' B 736  VAL HG12', ' B 858  LEU HD22', -0.401, (176.673, 157.176, 174.356)), (' A 555  SER  HB2', ' A 584  ILE HD12', -0.401, (214.466, 186.561, 163.029)), (' A 633  TRP  HB3', ' A 634  ARG  H  ', -0.401, (199.941, 205.377, 173.791)), (' C 320  VAL  HB ', ' C 590  CYS  HB3', -0.401, (184.553, 141.622, 165.784)), (' C 377  PHE  CD2', ' C 434  ILE HG12', -0.401, (171.76, 156.366, 129.468)), (' A  81  ASN  N  ', ' A  81  ASN  OD1', -0.401, (175.091, 234.124, 144.578)), (' C  81  ASN  N  ', ' C  81  ASN  OD1', -0.4, (225.853, 143.888, 144.591)), (' C 900  MET  HB3', ' C 900  MET  HE2', -0.4, (189.477, 185.274, 230.248)), (' B 490  PHE  CE2', ' B 492  LEU  HB2', -0.4, (184.09, 202.031, 118.187)), (' B 894  LEU  HB3', ' C 713  ALA  HB3', -0.4, (185.254, 154.664, 226.44)), (' B 555  SER  HB2', ' B 584  ILE HD12', -0.4, (144.076, 202.909, 162.379)), (' C 324  GLU  O  ', ' C 539  VAL  HB ', -0.4, (182.962, 138.431, 155.938)), (' B 806  LEU  HA ', ' B 806  LEU HD23', -0.4, (172.509, 146.069, 212.302)), (' B 142  GLY  HA3', ' B 156  GLU  HB2', -0.4, (122.346, 132.247, 137.506))]
handle_read_draw_probe_dots_unformatted("molprobity_probe.txt", 0, 0)
show_probe_dots(True, True)
gui = coot_molprobity_todo_list_gui(data=data)
