# script auto-generated by phenix.molprobity


from __future__ import absolute_import, division, print_function
from six.moves import cPickle as pickle
from six.moves import range
try :
  import gobject
except ImportError :
  gobject = None
import sys

class coot_extension_gui(object):
  def __init__(self, title):
    import gtk
    self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)
    scrolled_win = gtk.ScrolledWindow()
    self.outside_vbox = gtk.VBox(False, 2)
    self.inside_vbox = gtk.VBox(False, 0)
    self.window.set_title(title)
    self.inside_vbox.set_border_width(0)
    self.window.add(self.outside_vbox)
    self.outside_vbox.pack_start(scrolled_win, True, True, 0)
    scrolled_win.add_with_viewport(self.inside_vbox)
    scrolled_win.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)

  def finish_window(self):
    import gtk
    self.outside_vbox.set_border_width(2)
    ok_button = gtk.Button("  Close  ")
    self.outside_vbox.pack_end(ok_button, False, False, 0)
    ok_button.connect("clicked", lambda b: self.destroy_window())
    self.window.connect("delete_event", lambda a, b: self.destroy_window())
    self.window.show_all()

  def destroy_window(self, *args):
    self.window.destroy()
    self.window = None

  def confirm_data(self, data):
    for data_key in self.data_keys :
      outlier_list = data.get(data_key)
      if outlier_list is not None and len(outlier_list) > 0 :
        return True
    return False

  def create_property_lists(self, data):
    import gtk
    for data_key in self.data_keys :
      outlier_list = data[data_key]
      if outlier_list is None or len(outlier_list) == 0 :
        continue
      else :
        frame = gtk.Frame(self.data_titles[data_key])
        vbox = gtk.VBox(False, 2)
        frame.set_border_width(6)
        frame.add(vbox)
        self.add_top_widgets(data_key, vbox)
        self.inside_vbox.pack_start(frame, False, False, 5)
        list_obj = residue_properties_list(
          columns=self.data_names[data_key],
          column_types=self.data_types[data_key],
          rows=outlier_list,
          box=vbox)

# Molprobity result viewer
class coot_molprobity_todo_list_gui(coot_extension_gui):
  data_keys = [ "rama", "rota", "cbeta", "probe" ]
  data_titles = { "rama"  : "Ramachandran outliers",
                  "rota"  : "Rotamer outliers",
                  "cbeta" : "C-beta outliers",
                  "probe" : "Severe clashes" }
  data_names = { "rama"  : ["Chain", "Residue", "Name", "Score"],
                 "rota"  : ["Chain", "Residue", "Name", "Score"],
                 "cbeta" : ["Chain", "Residue", "Name", "Conf.", "Deviation"],
                 "probe" : ["Atom 1", "Atom 2", "Overlap"] }
  if (gobject is not None):
    data_types = { "rama" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "rota" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "cbeta" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT],
                   "probe" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT] }
  else :
    data_types = dict([ (s, []) for s in ["rama","rota","cbeta","probe"] ])

  def __init__(self, data_file=None, data=None):
    assert ([data, data_file].count(None) == 1)
    if (data is None):
      data = load_pkl(data_file)
    if not self.confirm_data(data):
      return
    coot_extension_gui.__init__(self, "MolProbity to-do list")
    self.dots_btn = None
    self.dots2_btn = None
    self._overlaps_only = True
    self.window.set_default_size(420, 600)
    self.create_property_lists(data)
    self.finish_window()

  def add_top_widgets(self, data_key, box):
    import gtk
    if data_key == "probe" :
      hbox = gtk.HBox(False, 2)
      self.dots_btn = gtk.CheckButton("Show Probe dots")
      hbox.pack_start(self.dots_btn, False, False, 5)
      self.dots_btn.connect("toggled", self.toggle_probe_dots)
      self.dots2_btn = gtk.CheckButton("Overlaps only")
      hbox.pack_start(self.dots2_btn, False, False, 5)
      self.dots2_btn.connect("toggled", self.toggle_all_probe_dots)
      self.dots2_btn.set_active(True)
      self.toggle_probe_dots()
      box.pack_start(hbox, False, False, 0)

  def toggle_probe_dots(self, *args):
    if self.dots_btn is not None :
      show_dots = self.dots_btn.get_active()
      overlaps_only = self.dots2_btn.get_active()
      if show_dots :
        self.dots2_btn.set_sensitive(True)
      else :
        self.dots2_btn.set_sensitive(False)
      show_probe_dots(show_dots, overlaps_only)

  def toggle_all_probe_dots(self, *args):
    if self.dots2_btn is not None :
      self._overlaps_only = self.dots2_btn.get_active()
      self.toggle_probe_dots()

class rsc_todo_list_gui(coot_extension_gui):
  data_keys = ["by_res", "by_atom"]
  data_titles = ["Real-space correlation by residue",
                 "Real-space correlation by atom"]
  data_names = {}
  data_types = {}

class residue_properties_list(object):
  def __init__(self, columns, column_types, rows, box,
      default_size=(380,200)):
    assert len(columns) == (len(column_types) - 1)
    if (len(rows) > 0) and (len(rows[0]) != len(column_types)):
      raise RuntimeError("Wrong number of rows:\n%s" % str(rows[0]))
    import gtk
    self.liststore = gtk.ListStore(*column_types)
    self.listmodel = gtk.TreeModelSort(self.liststore)
    self.listctrl = gtk.TreeView(self.listmodel)
    self.listctrl.column = [None]*len(columns)
    self.listctrl.cell = [None]*len(columns)
    for i, column_label in enumerate(columns):
      cell = gtk.CellRendererText()
      column = gtk.TreeViewColumn(column_label)
      self.listctrl.append_column(column)
      column.set_sort_column_id(i)
      column.pack_start(cell, True)
      column.set_attributes(cell, text=i)
    self.listctrl.get_selection().set_mode(gtk.SELECTION_SINGLE)
    for row in rows :
      self.listmodel.get_model().append(row)
    self.listctrl.connect("cursor-changed", self.OnChange)
    sw = gtk.ScrolledWindow()
    w, h = default_size
    if len(rows) > 10 :
      sw.set_size_request(w, h)
    else :
      sw.set_size_request(w, 30 + (20 * len(rows)))
    sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
    box.pack_start(sw, False, False, 5)
    inside_vbox = gtk.VBox(False, 0)
    sw.add(self.listctrl)

  def OnChange(self, treeview):
    import coot # import dependency
    selection = self.listctrl.get_selection()
    (model, tree_iter) = selection.get_selected()
    if tree_iter is not None :
      row = model[tree_iter]
      xyz = row[-1]
      if isinstance(xyz, tuple) and len(xyz) == 3 :
        set_rotation_centre(*xyz)
        set_zoom(30)
        graphics_draw()

def show_probe_dots(show_dots, overlaps_only):
  import coot # import dependency
  n_objects = number_of_generic_objects()
  sys.stdout.flush()
  if show_dots :
    for object_number in range(n_objects):
      obj_name = generic_object_name(object_number)
      if overlaps_only and not obj_name in ["small overlap", "bad overlap"] :
        sys.stdout.flush()
        set_display_generic_object(object_number, 0)
      else :
        set_display_generic_object(object_number, 1)
  else :
    sys.stdout.flush()
    for object_number in range(n_objects):
      set_display_generic_object(object_number, 0)

def load_pkl(file_name):
  pkl = open(file_name, "rb")
  data = pickle.load(pkl)
  pkl.close()
  return data

data = {}
data['rama'] = [('A', ' 332 ', 'ILE', 0.036528795394258955, (210.3550100000001, 252.75601, 245.65101000000007)), ('B', ' 484 ', 'LYS', 0.00047097, (220.35501, 170.64901000000006, 267.99901)), ('C', ' 324 ', 'GLU', 0.025487464179277455, (229.8310100000002, 176.05101, 232.18101000000004)), ('C', ' 620 ', 'VAL', 0.0194906, (225.62901, 174.00101, 213.03401000000002))]
data['omega'] = []
data['rota'] = []
data['cbeta'] = []
data['probe'] = [(' C  65  PHE  O  ', ' C 264  ALA  HA ', -0.79, (194.557, 150.443, 228.576)), (' A 724  THR HG23', ' A 934  ILE HD11', -0.742, (235.089, 208.607, 178.887)), (' A 126  VAL HG13', ' A 174  PRO  HA ', -0.741, (264.762, 204.683, 242.434)), (' A  65  PHE  O  ', ' A 264  ALA  HA ', -0.74, (269.781, 224.691, 233.814)), (' A 555  SER  HB3', ' A 586  ASP  HB2', -0.728, (213.517, 250.522, 220.344)), (' A 405  ASP  O  ', ' A 408  ARG  NH1', -0.724, (214.142, 237.368, 282.846)), (' B  64  TRP  HE1', ' B 264  ALA  HB1', -0.72, (167.43, 252.941, 230.823)), (' A  25  PRO  HD2', ' A  66  HIS  HB2', -0.719, (271.92, 230.113, 234.503)), (' A 567  ARG  NH1', ' A 571  ASP  OD1', -0.717, (204.306, 236.626, 224.667)), (' A 989  ALA  O  ', ' A 993  ILE HG12', -0.703, (217.132, 198.073, 233.501)), (' B 725  GLU  OE2', ' B1064  HIS  NE2', -0.696, (206.753, 224.736, 178.632)), (' C 342  PHE  HE1', ' C 511  VAL HG11', -0.687, (232.179, 202.085, 258.389)), (' A  83  VAL HG11', ' A 237  ARG HH21', -0.685, (258.297, 228.411, 248.457)), (' C 377  PHE  HE2', ' C 384  PRO  HB3', -0.684, (223.051, 196.283, 251.987)), (' A 353  TRP  O  ', ' A 466  ARG  NH2', -0.676, (197.33, 245.283, 272.318)), (' B  65  PHE  O  ', ' B 264  ALA  HA ', -0.665, (167.328, 251.743, 233.246)), (' A 421  TYR  HA ', ' A 461  LEU HD23', -0.658, (197.652, 234.945, 281.23)), (' A  46  SER  HA ', ' A 279  TYR  O  ', -0.655, (247.397, 203.185, 214.914)), (' A 121  ASN HD21', ' A 176  LEU  H  ', -0.652, (266.853, 207.16, 239.798)), (' B 126  VAL HG13', ' B 174  PRO  HA ', -0.651, (186.621, 258.979, 241.419)), (' B  46  SER  HA ', ' B 279  TYR  O  ', -0.648, (197.886, 245.73, 213.494)), (' B 741  TYR  HD2', ' B 742  ILE HG23', -0.643, (216.53, 223.093, 220.228)), (' A 125  ASN  OD1', ' A2002  NAG  O3 ', -0.642, (268.546, 202.267, 248.795)), (' C 102  ARG  HG3', ' C 243  ALA  HB2', -0.642, (183.971, 152.299, 239.055)), (' C 485  GLY  H  ', ' C 488  CYS  HB2', -0.642, (231.314, 239.358, 268.919)), (' B 328  ARG  NH2', ' B 580  GLN  OE1', -0.642, (169.686, 194.42, 235.56)), (' C  25  PRO  HD2', ' C  66  HIS  HB2', -0.641, (198.136, 146.075, 229.066)), (' A 726  ILE HG12', ' A1061  VAL HG22', -0.64, (231.276, 206.708, 185.285)), (' C 299  THR HG21', ' C 597  VAL HG21', -0.636, (209.509, 179.068, 205.629)), (' A 739  THR  O  ', ' A 743  CYS  HB2', -0.633, (218.283, 192.554, 222.516)), (' C 523  THR HG23', ' C 524  VAL HG23', -0.632, (241.267, 196.775, 246.762)), (' B 403  ARG  NH2', ' B 505  TYR  O  ', -0.632, (206.798, 194.487, 270.15)), (' B 726  ILE HG12', ' B1061  VAL HG22', -0.625, (206.614, 230.849, 185.751)), (' A 518  LEU HD23', ' A 520  ALA  H  ', -0.616, (195.17, 235.433, 252.079)), (' B 115  GLN  NE2', ' B 132  GLU  OE2', -0.615, (186.411, 241.839, 256.246)), (' A 786  LYS  HG3', ' A 787  GLN  HG3', -0.615, (217.884, 186.541, 173.013)), (' A  64  TRP  HE1', ' A 264  ALA  HB1', -0.606, (270.727, 224.03, 231.568)), (' B 382  VAL HG12', ' C 983  ARG  HG2', -0.599, (192.172, 199.733, 241.133)), (' A1125  ASN  ND2', ' A1127  ASP  OD2', -0.597, (205.233, 238.388, 140.896)), (' A 790  LYS  NZ ', ' C 702  GLU  OE1', -0.594, (227.991, 181.548, 174.887)), (' C 756  TYR  OH ', ' C 994  ASP  OD1', -0.594, (203.039, 213.669, 228.871)), (' C1053  PRO  O  ', ' C1054  GLN  NE2', -0.592, (190.79, 201.653, 177.393)), (' B1087  ALA  HB2', ' B1126  CYS  HB3', -0.59, (196.838, 200.238, 141.491)), (' C 809  PRO  O  ', ' C 814  LYS  NZ ', -0.588, (174.22, 201.16, 178.46)), (' T   2  NAG  H3 ', ' T   2  NAG  H83', -0.586, (178.217, 200.259, 151.633)), (' C 403  ARG  NH1', ' C 405  ASP  OD2', -0.586, (217.195, 216.077, 266.479)), (' B 712  ILE HD11', ' B1096  VAL HG12', -0.585, (192.043, 215.357, 151.268)), (' A 328  ARG  NH2', ' A 580  GLN  OE1', -0.577, (216.351, 253.698, 237.155)), (' B 374  PHE  HA ', ' B 436  TRP  HB3', -0.559, (193.765, 200.007, 262.263)), (' A 394  ASN  OD1', ' A 516  GLU  HB3', -0.558, (199.73, 237.715, 258.482)), (' A 986  PRO  HA ', ' A 989  ALA  HB3', -0.557, (216.705, 194.888, 238.12)), (' e   2  NAG  H3 ', ' e   2  NAG  H83', -0.557, (242.43, 174.313, 207.982)), (' A 773  GLU  OE2', ' A1019  ARG  NH1', -0.557, (212.426, 202.08, 195.139)), (' B 353  TRP  O  ', ' B 466  ARG  NH2', -0.556, (197.811, 181.326, 256.304)), (' A 770  ILE  O  ', ' A 774  GLN  HG2', -0.555, (217.55, 197.633, 198.049)), (' B 112  SER  N  ', ' B 134  GLN  OE1', -0.555, (177.297, 243.314, 258.544)), (' A 349  SER  OG ', ' A 452  LEU  O  ', -0.553, (201.186, 246.576, 282.803)), (' A  99  ASN  O  ', ' A 102  ARG  NH2', -0.551, (272.98, 211.119, 239.652)), (' A 457  ARG  NH1', ' A 467  ASP  OD2', -0.551, (192.113, 236.823, 281.003)), (' C 426  PRO  HG2', ' C 429  PHE  HB2', -0.551, (228.43, 210.66, 246.466)), (' B 722  VAL HG22', ' B1065  VAL HG22', -0.549, (205.346, 232.675, 171.715)), (' B 170  TYR  HE1', ' B 172  SER  HB2', -0.549, (192.407, 255.653, 243.507)), (' A 412  PRO  HB3', ' A 427  ASP  HA ', -0.546, (206.972, 228.031, 270.604)), (' C 427  ASP  OD1', ' C 428  ASP  N  ', -0.546, (225.931, 213.317, 241.869)), (' C 342  PHE  CE2', ' C 368  LEU HD11', -0.545, (230.788, 197.519, 258.702)), (' A 809  PRO  O  ', ' A 814  LYS  NZ ', -0.543, (239.808, 184.053, 179.583)), (' B  18  PHE  HE1', ' B  21  ARG  HA ', -0.542, (159.959, 250.168, 247.542)), (' B 729  VAL HG22', ' B1059  GLY  HA2', -0.541, (213.618, 228.19, 190.218)), (' A 985  ASP  OD1', ' A 986  PRO  HD2', -0.539, (216.605, 193.078, 242.31)), (' C  18  PHE  HE2', ' C  21  ARG  HA ', -0.538, (198.524, 143.453, 242.334)), (' B 444  LYS  HG3', ' B 448  ASN HD22', -0.538, (198.996, 187.055, 275.808)), (' C 342  PHE  HE2', ' C 368  LEU HD11', -0.537, (231.134, 197.178, 258.437)), (' B 362  VAL  HA ', ' B 525  CYS  O  ', -0.536, (179.218, 193.528, 247.184)), (' A 611  LEU HD12', ' A 650  LEU HD12', -0.534, (235.363, 234.393, 203.525)), (' A 411  ALA  HB3', ' A 414  GLN  HG3', -0.533, (210.81, 232.473, 275.446)), (' B 437  ASN  HA ', ' B 508  TYR  CD1', -0.532, (198.721, 198.101, 266.871)), (' A1086  LYS  HD2', ' A1122  VAL HG11', -0.531, (208.378, 228.033, 139.214)), (' C 316  SER  OG ', ' C 317  ASN  N  ', -0.529, (215.748, 183.628, 214.902)), (' A 905  ARG  NH1', ' A1049  LEU  O  ', -0.527, (224.854, 205.304, 167.396)), (' B 763  LEU HD22', ' B1008  VAL HG21', -0.526, (217.759, 217.782, 212.181)), (' B 931  ILE  O  ', ' B 934  ILE HG22', -0.525, (203.042, 239.429, 175.827)), (' C  31  SER  HB3', ' C  60  SER  H  ', -0.525, (201.485, 163.714, 220.051)), (' A 299  THR  OG1', ' A 597  VAL HG21', -0.524, (239.852, 223.87, 209.514)), (' C 568  ASP  OD1', ' C 572  THR  OG1', -0.521, (236.313, 196.814, 220.078)), (' C 133  PHE  HB2', ' C 135  PHE  CE1', -0.517, (192.051, 159.916, 251.066)), (' A1087  ALA  HB2', ' A1126  CYS  HB3', -0.516, (210.285, 233.985, 143.731)), (' C 722  VAL HG22', ' C1065  VAL HG22', -0.514, (198.212, 195.781, 169.632)), (' B 603  ASN  HB2', ' B2005  NAG  H2 ', -0.514, (185.321, 241.306, 197.477)), (' A 742  ILE HD11', ' A 753  LEU HD22', -0.514, (214.34, 195.76, 221.863)), (' C 742  ILE HD11', ' C 753  LEU HD22', -0.513, (196.791, 213.863, 221.866)), (' B 858  LEU HD22', ' B 959  LEU HD11', -0.511, (214.284, 229.588, 212.127)), (' B  52  GLN  HB2', ' B 274  THR HG22', -0.511, (190.36, 230.39, 223.647)), (' A 357  ARG  NH2', ' A 394  ASN HD22', -0.509, (196.505, 240.859, 257.122)), (' A 201  PHE  HB3', ' A 229  LEU  HB2', -0.508, (251.814, 209.713, 244.402)), (' A 393  THR  HA ', ' A 522  ALA  HA ', -0.507, (200.908, 239.399, 251.898)), (' B 603  ASN  OD1', ' B 604  THR  N  ', -0.507, (183.067, 238.211, 197.799)), (' A 103  GLY  H  ', ' A 241  LEU  HB2', -0.506, (267.23, 216.2, 244.48)), (' C 170  TYR  HE1', ' C 172  SER  HB2', -0.505, (180.218, 170.868, 240.436)), (' C 349  SER  OG ', ' C 452  LEU  O  ', -0.505, (231.75, 218.516, 265.729)), (' A 164  ASN  HB2', ' D   1  NAG  H83', -0.504, (256.359, 214.039, 265.643)), (' A 426  PRO  HG2', ' A 429  PHE  HB2', -0.503, (204.004, 231.383, 268.088)), (' C 770  ILE  O  ', ' C 774  GLN  HG2', -0.503, (196.823, 212.585, 198.431)), (' A 770  ILE HD11', ' A1012  LEU HD23', -0.502, (213.656, 201.91, 202.457)), (' C  46  SER  HA ', ' C 279  TYR  O  ', -0.502, (187.288, 182.452, 212.412)), (' C 210  ILE HG13', ' C 212  LEU  H  ', -0.502, (186.308, 155.665, 217.03)), (' A 568  ASP  OD1', ' A 572  THR  OG1', -0.502, (209.206, 238.633, 218.665)), (' A1089  PHE  HE2', ' B 917  TYR  HD2', -0.502, (210.812, 231.274, 151.286)), (' B 455  LEU HD22', ' B 493  GLN HE22', -0.501, (214.921, 184.112, 266.458)), (' A  18  PHE  HE2', ' A  21  ARG  HA ', -0.5, (273.63, 231.758, 247.806)), (' A 200  TYR  HE1', ' C 357  ARG HH22', -0.499, (243.219, 206.912, 245.634)), (' A 340  GLU  OE2', ' A 356  LYS  NZ ', -0.497, (200.864, 252.939, 262.943)), (' C 203  ILE  HB ', ' C 227  VAL HG12', -0.496, (186.727, 170.668, 235.975)), (' B 989  ALA  O  ', ' B 993  ILE HG12', -0.495, (215.702, 220.945, 235.077)), (' B 376  THR  HB ', ' B 435  ALA  HB3', -0.495, (198.865, 199.494, 259.469)), (' A 476  GLY  H  ', ' A 487  ASN  HB3', -0.495, (191.118, 233.2, 298.404)), (' B  25  PRO  HD2', ' B  66  HIS  HB2', -0.491, (161.979, 250.76, 234.295)), (' C 130  VAL  O  ', ' C 166  CYS  HB2', -0.49, (189.32, 168.385, 253.175)), (' B 707  TYR  HB3', ' C 792  PRO  HG3', -0.49, (182.915, 208.042, 162.773)), (' B 986  PRO  HA ', ' B 989  ALA  HB3', -0.49, (217.876, 221.0, 239.668)), (' f   1  NAG  O4 ', ' f   1  NAG  O7 ', -0.49, (237.962, 189.911, 151.627)), (' C 128  ILE  HB ', ' C 170  TYR  HB3', -0.488, (183.748, 169.164, 244.18)), (' C 498  GLN  HB2', ' C 501  TYR  CD1', -0.487, (219.927, 214.833, 277.526)), (' B 104  TRP  HB3', ' B 106  PHE  HE1', -0.487, (179.992, 248.012, 242.955)), (' C 212  LEU HD23', ' C 213  VAL  N  ', -0.486, (189.932, 152.466, 216.284)), (' C 726  ILE HG13', ' C1061  VAL HG22', -0.485, (197.305, 197.304, 183.553)), (' B 417  THR  O  ', ' B 421  TYR  HB2', -0.485, (211.939, 186.564, 258.058)), (' B 658  ASN  ND2', ' B 660  TYR  OH ', -0.484, (171.87, 225.151, 185.141)), (' A 533  LEU  H  ', ' A 533  LEU HD23', -0.483, (220.757, 253.43, 233.341)), (' B 128  ILE  HB ', ' B 170  TYR  HB3', -0.483, (189.843, 252.531, 247.098)), (' C 276  LEU HD23', ' C 306  PHE  HE1', -0.483, (197.699, 179.621, 212.076)), (' C 383  SER  HB3', ' C 386  LYS  HG3', -0.481, (222.901, 193.724, 244.143)), (' C 786  LYS  HG3', ' C 787  GLN  HG3', -0.481, (187.237, 219.984, 173.402)), (' B1050  MET  HE2', ' B1052  PHE  CZ ', -0.481, (212.613, 232.611, 170.647)), (' T   1  NAG  H5 ', ' T   2  NAG  H82', -0.48, (180.793, 200.292, 152.277)), (' B 802  PHE  HD1', ' B 805  ILE HD11', -0.479, (212.172, 237.617, 172.611)), (' A 442  ASP  O  ', ' A 448  ASN  ND2', -0.479, (207.85, 256.221, 283.664)), (' B  97  LYS  HG3', ' B 187  LYS  N  ', -0.479, (173.564, 262.941, 229.489)), (' B 716  THR  OG1', ' B1071  GLN  O  ', -0.478, (191.082, 226.659, 156.916)), (' A 391  CYS  HB3', ' A 525  CYS  HB3', -0.478, (209.373, 240.456, 252.328)), (' C 299  THR  HA ', ' C 302  THR HG22', -0.478, (207.05, 181.989, 209.771)), (' A 642  VAL HG13', ' A 651  ILE HG22', -0.478, (239.207, 239.996, 208.784)), (' C 709  ASN  ND2', ' f   1  NAG  H62', -0.477, (236.9, 193.039, 154.753)), (' A 501  TYR  HD2', ' A 505  TYR  HB3', -0.477, (214.311, 248.152, 288.977)), (' A  46  SER  CA ', ' A 279  TYR  O  ', -0.475, (246.971, 202.724, 215.629)), (' B 377  PHE  HE2', ' B 384  PRO  HB3', -0.474, (191.478, 203.202, 251.222)), (' A 650  LEU HD21', ' A 653  ALA  HB3', -0.474, (240.04, 235.501, 202.587)), (' B 759  PHE  O  ', ' B 762  GLN  HG2', -0.472, (222.371, 214.646, 214.952)), (' A 661  GLU  O  ', ' A 695  TYR  OH ', -0.472, (238.749, 231.085, 191.143)), (' A 353  TRP  HZ3', ' A 355  ARG  HB2', -0.471, (197.733, 242.843, 269.929)), (' A 403  ARG  HB3', ' A 406  GLU  HG3', -0.471, (211.022, 242.168, 284.353)), (' A1050  MET  HE2', ' A1052  PHE  CZ ', -0.471, (230.48, 202.311, 169.64)), (' C 758  SER  O  ', ' C 762  GLN  NE2', -0.47, (202.577, 220.555, 215.358)), (' A 780  GLU  O  ', ' A 784  GLN  NE2', -0.469, (216.901, 197.237, 182.304)), (' B 402  ILE HG22', ' B 403  ARG  N  ', -0.469, (205.028, 193.257, 263.319)), (' A 950  ASP  OD1', ' A 951  VAL  N  ', -0.469, (228.888, 208.974, 197.425)), (' A 760  CYS  HA ', ' A 763  LEU  HB2', -0.468, (211.528, 197.213, 214.39)), (' A1135  ASN  OD1', ' A1136  THR  N  ', -0.468, (221.126, 232.864, 138.932)), (' C 403  ARG  HD2', ' C 505  TYR  HD1', -0.467, (218.886, 216.231, 269.504)), (' C 867  ASP  N  ', ' C 867  ASP  OD1', -0.467, (183.14, 205.362, 189.319)), (' B  99  ASN  HB2', ' B 102  ARG  NH2', -0.466, (178.423, 261.1, 238.749)), (' A  89  GLY  HA3', ' A 270  LEU HD12', -0.466, (251.042, 219.111, 235.361)), (' C 568  ASP  HB2', ' C 569  ILE HD12', -0.465, (238.894, 198.442, 217.094)), (' B 724  THR HG22', ' B 934  ILE HD11', -0.463, (203.741, 233.815, 179.29)), (' C 538  CYS  HB2', ' C 590  CYS  HB3', -0.463, (231.376, 180.108, 221.467)), (' C 401  VAL HG22', ' C 509  ARG  HG2', -0.463, (229.676, 207.636, 266.6)), (' A 551  VAL HG12', ' A 588  THR  O  ', -0.463, (221.128, 243.584, 220.995)), (' B1053  PRO  O  ', ' B1054  GLN  NE2', -0.462, (214.182, 235.193, 179.974)), (' B  89  GLY  HA3', ' B 270  LEU HD12', -0.462, (183.062, 239.026, 234.66)), (' A 203  ILE  HB ', ' A 227  VAL HG12', -0.462, (255.726, 208.379, 239.555)), (' C 164  ASN  HB2', ' a   1  NAG  O7 ', -0.462, (191.16, 164.965, 262.336)), (' C 568  ASP  N  ', ' C 568  ASP  OD1', -0.461, (238.463, 197.338, 220.342)), (' C 474  GLN  NE2', ' C 476  GLY  O  ', -0.46, (229.672, 242.7, 258.77)), (' B1090  PRO  HD3', ' B1095  PHE  HE2', -0.46, (198.431, 208.652, 146.913)), (' C 307  THR  HA ', ' C 602  THR HG21', -0.46, (199.642, 177.273, 202.756)), (' A 327  VAL  H  ', ' A 531  THR HG22', -0.458, (220.702, 246.713, 237.654)), (' C 811  LYS  HD2', ' C 812  PRO  HD2', -0.457, (176.296, 196.005, 183.568)), (' A 327  VAL HG12', ' A 542  ASN  HB3', -0.456, (217.875, 242.774, 237.405)), (' A1043  CYS  HB2', ' A1064  HIS  CE1', -0.456, (224.629, 209.155, 176.585)), (' B1050  MET  HE2', ' B1052  PHE  CE1', -0.455, (212.589, 232.763, 171.124)), (' A 108  THR  O  ', ' A 237  ARG  NH1', -0.455, (254.989, 227.0, 250.41)), (' A 357  ARG  HE ', ' A 394  ASN  HB2', -0.455, (198.436, 242.429, 257.94)), (' C 706  ALA  HB2', ' i   2  NAG  HN2', -0.455, (225.817, 183.199, 161.594)), (' B 663  ASP  N  ', ' B 663  ASP  OD1', -0.454, (183.281, 225.718, 190.889)), (' C 989  ALA  O  ', ' C 993  ILE HG12', -0.453, (197.05, 209.358, 233.863)), (' A 858  LEU HD12', ' A 959  LEU HD11', -0.453, (226.033, 198.115, 210.596)), (' B 437  ASN  HA ', ' B 508  TYR  HD1', -0.453, (198.801, 197.833, 267.343)), (' B 766  ALA  O  ', ' B 770  ILE HG23', -0.452, (220.663, 218.278, 204.726)), (' A 612  TYR  HB2', ' A 649  CYS  SG ', -0.452, (233.62, 237.449, 210.755)), (' B 102  ARG  NH1', ' B 121  ASN  O  ', -0.452, (179.966, 260.605, 242.491)), (' C 328  ARG  NH1', ' C 580  GLN  OE1', -0.452, (243.873, 181.023, 237.868)), (' B1039  ARG  H  ', ' B1039  ARG  HG2', -0.45, (209.851, 216.166, 172.436)), (' B 453  TYR  O  ', ' B 492  LEU  HA ', -0.45, (209.967, 180.684, 264.85)), (' A 985  ASP  CG ', ' A 987  PRO  HD2', -0.45, (215.556, 194.72, 242.932)), (' A1129  VAL HG13', ' B 917  TYR  HB3', -0.45, (209.776, 234.395, 151.451)), (' A 168  PHE  CE2', ' A 170  TYR  HB2', -0.448, (255.375, 205.073, 249.046)), (' B 454  ARG  HD3', ' B 457  ARG  HG3', -0.448, (212.017, 179.24, 257.593)), (' A 570  ALA  HA ', ' B 964  LYS  HE2', -0.447, (204.502, 232.711, 218.591)), (' C 131  CYS  HB2', ' C 133  PHE  CZ ', -0.447, (189.233, 163.795, 251.718)), (' A 107  GLY  N  ', ' A 235  ILE HG23', -0.446, (254.326, 220.473, 247.518)), (' B  16  VAL HG22', ' B 158  ARG  NH2', -0.446, (166.2, 256.812, 256.671)), (' C  99  ASN  HB2', ' C 102  ARG  NH2', -0.445, (180.896, 155.73, 233.973)), (' B1134  ASN  HB2', ' Y   1  NAG  HN2', -0.445, (188.371, 203.307, 137.728)), (' C 880  GLY  O  ', ' C 884  SER  OG ', -0.445, (190.697, 211.613, 167.257)), (' A 418  ILE  HA ', ' A 422  ASN  HB2', -0.445, (202.596, 238.625, 281.355)), (' C 896  ILE HG13', ' C 897  PRO  HD2', -0.445, (191.691, 210.035, 156.811)), (' C 418  ILE  HA ', ' C 422  ASN  ND2', -0.444, (226.884, 220.426, 259.566)), (' B  96  GLU  O  ', ' B 187  LYS  N  ', -0.444, (174.972, 261.377, 229.915)), (' A 131  CYS  HB2', ' A 133  PHE  CE1', -0.443, (258.783, 213.687, 256.148)), (' A 529  LYS  HA ', ' A 529  LYS  HD2', -0.443, (217.756, 248.489, 245.757)), (' A 197  ILE  HB ', ' A 202  LYS  HZ1', -0.443, (244.871, 212.806, 238.987)), (' A 796  ASP  N  ', ' A 796  ASP  OD1', -0.443, (237.194, 192.21, 161.387)), (' B 988  GLU  O  ', ' B 992  GLN  HG2', -0.442, (212.94, 219.131, 237.944)), (' A 391  CYS  HB2', ' A 524  VAL  O  ', -0.442, (206.634, 241.221, 252.892)), (' A 640  SER  OG ', ' A 641  ASN  N  ', -0.442, (245.469, 240.708, 205.455)), (' A 988  GLU  N  ', ' A 988  GLU  OE1', -0.442, (215.606, 198.409, 241.381)), (' B 750  SER  O  ', ' B 754  LEU  HG ', -0.44, (226.732, 218.898, 227.948)), (' A 855  PHE  HB2', ' A 858  LEU HD23', -0.44, (228.035, 193.486, 213.264)), (' C  26  SER  O  ', ' C  26  SER  OG ', -0.44, (204.57, 150.958, 228.934)), (' B  31  SER  HB3', ' B  60  SER  H  ', -0.439, (175.024, 240.205, 222.914)), (' B 405  ASP  N  ', ' B 405  ASP  OD1', -0.439, (208.419, 197.11, 265.129)), (' T   1  NAG  O3 ', ' T   1  NAG  O6 ', -0.438, (184.514, 202.489, 152.06)), (' C  83  VAL HG22', ' C 239  GLN  HG3', -0.438, (198.518, 155.598, 241.941)), (' A 928  ASN  O  ', ' A 931  ILE HG22', -0.436, (241.571, 205.188, 171.064)), (' B 426  PRO  HG2', ' B 429  PHE  HB2', -0.436, (201.639, 191.945, 245.545)), (' C 290  ASP  O  ', ' C 297  SER  HB3', -0.436, (203.734, 175.093, 214.009)), (' C1045  LYS  H  ', ' C1066  THR HG21', -0.435, (206.483, 197.441, 171.462)), (' C 126  VAL HG13', ' C 174  PRO  HA ', -0.434, (178.891, 163.937, 238.019)), (' A1105  THR HG22', ' A1112  PRO  HA ', -0.434, (227.544, 223.774, 148.87)), (' A 353  TRP  CZ2', ' A 466  ARG  HB2', -0.434, (196.133, 241.112, 273.927)), (' B 538  CYS  HB2', ' B 590  CYS  HB3', -0.433, (175.14, 207.421, 219.883)), (' C 346  ARG  HA ', ' C 346  ARG  HD2', -0.433, (235.518, 207.207, 271.137)), (' A 877  LEU HD13', ' A1029  MET  HE2', -0.433, (223.454, 197.114, 178.407)), (' A 578  ASP  N  ', ' A 578  ASP  OD1', -0.432, (211.778, 252.808, 231.03)), (' B1082  CYS  SG ', ' B1132  ILE HD12', -0.432, (192.686, 200.85, 141.108)), (' C 437  ASN  HA ', ' C 508  TYR  CD1', -0.432, (222.144, 206.052, 267.828)), (' B 742  ILE HG22', ' B1000  ARG  HB3', -0.432, (215.048, 222.03, 222.089)), (' A 426  PRO  HD3', ' A 463  PRO  HB3', -0.432, (200.7, 232.192, 270.731)), (' B 578  ASP  N  ', ' B 578  ASP  OD1', -0.432, (172.866, 190.146, 229.809)), (' A 124  THR  OG1', ' A2002  NAG  O5 ', -0.431, (270.805, 203.202, 248.692)), (' C 766  ALA  O  ', ' C 770  ILE HG23', -0.43, (199.511, 214.738, 203.879)), (' A 358  ILE  HB ', ' A 395  VAL  HB ', -0.43, (203.195, 244.299, 259.623)), (' B 709  ASN  N  ', ' B 709  ASN  OD1', -0.429, (184.059, 206.488, 155.175)), (' C 865  LEU  HA ', ' C 865  LEU HD23', -0.429, (184.944, 212.718, 189.929)), (' C 229  LEU  HB3', ' C 231  ILE HG12', -0.429, (189.431, 173.969, 243.515)), (' B 979  ASP  OD2', ' B 983  ARG  NH2', -0.428, (208.535, 228.931, 237.805)), (' A 538  CYS  HB2', ' A 590  CYS  HB3', -0.427, (225.552, 242.175, 222.555)), (' C 144  TYR  H  ', ' C 154  GLU  HA ', -0.427, (176.424, 147.668, 244.389)), (' C 754  LEU  HA ', ' C 754  LEU HD12', -0.427, (196.469, 220.661, 223.718)), (' A 362  VAL HG23', ' A 525  CYS  O  ', -0.426, (209.41, 246.395, 250.886)), (' B 455  LEU  HB2', ' B 493  GLN HE22', -0.425, (213.821, 183.911, 265.802)), (' A1039  ARG  NE ', ' B1031  GLU  OE2', -0.425, (215.402, 214.003, 176.293)), (' B 821  LEU  O  ', ' B 825  LYS  HG2', -0.423, (205.069, 240.612, 189.2)), (' C 376  THR  HB ', ' C 435  ALA  HB3', -0.422, (221.471, 204.413, 260.214)), (' C 986  PRO  O  ', ' C 990  GLU  HG2', -0.421, (197.107, 212.448, 238.188)), (' B1089  PHE  HE2', ' C 917  TYR  HD2', -0.42, (198.853, 202.005, 148.809)), (' A 716  THR  OG1', ' A1071  GLN  O  ', -0.42, (235.933, 224.781, 158.495)), (' C 796  ASP  N  ', ' C 796  ASP  OD1', -0.42, (182.628, 201.416, 159.973)), (' A 816  SER  OG ', ' A 819  GLU  HG3', -0.419, (235.885, 196.516, 180.864)), (' C1073  LYS  HB3', ' C1073  LYS  HE2', -0.419, (217.854, 186.132, 152.419)), (' C  24  LEU HD13', ' C  65  PHE  HB3', -0.419, (196.835, 150.317, 231.861)), (' A1090  PRO  HD3', ' A1095  PHE  HE2', -0.418, (216.323, 227.973, 148.674)), (' A 896  ILE HD12', ' A 897  PRO  HD2', -0.418, (225.825, 195.243, 156.917)), (' B 578  ASP  OD2', ' B 581  THR  HB ', -0.418, (169.742, 190.965, 230.235)), (' C 391  CYS  SG ', ' C 522  ALA  HB1', -0.418, (238.929, 194.005, 242.116)), (' A 605  SER  OG ', ' A 606  ASN  N  ', -0.418, (250.491, 225.703, 203.651)), (' A 699  LEU  HB3', ' B 873  TYR  HE1', -0.418, (228.124, 233.176, 183.893)), (' A 290  ASP  O  ', ' A 297  SER  HB3', -0.418, (245.697, 221.52, 217.236)), (' A 541  PHE  CD2', ' A 552  LEU HD11', -0.418, (218.897, 244.257, 228.275)), (' A 581  THR  HA ', ' G   2  NAG  H82', -0.417, (212.193, 258.368, 234.619)), (' C1082  CYS  HB2', ' C1126  CYS  HB3', -0.417, (233.464, 203.132, 142.057)), (' C 646  ARG  HB3', ' C 646  ARG  HE ', -0.417, (230.079, 184.621, 199.182)), (' C 578  ASP  N  ', ' C 578  ASP  OD1', -0.417, (245.726, 187.109, 232.559)), (' C 134  GLN  N  ', ' C 162  SER  O  ', -0.416, (192.295, 158.859, 255.734)), (' B 329  PHE  HE2', ' B 528  LYS  HB2', -0.416, (177.229, 199.19, 241.782)), (' A 894  LEU  HB3', ' C 713  ALA  HB3', -0.416, (220.188, 190.871, 159.619)), (' A 118  LEU HD21', ' A 120  VAL HG13', -0.416, (264.513, 212.537, 249.73)), (' B  31  SER  HB3', ' B  60  SER  N  ', -0.416, (174.658, 240.511, 223.123)), (' B 567  ARG  HD3', ' B 571  ASP  HA ', -0.416, (190.012, 193.159, 223.446)), (' C 612  TYR  HB2', ' C 649  CYS  SG ', -0.415, (223.848, 177.259, 207.765)), (' A 752  LEU  O  ', ' A 755  GLN  HG2', -0.414, (208.283, 196.325, 228.093)), (' B 131  CYS  SG ', ' B 132  GLU  N  ', -0.414, (184.041, 246.264, 257.202)), (' A 865  LEU  HA ', ' A 865  LEU HD23', -0.413, (223.599, 187.638, 190.119)), (' C1043  CYS  HB2', ' C1064  HIS  CE1', -0.413, (203.275, 202.417, 175.846)), (' A  40  ASP  N  ', ' A  40  ASP  OD1', -0.413, (245.299, 205.652, 228.692)), (' B 984  LEU HD13', ' B 988  GLU  HG3', -0.412, (211.9, 220.593, 242.081)), (' B 731  MET  HB2', ' B 955  ASN HD21', -0.411, (212.057, 226.684, 200.624)), (' A 106  PHE  HB3', ' A 235  ILE HD13', -0.411, (254.459, 217.913, 246.429)), (' B  46  SER  CA ', ' B 279  TYR  O  ', -0.411, (198.377, 245.445, 214.049)), (' C  46  SER  CA ', ' C 279  TYR  O  ', -0.411, (187.253, 182.948, 212.971)), (' A1082  CYS  SG ', ' A1132  ILE HD12', -0.41, (212.884, 238.374, 143.517)), (' C 928  ASN  O  ', ' C 931  ILE HG22', -0.41, (191.936, 190.57, 168.785)), (' B 131  CYS  HB3', ' B 133  PHE  CZ ', -0.409, (183.58, 248.776, 254.956)), (' B 452  LEU  HA ', ' B 494  SER  HA ', -0.409, (206.669, 183.455, 268.837)), (' B 214  ARG  HD3', ' B 215  ASP  HB3', -0.409, (167.634, 251.153, 222.195)), (' B 190  SER  HB3', ' B 192  PHE  HE1', -0.408, (180.589, 254.548, 233.269)), (' C  30  ASN HD21', ' C  59  PHE  HD1', -0.408, (202.225, 162.149, 214.832)), (' B 316  SER  OG ', ' B 317  ASN  N  ', -0.408, (185.346, 219.875, 215.096)), (' A 350  VAL HG21', ' A 418  ILE HD12', -0.407, (204.051, 241.408, 281.334)), (' B 422  ASN HD21', ' B 454  ARG  H  ', -0.407, (208.526, 183.383, 261.693)), (' C  89  GLY  HA3', ' C 270  LEU HD12', -0.407, (199.136, 169.972, 231.905)), (' C 498  GLN  HB2', ' C 501  TYR  HD1', -0.407, (219.978, 214.549, 278.04)), (' C 532  ASN  OD1', ' C 533  LEU  N  ', -0.406, (241.424, 176.968, 234.015)), (' C1090  PRO  HD3', ' C1095  PHE  CE2', -0.406, (224.195, 202.923, 147.72)), (' C 290  ASP  OD1', ' C 291  CYS  N  ', -0.406, (203.749, 175.204, 217.598)), (' C 454  ARG  HD2', ' C 491  PRO  HB2', -0.406, (231.855, 227.678, 262.434)), (' C 194  PHE  HD1', ' C 203  ILE HG12', -0.406, (191.019, 168.059, 235.971)), (' A 712  ILE HD11', ' A1096  VAL HG12', -0.405, (225.289, 229.722, 153.763)), (' C 295  PRO  HB2', ' C 608  VAL HG21', -0.405, (210.979, 173.696, 207.069)), (' A  24  LEU  HA ', ' A  25  PRO  HD3', -0.404, (272.272, 231.084, 237.345)), (' B 445  VAL  HA ', ' B 499  PRO  HD2', -0.404, (202.136, 192.763, 280.367)), (' A 241  LEU  HA ', ' A 241  LEU HD23', -0.404, (268.048, 219.528, 246.553)), (' B 666  ILE  HB ', ' B 670  ILE  O  ', -0.403, (180.772, 217.935, 195.851)), (' A 350  VAL HG22', ' A 422  ASN  HB3', -0.403, (201.817, 240.995, 280.099)), (' B 586  ASP  N  ', ' B 586  ASP  OD1', -0.403, (174.72, 194.147, 220.315)), (' A 543  PHE  HE2', ' A 552  LEU HD21', -0.403, (217.279, 246.743, 229.295)), (' A 106  PHE  HB2', ' A 117  LEU  HB3', -0.402, (255.895, 216.257, 248.142)), (' B 529  LYS  HA ', ' B 529  LYS  HD2', -0.401, (170.835, 199.505, 243.985)), (' A 729  VAL HG22', ' A1059  GLY  HA2', -0.4, (224.939, 201.371, 189.154)), (' B 170  TYR  CE1', ' B 172  SER  HB2', -0.4, (192.805, 255.389, 244.131)), (' C1105  THR HG22', ' C1112  PRO  HA ', -0.4, (215.786, 195.499, 146.611)), (' B 318  PHE  HZ ', ' B 615  VAL HG11', -0.4, (178.27, 213.333, 211.003)), (' E   1  NAG  H4 ', ' E   2  NAG  H2 ', -0.4, (246.334, 229.575, 251.82))]
handle_read_draw_probe_dots_unformatted("molprobity_probe.txt", 0, 0)
show_probe_dots(True, True)
gui = coot_molprobity_todo_list_gui(data=data)
