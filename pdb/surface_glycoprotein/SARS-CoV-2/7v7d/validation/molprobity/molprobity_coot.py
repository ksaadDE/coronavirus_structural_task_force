# script auto-generated by phenix.molprobity


from __future__ import absolute_import, division, print_function
from six.moves import cPickle as pickle
from six.moves import range
try :
  import gobject
except ImportError :
  gobject = None
import sys

class coot_extension_gui(object):
  def __init__(self, title):
    import gtk
    self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)
    scrolled_win = gtk.ScrolledWindow()
    self.outside_vbox = gtk.VBox(False, 2)
    self.inside_vbox = gtk.VBox(False, 0)
    self.window.set_title(title)
    self.inside_vbox.set_border_width(0)
    self.window.add(self.outside_vbox)
    self.outside_vbox.pack_start(scrolled_win, True, True, 0)
    scrolled_win.add_with_viewport(self.inside_vbox)
    scrolled_win.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)

  def finish_window(self):
    import gtk
    self.outside_vbox.set_border_width(2)
    ok_button = gtk.Button("  Close  ")
    self.outside_vbox.pack_end(ok_button, False, False, 0)
    ok_button.connect("clicked", lambda b: self.destroy_window())
    self.window.connect("delete_event", lambda a, b: self.destroy_window())
    self.window.show_all()

  def destroy_window(self, *args):
    self.window.destroy()
    self.window = None

  def confirm_data(self, data):
    for data_key in self.data_keys :
      outlier_list = data.get(data_key)
      if outlier_list is not None and len(outlier_list) > 0 :
        return True
    return False

  def create_property_lists(self, data):
    import gtk
    for data_key in self.data_keys :
      outlier_list = data[data_key]
      if outlier_list is None or len(outlier_list) == 0 :
        continue
      else :
        frame = gtk.Frame(self.data_titles[data_key])
        vbox = gtk.VBox(False, 2)
        frame.set_border_width(6)
        frame.add(vbox)
        self.add_top_widgets(data_key, vbox)
        self.inside_vbox.pack_start(frame, False, False, 5)
        list_obj = residue_properties_list(
          columns=self.data_names[data_key],
          column_types=self.data_types[data_key],
          rows=outlier_list,
          box=vbox)

# Molprobity result viewer
class coot_molprobity_todo_list_gui(coot_extension_gui):
  data_keys = [ "rama", "rota", "cbeta", "probe" ]
  data_titles = { "rama"  : "Ramachandran outliers",
                  "rota"  : "Rotamer outliers",
                  "cbeta" : "C-beta outliers",
                  "probe" : "Severe clashes" }
  data_names = { "rama"  : ["Chain", "Residue", "Name", "Score"],
                 "rota"  : ["Chain", "Residue", "Name", "Score"],
                 "cbeta" : ["Chain", "Residue", "Name", "Conf.", "Deviation"],
                 "probe" : ["Atom 1", "Atom 2", "Overlap"] }
  if (gobject is not None):
    data_types = { "rama" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "rota" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "cbeta" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT],
                   "probe" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT] }
  else :
    data_types = dict([ (s, []) for s in ["rama","rota","cbeta","probe"] ])

  def __init__(self, data_file=None, data=None):
    assert ([data, data_file].count(None) == 1)
    if (data is None):
      data = load_pkl(data_file)
    if not self.confirm_data(data):
      return
    coot_extension_gui.__init__(self, "MolProbity to-do list")
    self.dots_btn = None
    self.dots2_btn = None
    self._overlaps_only = True
    self.window.set_default_size(420, 600)
    self.create_property_lists(data)
    self.finish_window()

  def add_top_widgets(self, data_key, box):
    import gtk
    if data_key == "probe" :
      hbox = gtk.HBox(False, 2)
      self.dots_btn = gtk.CheckButton("Show Probe dots")
      hbox.pack_start(self.dots_btn, False, False, 5)
      self.dots_btn.connect("toggled", self.toggle_probe_dots)
      self.dots2_btn = gtk.CheckButton("Overlaps only")
      hbox.pack_start(self.dots2_btn, False, False, 5)
      self.dots2_btn.connect("toggled", self.toggle_all_probe_dots)
      self.dots2_btn.set_active(True)
      self.toggle_probe_dots()
      box.pack_start(hbox, False, False, 0)

  def toggle_probe_dots(self, *args):
    if self.dots_btn is not None :
      show_dots = self.dots_btn.get_active()
      overlaps_only = self.dots2_btn.get_active()
      if show_dots :
        self.dots2_btn.set_sensitive(True)
      else :
        self.dots2_btn.set_sensitive(False)
      show_probe_dots(show_dots, overlaps_only)

  def toggle_all_probe_dots(self, *args):
    if self.dots2_btn is not None :
      self._overlaps_only = self.dots2_btn.get_active()
      self.toggle_probe_dots()

class rsc_todo_list_gui(coot_extension_gui):
  data_keys = ["by_res", "by_atom"]
  data_titles = ["Real-space correlation by residue",
                 "Real-space correlation by atom"]
  data_names = {}
  data_types = {}

class residue_properties_list(object):
  def __init__(self, columns, column_types, rows, box,
      default_size=(380,200)):
    assert len(columns) == (len(column_types) - 1)
    if (len(rows) > 0) and (len(rows[0]) != len(column_types)):
      raise RuntimeError("Wrong number of rows:\n%s" % str(rows[0]))
    import gtk
    self.liststore = gtk.ListStore(*column_types)
    self.listmodel = gtk.TreeModelSort(self.liststore)
    self.listctrl = gtk.TreeView(self.listmodel)
    self.listctrl.column = [None]*len(columns)
    self.listctrl.cell = [None]*len(columns)
    for i, column_label in enumerate(columns):
      cell = gtk.CellRendererText()
      column = gtk.TreeViewColumn(column_label)
      self.listctrl.append_column(column)
      column.set_sort_column_id(i)
      column.pack_start(cell, True)
      column.set_attributes(cell, text=i)
    self.listctrl.get_selection().set_mode(gtk.SELECTION_SINGLE)
    for row in rows :
      self.listmodel.get_model().append(row)
    self.listctrl.connect("cursor-changed", self.OnChange)
    sw = gtk.ScrolledWindow()
    w, h = default_size
    if len(rows) > 10 :
      sw.set_size_request(w, h)
    else :
      sw.set_size_request(w, 30 + (20 * len(rows)))
    sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
    box.pack_start(sw, False, False, 5)
    inside_vbox = gtk.VBox(False, 0)
    sw.add(self.listctrl)

  def OnChange(self, treeview):
    import coot # import dependency
    selection = self.listctrl.get_selection()
    (model, tree_iter) = selection.get_selected()
    if tree_iter is not None :
      row = model[tree_iter]
      xyz = row[-1]
      if isinstance(xyz, tuple) and len(xyz) == 3 :
        set_rotation_centre(*xyz)
        set_zoom(30)
        graphics_draw()

def show_probe_dots(show_dots, overlaps_only):
  import coot # import dependency
  n_objects = number_of_generic_objects()
  sys.stdout.flush()
  if show_dots :
    for object_number in range(n_objects):
      obj_name = generic_object_name(object_number)
      if overlaps_only and not obj_name in ["small overlap", "bad overlap"] :
        sys.stdout.flush()
        set_display_generic_object(object_number, 0)
      else :
        set_display_generic_object(object_number, 1)
  else :
    sys.stdout.flush()
    for object_number in range(n_objects):
      set_display_generic_object(object_number, 0)

def load_pkl(file_name):
  pkl = open(file_name, "rb")
  data = pickle.load(pkl)
  pkl.close()
  return data

data = {}
data['rama'] = [('A', '1101 ', 'ASP', 0.035878646181424056, (189.37701, 217.04601, 145.35001))]
data['omega'] = []
data['rota'] = []
data['cbeta'] = []
data['probe'] = [(' B 555  SER  HB3', ' B 586  ASP  HB2', -0.859, (242.861, 187.344, 227.566)), (' A 725  GLU  OE2', ' A1064  HIS  NE2', -0.78, (207.702, 224.74, 183.584)), (' C 724  THR HG23', ' C 934  ILE HD11', -0.748, (234.749, 207.366, 184.493)), (' C 126  VAL HG13', ' C 174  PRO  HA ', -0.733, (264.289, 204.602, 248.59)), (' A1129  VAL  HB ', ' A1132  ILE HD11', -0.711, (193.614, 199.42, 150.929)), (' A 391  CYS  HA ', ' A 525  CYS  HB3', -0.705, (181.467, 198.822, 249.552)), (' B 349  SER  OG ', ' B 452  ARG  O  ', -0.705, (232.251, 218.917, 271.285)), (' B 126  VAL HG13', ' B 174  PRO  HA ', -0.7, (177.207, 167.461, 246.174)), (' C  99  ASN  O  ', ' C 102  ARG  NH2', -0.699, (272.226, 210.384, 246.219)), (' B 393  THR  HB ', ' B 522  ALA  HA ', -0.697, (239.583, 198.322, 247.945)), (' A 315  THR HG22', ' A 316  SER  H  ', -0.687, (186.059, 225.94, 218.401)), (' C 340  GLU  OE1', ' C 356  LYS  NZ ', -0.687, (202.123, 244.664, 266.725)), (' C1125  ASN  ND2', ' C1127  ASP  OD2', -0.681, (206.378, 237.997, 145.186)), (' B1125  ASN  ND2', ' B1127  ASP  OD2', -0.677, (238.754, 205.467, 146.162)), (' A 126  VAL HG13', ' A 174  PRO  HA ', -0.665, (188.186, 262.593, 245.823)), (' C 611  LEU HD12', ' C 650  LEU HD12', -0.662, (236.264, 234.277, 208.135)), (' C 560  LEU HD23', ' C 562  PHE  HE1', -0.658, (198.515, 253.046, 231.457)), (' B 986  PRO  O  ', ' B 989  ALA  N  ', -0.658, (197.05, 213.105, 243.703)), (' A 555  SER  HB3', ' A 586  ASP  HB2', -0.654, (173.512, 196.354, 226.032)), (' B  65  PHE  O  ', ' B 264  ALA  HA ', -0.651, (191.519, 153.625, 236.855)), (' C1028  LYS  NZ ', ' C1042  PHE  O  ', -0.641, (222.351, 211.122, 184.746)), (' C1104  VAL HG13', ' C1115  ILE HG12', -0.639, (222.606, 223.807, 149.51)), (' C 426  PRO  HG2', ' C 429  PHE  HB2', -0.636, (199.043, 227.61, 251.799)), (' A 809  PRO  O  ', ' A 814  LYS  NZ ', -0.634, (224.164, 249.337, 186.847)), (' A 726  ILE HG12', ' A1061  VAL HG22', -0.63, (207.437, 231.622, 190.267)), (' B 103  GLY  H  ', ' B 241  LEU  HB2', -0.625, (184.929, 160.208, 247.311)), (' A 108  THR  O  ', ' A 237  ARG  NH1', -0.618, (173.086, 242.291, 253.54)), (' C 197  ILE  HB ', ' C 202  LYS  HZ1', -0.614, (244.512, 213.057, 244.689)), (' C 555  SER  HB3', ' C 586  ASP  HB2', -0.614, (216.341, 251.166, 226.545)), (' A 457  ARG  NH2', ' A 460  ASN  O  ', -0.612, (211.804, 183.068, 258.355)), (' A 984  LEU HD21', ' A 988  GLU  HG2', -0.611, (213.812, 222.949, 246.425)), (' A 394  ASN  ND2', ' B 200  TYR  OH ', -0.611, (189.269, 186.758, 249.872)), (' A 379  CYS  HA ', ' A 432  CYS  CB ', -0.608, (195.676, 202.741, 255.966)), (' B 452  ARG  HG2', ' B 492  LEU  HB3', -0.608, (232.971, 224.547, 273.034)), (' C  25  PRO  HD2', ' C  66  HIS  HB3', -0.607, (271.443, 229.065, 239.472)), (' A 376  THR  HB ', ' A 435  ALA  HB3', -0.607, (198.73, 203.572, 266.022)), (' C 642  VAL HG12', ' C 651  ILE HG22', -0.605, (240.975, 240.326, 213.737)), (' A  99  ASN  O  ', ' A 102  ARG  NH2', -0.602, (179.285, 265.761, 243.424)), (' B 457  ARG  NH2', ' B 460  ASN  O  ', -0.602, (232.378, 227.543, 257.785)), (' A 560  LEU HD12', ' A 561  PRO  HD2', -0.6, (175.958, 181.016, 233.003)), (' B 809  PRO  O  ', ' B 814  LYS  NZ ', -0.599, (173.311, 203.756, 184.116)), (' C 403  ARG  NH1', ' C 504  GLY  O  ', -0.598, (198.955, 217.044, 274.045)), (' A 724  THR HG23', ' A 934  ILE HD11', -0.594, (204.015, 233.579, 183.353)), (' A 540  ASN  HB3', ' A 549  THR HG22', -0.592, (178.652, 210.224, 234.565)), (' B 331  ASN  OD1', ' B 580  GLN  NE2', -0.59, (242.461, 183.846, 248.076)), (' C 809  PRO  O  ', ' C 814  LYS  NZ ', -0.589, (238.273, 182.458, 186.495)), (' C 560  LEU  HG ', ' C 561  PRO  HD2', -0.588, (200.328, 256.14, 232.22)), (' B 598  ILE HG23', ' B 664  ILE HD13', -0.587, (211.02, 179.25, 204.931)), (' A 378  LYS  O  ', ' A 432  CYS  HB2', -0.585, (196.052, 202.98, 257.249)), (' A 786  LYS  HG3', ' A 787  GLN  HG3', -0.585, (232.612, 227.749, 180.257)), (' B 110  LEU  HB3', ' B 135  PHE  HD2', -0.584, (194.602, 162.017, 256.115)), (' d   1  NAG  H3 ', ' d   1  NAG  H83', -0.584, (213.777, 238.652, 270.647)), (' A  21  ARG  NH1', ' A  23  GLN  OE1', -0.583, (158.166, 252.259, 244.291)), (' H   1  NAG  H3 ', ' H   1  NAG  H83', -0.579, (181.823, 203.565, 155.262)), (' A 329  PHE  O  ', ' A 580  GLN  NE2', -0.577, (170.585, 197.628, 245.356)), (' A 357  ARG  NH2', ' B 230  PRO  O  ', -0.575, (189.177, 182.061, 253.731)), (' C 457  ARG  NH1', ' C 467  ASP  OD2', -0.574, (182.553, 227.814, 261.368)), (' C 726  ILE HG12', ' C1061  VAL HG22', -0.572, (230.745, 205.591, 191.145)), (' B1053  PRO  O  ', ' B1054  GLN  NE2', -0.571, (189.944, 203.083, 183.359)), (' B 611  LEU HD12', ' B 650  LEU HD12', -0.571, (218.049, 179.018, 207.765)), (' B 455  LEU  N  ', ' B 491  PRO  O  ', -0.57, (229.991, 226.814, 269.036)), (' B  18  LEU  O  ', ' B  21  ARG  NH1', -0.569, (195.398, 145.93, 253.616)), (' A 103  GLY  H  ', ' A 241  LEU  HB2', -0.568, (177.347, 258.417, 247.442)), (' C 226  LEU  HG ', ' C 227  VAL HG23', -0.568, (256.465, 204.509, 244.968)), (' A 352  ALA  HB1', ' A 466  ARG HH21', -0.562, (198.601, 183.078, 267.154)), (' B 517  LEU  H  ', ' B 519  HIS  CE1', -0.56, (234.315, 204.703, 245.563)), (' A 403  ARG  NH1', ' A 504  GLY  O  ', -0.558, (209.285, 200.635, 274.113)), (' A 379  CYS  HA ', ' A 432  CYS  HB2', -0.558, (196.004, 202.94, 256.664)), (' C 733  LYS  HD2', ' C 771  ALA  HB1', -0.557, (217.333, 193.471, 206.195)), (' B  83  VAL HG11', ' B 237  ARG  HE ', -0.556, (200.604, 161.942, 251.144)), (' A 418  ILE  HA ', ' A 422  ASN HD22', -0.556, (209.263, 190.22, 265.336)), (' A 200  TYR  HE1', ' C 357  ARG HH12', -0.556, (196.647, 243.073, 250.341)), (' C 984  LEU HD13', ' C 988  GLU  HG2', -0.554, (217.705, 201.571, 246.083)), (' A 989  ALA  O  ', ' A 993  ILE HD12', -0.552, (216.428, 222.519, 240.538)), (' B 108  THR  O  ', ' B 237  ARG  NH1', -0.55, (201.098, 164.469, 254.233)), (' B 866  THR HG22', ' B 869  MET  HE2', -0.549, (181.941, 213.151, 194.432)), (' B 381  GLY  O  ', ' C 983  ARG  NH1', -0.549, (223.805, 202.194, 247.252)), (' B 974  SER  HB3', ' B 980  ILE HD11', -0.547, (194.942, 203.594, 238.686)), (' A  37  TYR  OH ', ' A 195  LYS  NZ ', -0.547, (190.444, 241.872, 236.836)), (' C 567  ARG  NH1', ' C 571  ASP  OD1', -0.544, (207.286, 237.74, 230.846)), (' C 568  ASP  OD1', ' C 572  THR  OG1', -0.541, (210.513, 239.882, 224.561)), (' A 168  PHE  CE2', ' A 170  TYR  HB2', -0.54, (192.943, 253.654, 253.134)), (' B1106  GLN HE21', ' B1109  PHE  HB3', -0.537, (208.959, 195.813, 158.93)), (' A 175  PHE  O  ', ' A 190  ARG  NH2', -0.536, (187.423, 261.484, 238.932)), (' B 568  ASP  OD1', ' B 572  THR  OG1', -0.536, (234.674, 196.604, 225.836)), (' B 733  LYS  HD2', ' B 771  ALA  HB1', -0.535, (192.087, 215.365, 205.437)), (' A 931  ILE  O  ', ' A 934  ILE HG22', -0.533, (204.591, 238.952, 180.301)), (' B 344  ALA  HB3', ' B 347  PHE  HE1', -0.533, (234.262, 204.577, 271.761)), (' A 523  THR HG23', ' A 524  VAL HG23', -0.53, (181.603, 192.203, 252.212)), (' A 377  PHE  HE2', ' A 384  PRO  HB3', -0.528, (191.438, 208.02, 257.582)), (' C1115  ILE HG22', ' C1137  VAL HG23', -0.527, (219.928, 224.508, 144.897)), (' B 560  LEU HD12', ' B 561  PRO  HD2', -0.524, (254.637, 196.524, 233.752)), (' C 974  SER  HB3', ' C 980  ILE HD11', -0.523, (224.172, 202.116, 240.492)), (' B1135  ASN  OD1', ' B1136  THR  N  ', -0.522, (224.702, 195.386, 143.338)), (' C 826  VAL HG11', ' C1057  PRO  HG2', -0.52, (233.726, 199.824, 198.317)), (' B  31  SER  HB3', ' B  60  SER  H  ', -0.517, (199.526, 166.253, 227.928)), (' B 931  ILE  O  ', ' B 934  ILE HG22', -0.515, (191.848, 191.453, 179.586)), (' A 612  TYR  HB2', ' A 649  CYS  SG ', -0.515, (176.232, 219.124, 213.227)), (' C 605  SER  OG ', ' C 606  ASN  N  ', -0.515, (251.022, 224.637, 208.913)), (' B 290  ASP  OD1', ' B 291  CYS  N  ', -0.515, (201.701, 176.841, 224.777)), (' C1135  ASN  OD1', ' C1136  THR  N  ', -0.514, (221.947, 230.802, 143.455)), (' A 866  THR HG22', ' A 869  MET  HG3', -0.513, (226.467, 237.016, 195.759)), (' C 786  LYS  HG3', ' C 787  GLN  HG3', -0.513, (215.653, 186.199, 179.612)), (' B 770  ILE HD11', ' B1012  LEU HD23', -0.513, (202.898, 214.574, 208.145)), (' C 452  ARG  HG3', ' C 494  SER  HA ', -0.512, (188.017, 226.104, 275.957)), (' B 409  GLN  HB3', ' B 419  ALA  HB2', -0.512, (222.566, 218.427, 261.378)), (' A 826  VAL HG11', ' A1057  PRO  HG2', -0.511, (210.199, 236.82, 197.513)), (' A 408  ARG  NH2', ' A 414  GLN  OE1', -0.51, (211.224, 200.972, 260.341)), (' A 403  ARG  HG3', ' A 497  PHE  HE1', -0.508, (205.261, 197.075, 275.48)), (' C 578  ASP  N  ', ' C 578  ASP  OD1', -0.507, (214.276, 252.942, 237.314)), (' B  17  ASN  OD1', ' B 137  ASN  ND2', -0.506, (195.331, 149.473, 258.0)), (' C1086  LYS  HD2', ' C1122  VAL HG11', -0.505, (209.086, 226.884, 143.774)), (' C 351  TYR  OH ', ' C 452  ARG  NH2', -0.502, (185.87, 231.166, 273.315)), (' A 121  ASN HD21', ' A 176  LEU  H  ', -0.501, (185.609, 263.285, 242.796)), (' C 143  VAL HG23', ' C 154  LYS  HB3', -0.499, (278.648, 209.284, 254.484)), (' B 102  ARG  HG3', ' B 141  LEU HD22', -0.498, (180.755, 157.184, 248.661)), (' B 383  SER  H  ', ' C 984  LEU  HA ', -0.496, (221.682, 198.139, 250.089)), (' A 357  ARG  CZ ', ' B 230  PRO  HB2', -0.496, (188.199, 183.902, 253.124)), (' A1050  MET  HE2', ' A1052  PHE  CZ ', -0.496, (212.86, 232.533, 175.113)), (' B 950  ASP  OD1', ' B 951  VAL  N  ', -0.494, (199.964, 198.496, 202.008)), (' A 201  PHE  HD2', ' A 203  ILE HD11', -0.494, (188.175, 249.222, 246.45)), (' B 357  ARG  NH2', ' B 359  SER  OG ', -0.494, (242.276, 202.211, 254.382)), (' B 560  LEU HD23', ' B 562  PHE  CE1', -0.493, (251.509, 200.78, 234.127)), (' B 770  ILE  O  ', ' B 774  GLN  HG2', -0.493, (196.693, 213.808, 203.575)), (' C 323  THR HG21', ' C 537  LYS  HE3', -0.493, (232.891, 245.766, 231.855)), (' B 759  PHE  HD2', ' B1001  LEU HD21', -0.493, (203.118, 216.913, 225.745)), (' A 439  ASN  HB2', ' A 506  GLN  HB3', -0.492, (200.307, 202.256, 278.237)), (' A 640  SER  OG ', ' A 641  ASN  N  ', -0.492, (168.502, 228.078, 207.872)), (' A 796  ASP  N  ', ' A 796  ASP  OD1', -0.491, (219.604, 242.821, 167.592)), (' C 989  ALA  O  ', ' C 993  ILE HG12', -0.491, (216.464, 199.831, 239.926)), (' C 770  ILE HD11', ' C1012  LEU HD23', -0.49, (212.307, 203.071, 208.424)), (' A 121  ASN  HA ', ' A 126  VAL HG12', -0.488, (185.995, 261.76, 247.48)), (' A 336  CYS  HA ', ' A 361  CYS  HB2', -0.488, (178.489, 194.034, 258.972)), (' B 826  VAL HG11', ' B1057  PRO  HG2', -0.487, (190.487, 198.121, 196.775)), (' C 105  ILE  HB ', ' C 239  GLN  HB2', -0.487, (261.296, 221.096, 252.922)), (' A 379  CYS  HA ', ' A 432  CYS  HB3', -0.486, (195.25, 203.039, 255.724)), (' A 733  LYS  HD2', ' A 771  ALA  HB1', -0.486, (223.872, 226.188, 206.691)), (' B 418  ILE HG23', ' B 422  ASN  HB2', -0.485, (228.02, 219.58, 265.175)), (' C 103  GLY  H  ', ' C 241  LEU  HB2', -0.484, (266.521, 215.419, 250.058)), (' A 402  ILE HD12', ' A 406  GLU  HG3', -0.483, (204.777, 197.591, 268.306)), (' A 105  ILE  HB ', ' A 239  GLN  HB2', -0.482, (175.603, 251.816, 250.29)), (' C 902  MET  HE1', ' C1049  LEU HD13', -0.482, (229.043, 206.633, 170.407)), (' B 612  TYR  HB2', ' B 649  CYS  SG ', -0.48, (221.632, 178.175, 214.486)), (' A 654  GLU  HB3', ' A 693  ILE HG22', -0.48, (171.584, 228.722, 199.773)), (' A 707  TYR  HB3', ' B 792  PRO  HG3', -0.48, (182.055, 208.609, 168.379)), (' B 170  TYR  HE1', ' B 172  SER  HB2', -0.48, (178.267, 175.119, 248.638)), (' B 355  ARG  HD2', ' B 396  TYR  HD1', -0.48, (238.303, 208.999, 258.253)), (' B 142  ASP  OD2', ' B 158  ARG  NE ', -0.479, (183.482, 151.03, 256.837)), (' B 555  SER  OG ', ' B 584  ILE  O  ', -0.479, (244.84, 186.959, 230.438)), (' B 905  ARG  NH1', ' B1049  LEU  O  ', -0.479, (199.592, 205.436, 172.446)), (' B 517  LEU HD21', ' C 983  ARG HH21', -0.479, (228.255, 201.947, 247.072)), (' C  89  GLY  HA3', ' C 270  LEU HD12', -0.478, (250.676, 218.979, 240.813)), (' C 950  ASP  OD1', ' C 951  VAL  N  ', -0.478, (228.438, 208.471, 203.116)), (' A 858  LEU  H  ', ' A 858  LEU HD23', -0.478, (218.43, 232.366, 219.779)), (' C  18  LEU HD22', ' C 140  PHE  HZ ', -0.477, (273.608, 225.796, 254.775)), (' C 393  THR HG22', ' C 523  THR HG22', -0.477, (205.585, 245.176, 248.945)), (' A 770  ILE HD11', ' A1012  LEU HD23', -0.476, (217.843, 217.432, 208.31)), (' A 426  PRO  HG2', ' A 429  PHE  HB2', -0.475, (200.602, 195.249, 252.189)), (' C 985  ASP  OD1', ' C 986  PRO  HD2', -0.475, (215.222, 196.117, 249.683)), (' B 129  LYS  HG2', ' B 169  GLU  HG3', -0.472, (182.197, 170.526, 257.993)), (' B 201  PHE  HB3', ' B 229  LEU  HB2', -0.472, (188.37, 176.147, 248.516)), (' A1105  THR HG22', ' A1112  PRO  HA ', -0.471, (196.987, 220.183, 152.903)), (' C 448  ASN  HB2', ' C 497  PHE  HB2', -0.471, (195.954, 226.395, 280.807)), (' C 138  ASP  HB3', ' C 140  PHE  CE1', -0.471, (271.451, 224.614, 255.311)), (' A 707  TYR  HD1', ' B 883  THR HG23', -0.471, (186.034, 209.73, 167.738)), (' B 985  ASP  OD1', ' B 986  PRO  HD2', -0.47, (193.009, 214.481, 248.354)), (' B 737  ASP  OD1', ' B 738  CYS  N  ', -0.469, (192.174, 216.289, 221.711)), (' B 127  VAL HG21', ' N   1  NAG  H61', -0.467, (176.623, 166.077, 254.581)), (' A 664  ILE  O  ', ' A 671  CYS  HB2', -0.467, (183.218, 224.193, 200.007)), (' B 521  PRO  HG3', ' B 564  GLN  HG3', -0.466, (244.017, 197.231, 241.419)), (' A 709  ASN  HA ', ' B 897  PRO  HB3', -0.466, (186.682, 206.761, 161.739)), (' C 391  CYS  SG ', ' C 522  ALA  HB1', -0.466, (210.43, 244.706, 247.267)), (' C1138  TYR  HE1', ' C1143  PRO  HG3', -0.465, (222.56, 219.526, 135.583)), (' A 897  PRO  HG2', ' A 900  MET  SD ', -0.465, (220.165, 232.394, 160.911)), (' A 409  GLN HE22', ' A 417  LYS  H  ', -0.464, (211.579, 195.811, 265.16)), (' C 328  ARG HH21', ' C 580  GLN  HB2', -0.464, (216.977, 254.923, 241.787)), (' C 453  TYR  HE2', ' C 455  LEU HD13', -0.464, (188.009, 219.35, 269.955)), (' B 355  ARG  NH1', ' B 398  ASP  OD1', -0.463, (235.337, 209.865, 259.268)), (' B  25  PRO  HD2', ' B  66  HIS  HB3', -0.463, (195.011, 149.246, 237.554)), (' C 121  ASN  HA ', ' C 126  VAL HG12', -0.463, (265.294, 206.7, 250.183)), (' C 393  THR  OG1', ' C 516  GLU  OE2', -0.463, (203.716, 241.512, 247.088)), (' C 516  GLU  OE1', ' C 519  HIS  ND1', -0.463, (202.521, 238.27, 244.701)), (' C1043  CYS  HB2', ' C1064  HIS  CE1', -0.463, (224.579, 208.056, 182.279)), (' B  30  ASN  HB3', ' B  32  PHE  CZ ', -0.463, (197.321, 160.896, 224.529)), (' B 796  ASP  N  ', ' B 796  ASP  OD1', -0.461, (181.911, 202.472, 165.886)), (' B 168  PHE  CE2', ' B 170  TYR  HB2', -0.461, (182.236, 175.601, 253.509)), (' C 569  ILE  O  ', ' C 572  THR  OG1', -0.46, (210.132, 238.686, 224.712)), (' A 117  LEU HD21', ' A 119  ILE HD11', -0.459, (185.245, 251.253, 250.105)), (' C 403  ARG  HD2', ' C 505  TYR  CD1', -0.459, (196.671, 218.587, 275.899)), (' C 314  GLN  NE2', ' C 316  SER  O  ', -0.458, (231.602, 227.016, 218.166)), (' C 758  SER  O  ', ' C 762  GLN  NE2', -0.457, (204.683, 199.617, 221.297)), (' A 401  VAL HG22', ' A 509  ARG  HG2', -0.457, (196.192, 195.234, 272.405)), (' B1105  THR HG22', ' B1112  PRO  HA ', -0.457, (214.117, 193.746, 152.775)), (' A 128  ILE  HB ', ' A 170  TYR  HB3', -0.456, (190.883, 254.899, 252.309)), (' C 295  PRO  HB2', ' C 608  VAL HG21', -0.456, (243.365, 227.114, 215.192)), (' A 299  THR  OG1', ' A 597  VAL HG21', -0.456, (185.282, 230.718, 213.131)), (' B 664  ILE  O  ', ' B 671  CYS  HB2', -0.455, (214.34, 181.437, 200.56)), (' A1126  CYS  HB2', ' A1132  ILE HD13', -0.455, (193.778, 200.162, 148.081)), (' A1043  CYS  HB2', ' A1064  HIS  CE1', -0.455, (208.837, 224.66, 181.786)), (' A  88  ASP  OD1', ' A  89  GLY  N  ', -0.454, (181.43, 240.034, 240.565)), (' A 802  PHE  CD2', ' A 882  ILE HD11', -0.454, (215.515, 237.954, 173.592)), (' B 726  ILE HG12', ' B1061  VAL HG22', -0.454, (196.64, 198.087, 189.966)), (' A 560  LEU  O  ', ' A 562  PHE  N  ', -0.453, (177.859, 184.016, 235.025)), (' A 724  THR  CG2', ' A 934  ILE HD11', -0.453, (204.447, 233.615, 184.085)), (' A  83  VAL HG11', ' A 237  ARG  HE ', -0.452, (171.314, 244.951, 250.536)), (' C  18  LEU  O  ', ' C  21  ARG  NH2', -0.451, (273.528, 231.515, 256.185)), (' C 290  ASP  OD1', ' C 291  CYS  N  ', -0.449, (245.264, 221.16, 225.607)), (' A 340  GLU  O  ', ' A 344  ALA  HB2', -0.447, (186.809, 192.5, 270.24)), (' B 409  GLN  OE1', ' B 419  ALA  N  ', -0.447, (223.728, 219.901, 262.993)), (' C1101  ASP  O  ', ' C1102  TRP  HB2', -0.447, (226.066, 229.367, 146.645)), (' C 722  VAL HG22', ' C1065  VAL HG22', -0.447, (232.836, 206.601, 177.393)), (' C 442  ASP  OD1', ' C 451  TYR  OH ', -0.447, (198.211, 232.307, 277.706)), (' A  96  GLU  HG2', ' A 101  ILE  H  ', -0.447, (176.646, 262.384, 241.125)), (' C  65  PHE  O  ', ' C 264  ALA  HA ', -0.446, (269.549, 224.017, 239.256)), (' C 664  ILE  O  ', ' C 671  CYS  HB2', -0.446, (236.287, 229.524, 201.689)), (' C 731  MET  HB2', ' C 955  ASN HD21', -0.446, (223.695, 202.27, 206.094)), (' B 605  SER  OG ', ' B 606  ASN  N  ', -0.446, (202.858, 170.735, 207.144)), (' A 984  LEU HD23', ' A 985  ASP  O  ', -0.446, (216.58, 223.884, 246.685)), (' C 788  ILE HG23', ' C 876  ALA  HB2', -0.444, (224.64, 186.926, 183.043)), (' B 188  ASN  ND2', ' B 190  ARG HH12', -0.444, (178.228, 162.875, 233.656)), (' B 411  ALA  HB3', ' B 414  GLN  HG3', -0.443, (219.576, 215.213, 257.863)), (' C 811  LYS  HB2', ' C 811  LYS  HE3', -0.443, (241.172, 188.598, 188.691)), (' C 188  ASN  HB3', ' C 190  ARG  NH1', -0.443, (270.574, 210.206, 236.974)), (' C 998  THR  O  ', ' C1002  GLN  NE2', -0.442, (213.594, 207.579, 228.01)), (' C 444  LYS  HG2', ' C 446  GLY  H  ', -0.442, (196.649, 228.653, 288.203)), (' B 906  PHE  CD2', ' B 916  LEU  HB2', -0.442, (200.105, 199.47, 162.571)), (' A 535  LYS  NZ ', ' A 554  GLU  OE1', -0.442, (166.097, 198.032, 228.836)), (' B 661  GLU  O  ', ' B 695  TYR  OH ', -0.442, (213.785, 178.678, 195.332)), (' B 354  ASN  HB2', ' B 399  SER  OG ', -0.441, (235.638, 208.919, 267.557)), (' C 636  TYR  CE1', ' C 639  GLY  HA3', -0.441, (247.253, 235.623, 216.125)), (' B 786  LYS  NZ ', ' B 891  GLY  O  ', -0.441, (192.583, 221.707, 175.483)), (' B 977  LEU  H  ', ' B 977  LEU HD23', -0.44, (191.299, 207.04, 233.92)), (' C 132  GLU  HB2', ' C 164  ASN  OD1', -0.44, (255.585, 216.977, 266.546)), (' A 168  PHE  HE2', ' A 170  TYR  HB2', -0.439, (192.754, 253.629, 253.092)), (' B 763  LEU HD22', ' B1008  VAL HG21', -0.439, (201.1, 214.123, 217.24)), (' C 931  ILE  O  ', ' C 934  ILE HG22', -0.439, (239.321, 204.591, 181.47)), (' A1038  LYS  HB2', ' A1038  LYS  HE2', -0.439, (211.689, 215.546, 172.779)), (' C1081  ILE HD13', ' C1133  VAL HG23', -0.437, (219.926, 232.878, 149.119)), (' B 190  ARG  HB3', ' B 192  PHE  HE1', -0.437, (183.939, 164.508, 237.779)), (' A 605  SER  OG ', ' A 606  ASN  N  ', -0.437, (179.529, 239.091, 206.405)), (' C 190  ARG  HB3', ' C 192  PHE  HE1', -0.436, (264.256, 211.914, 239.749)), (' B 365  TYR  N  ', ' B 388  ASN  OD1', -0.436, (229.13, 191.625, 258.477)), (' C 233  ILE HG22', ' C 234  ASN  N  ', -0.436, (249.219, 218.475, 255.249)), (' B 650  LEU HD21', ' B 653  ALA  HB3', -0.435, (216.473, 173.563, 206.191)), (' C 212  LEU HD23', ' C 213  VAL  N  ', -0.434, (272.418, 219.087, 226.953)), (' A 707  TYR  CD1', ' B 883  THR HG23', -0.433, (186.093, 209.517, 167.899)), (' B 988  GLU  O  ', ' B 992  GLN  HG2', -0.433, (199.091, 209.733, 242.382)), (' C  40  ASP  N  ', ' C  40  ASP  OD1', -0.433, (244.613, 206.243, 234.343)), (' A 567  ARG  NH1', ' A 571  ASP  OD1', -0.432, (189.851, 196.157, 232.325)), (' A1028  LYS  NZ ', ' A1042  PHE  O  ', -0.432, (207.167, 220.63, 184.745)), (' C 568  ASP  N  ', ' C 568  ASP  OD1', -0.432, (209.242, 242.225, 224.917)), (' C 986  PRO  HA ', ' C 989  ALA  HB3', -0.431, (215.793, 197.449, 244.313)), (' A 740  MET  HG2', ' C 319  ARG  NH2', -0.431, (225.916, 229.982, 225.883)), (' B 319  ARG  NH2', ' C 745  ASP  OD2', -0.43, (222.531, 187.17, 228.904)), (' A 431  GLY  HA2', ' A 515  PHE  CE2', -0.43, (192.496, 199.092, 253.25)), (' A 316  SER  O  ', ' A 595  VAL HG22', -0.43, (184.805, 222.654, 217.974)), (' C 401  VAL HG22', ' C 509  ARG  HG2', -0.429, (200.628, 231.243, 272.34)), (' A 205  SER  HB3', ' A 226  LEU HD22', -0.429, (189.8, 256.04, 239.066)), (' B 403  ARG  HD2', ' B 505  TYR  CD1', -0.429, (219.752, 218.547, 275.293)), (' B 562  PHE  HD2', ' C  41  LYS  HD3', -0.429, (247.986, 201.791, 238.47)), (' B 724  THR  CG2', ' B 934  ILE HD11', -0.428, (196.36, 194.086, 183.642)), (' B 691  SER  OG ', ' B 692  ILE  N  ', -0.428, (211.472, 168.746, 203.629)), (' B 752  LEU  O  ', ' B 755  GLN  HG2', -0.428, (200.131, 220.173, 233.943)), (' A 568  ASP  OD1', ' A 572  THR  OG1', -0.428, (186.009, 197.442, 224.943)), (' K   1  NAG  H4 ', ' K   2  NAG  N2 ', -0.427, (178.409, 219.668, 163.859)), (' B 367  VAL HG23', ' B 368  LEU HD12', -0.427, (229.487, 192.959, 264.247)), (' A 308  VAL HG12', ' A 602  THR  HB ', -0.425, (187.263, 237.707, 209.487)), (' C 409  GLN  OE1', ' C 418  ILE  N  ', -0.425, (193.813, 219.749, 264.323)), (' A 988  GLU  O  ', ' A 992  GLN  HG2', -0.425, (213.622, 221.373, 242.845)), (' A 391  CYS  HA ', ' A 525  CYS  CB ', -0.425, (181.467, 199.087, 249.563)), (' B 408  ARG  NH1', ' B 414  GLN  OE1', -0.425, (217.975, 218.398, 259.529)), (' C 106  PHE  HD1', ' C 235  ILE HG21', -0.424, (254.349, 219.003, 250.593)), (' C 748  GLU  N  ', ' C 748  GLU  OE1', -0.424, (214.642, 191.081, 238.316)), (' C 190  ARG  HB3', ' C 192  PHE  CE1', -0.424, (263.831, 211.733, 239.961)), (' A 896  ILE HD12', ' A 897  PRO  HD2', -0.423, (222.351, 231.39, 163.113)), (' C 661  GLU  O  ', ' C 695  TYR  OH ', -0.423, (239.606, 230.148, 196.0)), (' A 752  LEU  O  ', ' A 755  GLN  HG2', -0.423, (223.2, 215.536, 234.464)), (' B 553  THR HG23', ' B 586  ASP  HB3', -0.423, (240.693, 184.613, 227.323)), (' B 117  LEU HD13', ' B 130  VAL HG22', -0.422, (188.262, 172.613, 254.613)), (' C 959  LEU  HA ', ' C 959  LEU HD12', -0.422, (224.513, 202.092, 216.564)), (' B 715  PRO  HA ', ' B1072  GLU  HA ', -0.422, (212.545, 188.095, 163.744)), (' C 290  ASP  O  ', ' C 297  SER  HB3', -0.419, (245.215, 220.932, 222.087)), (' B 109  THR  OG1', ' B 111  ASP  OD1', -0.419, (199.28, 165.329, 260.305)), (' C 662  CYS  SG ', ' C 697  MET  HE2', -0.418, (233.392, 229.879, 198.282)), (' A 129  LYS  HG3', ' A 131  CYS  SG ', -0.418, (185.658, 253.982, 259.453)), (' A 393  THR HG21', ' A 520  ALA  HB3', -0.417, (185.124, 189.667, 245.876)), (' C 742  ILE HG22', ' C1000  ARG  HB3', -0.417, (218.074, 200.914, 227.053)), (' A 641  ASN HD21', ' A 654  GLU  HG3', -0.416, (168.265, 227.745, 202.843)), (' C 494  SER  OG ', ' C 495  TYR  N  ', -0.416, (189.811, 224.696, 278.264)), (' A 357  ARG  NH1', ' A 396  TYR  OH ', -0.415, (190.012, 185.289, 253.466)), (' B 986  PRO  HA ', ' B 989  ALA  HB3', -0.415, (194.689, 213.717, 243.534)), (' C 444  LYS  N  ', ' C 448  ASN  OD1', -0.415, (198.021, 228.433, 283.543)), (' A  89  GLY  HA3', ' A 270  LEU HD12', -0.415, (183.703, 242.129, 238.965)), (' C 577  ARG  HG3', ' C 582  LEU  HA ', -0.415, (211.458, 254.335, 237.266)), (' A 364  ASP  O  ', ' A 367  VAL HG22', -0.415, (181.438, 203.385, 260.963)), (' C 825  LYS  HD2', ' C 945  LEU HD13', -0.413, (237.559, 205.147, 194.835)), (' A 452  ARG  HG3', ' A 494  SER  HA ', -0.413, (206.989, 186.974, 276.328)), (' B 878  LEU  HA ', ' B 881  THR HG22', -0.413, (190.873, 207.423, 177.372)), (' A 173  GLN  NE2', ' A 174  PRO  HD2', -0.412, (191.911, 266.155, 244.738)), (' B 387  LEU  HA ', ' B 387  LEU HD23', -0.412, (227.366, 195.968, 252.948)), (' A  97  LYS  HB2', ' A  97  LYS  HE2', -0.412, (173.467, 266.004, 235.257)), (' A 201  PHE  HB3', ' A 229  LEU  HB2', -0.412, (190.292, 247.934, 248.158)), (' B 560  LEU  O  ', ' B 562  PHE  N  ', -0.412, (251.016, 196.898, 236.363)), (' C  64  TRP  CH2', ' C 214  ARG  HD2', -0.411, (271.319, 226.087, 232.34)), (' B 928  ASN  O  ', ' B 931  ILE HG22', -0.41, (190.542, 191.068, 174.828)), (' B 560  LEU HD23', ' B 562  PHE  HE1', -0.41, (251.492, 200.928, 233.883)), (' C 966  LEU  HA ', ' C 966  LEU HD23', -0.41, (223.394, 202.619, 227.81)), (' C 988  GLU  O  ', ' C 992  GLN  HG2', -0.41, (216.815, 202.915, 242.974)), (' A 985  ASP  N  ', ' A 985  ASP  OD1', -0.41, (216.46, 224.949, 248.849)), (' B 497  PHE  CE2', ' B 507  PRO  HB3', -0.41, (225.749, 214.049, 276.679)), (' B 766  ALA  O  ', ' B 770  ILE HG12', -0.41, (199.534, 216.169, 209.423)), (' B 170  TYR  CE1', ' B 172  SER  HB2', -0.409, (178.092, 175.098, 249.12)), (' A 971  GLY  HA2', ' B 755  GLN  NE2', -0.408, (203.658, 220.764, 236.856)), (' B 422  ASN  OD1', ' B 454  ARG  N  ', -0.407, (229.878, 222.799, 268.161)), (' C 344  ALA  HB3', ' C 347  PHE  CE1', -0.407, (202.028, 238.503, 271.393)), (' B 331  ASN  HB2', ' B2002  NAG  H2 ', -0.407, (246.681, 184.369, 249.897)), (' A 456  PHE  HB2', ' A 491  PRO  HA ', -0.407, (214.449, 182.978, 269.945)), (' C 341  VAL HG13', ' C 342  PHE  HD1', -0.406, (205.533, 238.535, 265.836)), (' A 864  LEU HD12', ' C 667  GLY  HA2', -0.406, (229.549, 231.528, 202.05)), (' A 713  ALA  HA ', ' A1073  LYS  O  ', -0.406, (188.823, 219.217, 161.45)), (' C  64  TRP  HE1', ' C 264  ALA  HB1', -0.406, (270.349, 223.248, 236.85)), (' A 894  LEU  HB3', ' C 713  ALA  HB3', -0.406, (228.929, 228.415, 166.447)), (' A 476  GLY  N  ', ' A 487  ASN  HB3', -0.406, (225.348, 179.193, 269.928)), (' A 563  GLN  HG2', ' B  43  PHE  HB2', -0.405, (181.218, 187.403, 231.324)), (' A 393  THR  HB ', ' A 522  ALA  HA ', -0.405, (182.694, 192.451, 247.263)), (' B 417  LYS  HA ', ' B 417  LYS  HD3', -0.405, (223.928, 225.452, 264.57)), (' A 928  ASN  O  ', ' A 931  ILE HG22', -0.405, (204.824, 240.861, 175.55)), (' B 437  ASN  HA ', ' B 508  TYR  CD1', -0.404, (221.442, 207.323, 274.126)), (' C 938  LEU  HA ', ' C 938  LEU HD12', -0.404, (239.663, 206.736, 190.479)), (' A1090  PRO  HD3', ' A1095  PHE  CE2', -0.404, (198.34, 208.549, 152.669)), (' A 663  ASP  N  ', ' A 663  ASP  OD1', -0.403, (184.034, 226.85, 196.401)), (' A 119  ILE HG23', ' A 128  ILE HG13', -0.403, (187.028, 255.631, 249.867)), (' A1106  GLN HE21', ' A1109  PHE  HB3', -0.403, (201.122, 223.088, 158.92)), (' C 403  ARG  NH1', ' C 405  ASP  OD2', -0.402, (198.543, 216.132, 273.38)), (' B 212  LEU HD23', ' B 213  VAL  N  ', -0.402, (187.205, 154.544, 224.733)), (' B 358  ILE  HA ', ' B 358  ILE HD13', -0.402, (241.015, 200.224, 259.923)), (' C 417  LYS  O  ', ' C 421  TYR  HB2', -0.401, (189.913, 220.571, 263.706)), (' A 977  LEU  HA ', ' A 980  ILE HG22', -0.401, (214.914, 228.344, 238.025)), (' A 722  VAL  HA ', ' A1064  HIS  O  ', -0.4, (204.675, 230.803, 178.314)), (' B 375  SER  HB3', ' B 436  TRP  HA ', -0.4, (220.734, 204.226, 270.142)), (' C 640  SER  OG ', ' C 641  ASN  N  ', -0.4, (246.655, 239.241, 211.002))]
handle_read_draw_probe_dots_unformatted("molprobity_probe.txt", 0, 0)
show_probe_dots(True, True)
gui = coot_molprobity_todo_list_gui(data=data)
