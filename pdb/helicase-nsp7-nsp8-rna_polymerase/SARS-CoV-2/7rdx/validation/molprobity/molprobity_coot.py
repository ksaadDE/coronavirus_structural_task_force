# script auto-generated by phenix.molprobity


from __future__ import absolute_import, division, print_function
from six.moves import cPickle as pickle
from six.moves import range
try :
  import gobject
except ImportError :
  gobject = None
import sys

class coot_extension_gui(object):
  def __init__(self, title):
    import gtk
    self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)
    scrolled_win = gtk.ScrolledWindow()
    self.outside_vbox = gtk.VBox(False, 2)
    self.inside_vbox = gtk.VBox(False, 0)
    self.window.set_title(title)
    self.inside_vbox.set_border_width(0)
    self.window.add(self.outside_vbox)
    self.outside_vbox.pack_start(scrolled_win, True, True, 0)
    scrolled_win.add_with_viewport(self.inside_vbox)
    scrolled_win.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)

  def finish_window(self):
    import gtk
    self.outside_vbox.set_border_width(2)
    ok_button = gtk.Button("  Close  ")
    self.outside_vbox.pack_end(ok_button, False, False, 0)
    ok_button.connect("clicked", lambda b: self.destroy_window())
    self.window.connect("delete_event", lambda a, b: self.destroy_window())
    self.window.show_all()

  def destroy_window(self, *args):
    self.window.destroy()
    self.window = None

  def confirm_data(self, data):
    for data_key in self.data_keys :
      outlier_list = data.get(data_key)
      if outlier_list is not None and len(outlier_list) > 0 :
        return True
    return False

  def create_property_lists(self, data):
    import gtk
    for data_key in self.data_keys :
      outlier_list = data[data_key]
      if outlier_list is None or len(outlier_list) == 0 :
        continue
      else :
        frame = gtk.Frame(self.data_titles[data_key])
        vbox = gtk.VBox(False, 2)
        frame.set_border_width(6)
        frame.add(vbox)
        self.add_top_widgets(data_key, vbox)
        self.inside_vbox.pack_start(frame, False, False, 5)
        list_obj = residue_properties_list(
          columns=self.data_names[data_key],
          column_types=self.data_types[data_key],
          rows=outlier_list,
          box=vbox)

# Molprobity result viewer
class coot_molprobity_todo_list_gui(coot_extension_gui):
  data_keys = [ "rama", "rota", "cbeta", "probe" ]
  data_titles = { "rama"  : "Ramachandran outliers",
                  "rota"  : "Rotamer outliers",
                  "cbeta" : "C-beta outliers",
                  "probe" : "Severe clashes" }
  data_names = { "rama"  : ["Chain", "Residue", "Name", "Score"],
                 "rota"  : ["Chain", "Residue", "Name", "Score"],
                 "cbeta" : ["Chain", "Residue", "Name", "Conf.", "Deviation"],
                 "probe" : ["Atom 1", "Atom 2", "Overlap"] }
  if (gobject is not None):
    data_types = { "rama" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "rota" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "cbeta" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT],
                   "probe" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT] }
  else :
    data_types = dict([ (s, []) for s in ["rama","rota","cbeta","probe"] ])

  def __init__(self, data_file=None, data=None):
    assert ([data, data_file].count(None) == 1)
    if (data is None):
      data = load_pkl(data_file)
    if not self.confirm_data(data):
      return
    coot_extension_gui.__init__(self, "MolProbity to-do list")
    self.dots_btn = None
    self.dots2_btn = None
    self._overlaps_only = True
    self.window.set_default_size(420, 600)
    self.create_property_lists(data)
    self.finish_window()

  def add_top_widgets(self, data_key, box):
    import gtk
    if data_key == "probe" :
      hbox = gtk.HBox(False, 2)
      self.dots_btn = gtk.CheckButton("Show Probe dots")
      hbox.pack_start(self.dots_btn, False, False, 5)
      self.dots_btn.connect("toggled", self.toggle_probe_dots)
      self.dots2_btn = gtk.CheckButton("Overlaps only")
      hbox.pack_start(self.dots2_btn, False, False, 5)
      self.dots2_btn.connect("toggled", self.toggle_all_probe_dots)
      self.dots2_btn.set_active(True)
      self.toggle_probe_dots()
      box.pack_start(hbox, False, False, 0)

  def toggle_probe_dots(self, *args):
    if self.dots_btn is not None :
      show_dots = self.dots_btn.get_active()
      overlaps_only = self.dots2_btn.get_active()
      if show_dots :
        self.dots2_btn.set_sensitive(True)
      else :
        self.dots2_btn.set_sensitive(False)
      show_probe_dots(show_dots, overlaps_only)

  def toggle_all_probe_dots(self, *args):
    if self.dots2_btn is not None :
      self._overlaps_only = self.dots2_btn.get_active()
      self.toggle_probe_dots()

class rsc_todo_list_gui(coot_extension_gui):
  data_keys = ["by_res", "by_atom"]
  data_titles = ["Real-space correlation by residue",
                 "Real-space correlation by atom"]
  data_names = {}
  data_types = {}

class residue_properties_list(object):
  def __init__(self, columns, column_types, rows, box,
      default_size=(380,200)):
    assert len(columns) == (len(column_types) - 1)
    if (len(rows) > 0) and (len(rows[0]) != len(column_types)):
      raise RuntimeError("Wrong number of rows:\n%s" % str(rows[0]))
    import gtk
    self.liststore = gtk.ListStore(*column_types)
    self.listmodel = gtk.TreeModelSort(self.liststore)
    self.listctrl = gtk.TreeView(self.listmodel)
    self.listctrl.column = [None]*len(columns)
    self.listctrl.cell = [None]*len(columns)
    for i, column_label in enumerate(columns):
      cell = gtk.CellRendererText()
      column = gtk.TreeViewColumn(column_label)
      self.listctrl.append_column(column)
      column.set_sort_column_id(i)
      column.pack_start(cell, True)
      column.set_attributes(cell, text=i)
    self.listctrl.get_selection().set_mode(gtk.SELECTION_SINGLE)
    for row in rows :
      self.listmodel.get_model().append(row)
    self.listctrl.connect("cursor-changed", self.OnChange)
    sw = gtk.ScrolledWindow()
    w, h = default_size
    if len(rows) > 10 :
      sw.set_size_request(w, h)
    else :
      sw.set_size_request(w, 30 + (20 * len(rows)))
    sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
    box.pack_start(sw, False, False, 5)
    inside_vbox = gtk.VBox(False, 0)
    sw.add(self.listctrl)

  def OnChange(self, treeview):
    import coot # import dependency
    selection = self.listctrl.get_selection()
    (model, tree_iter) = selection.get_selected()
    if tree_iter is not None :
      row = model[tree_iter]
      xyz = row[-1]
      if isinstance(xyz, tuple) and len(xyz) == 3 :
        set_rotation_centre(*xyz)
        set_zoom(30)
        graphics_draw()

def show_probe_dots(show_dots, overlaps_only):
  import coot # import dependency
  n_objects = number_of_generic_objects()
  sys.stdout.flush()
  if show_dots :
    for object_number in range(n_objects):
      obj_name = generic_object_name(object_number)
      if overlaps_only and not obj_name in ["small overlap", "bad overlap"] :
        sys.stdout.flush()
        set_display_generic_object(object_number, 0)
      else :
        set_display_generic_object(object_number, 1)
  else :
    sys.stdout.flush()
    for object_number in range(n_objects):
      set_display_generic_object(object_number, 0)

def load_pkl(file_name):
  pkl = open(file_name, "rb")
  data = pickle.load(pkl)
  pkl.close()
  return data

data = {}
data['rama'] = [('E', ' 189 ', 'LYS', 0.0022538113201144923, (168.5699999999999, 188.17, 129.524))]
data['omega'] = [('A', ' 505 ', 'PRO', None, (164.71799999999996, 163.897, 178.574)), ('A', ' 760 ', 'ASP', None, (177.761, 176.343, 201.211)), ('B', ' 183 ', 'PRO', None, (184.73, 146.844, 182.09500000000003)), ('D', ' 183 ', 'PRO', None, (212.889, 141.235, 161.998)), ('F', '  81 ', 'PHE', None, (153.332, 203.92, 162.376))]
data['rota'] = []
data['cbeta'] = []
data['probe'] = [(' A  77  PHE  HE1', ' A  81  GLN HE21', -0.896, (159.707, 153.658, 256.215)), (' E 328  ASP  O  ', ' E 347  LYS  NZ ', -0.873, (194.198, 137.002, 155.631)), (' F 519  ASN  OD1', ' F 530  THR  OG1', -0.865, (109.919, 153.472, 143.33)), (' P  25    C  O2 ', ' T  31    G  N2 ', -0.832, (167.621, 200.427, 177.456)), (' E 303  ARG  NH2', ' E 351  THR  O  ', -0.828, (196.617, 146.99, 155.558)), (' F 332  ARG  NH1', ' F 333  ILE  O  ', -0.816, (139.093, 149.278, 151.43)), (' B 120  ILE  O  ', ' B 124  THR  OG1', -0.783, (158.251, 145.531, 182.11)), (' E 282  GLY  O  ', ' E 288  LYS  NZ ', -0.779, (206.645, 145.839, 130.492)), (' E 300  PRO  O  ', ' E 354  GLN  NE2', -0.768, (206.417, 140.559, 155.173)), (' E 438  LEU  O  ', ' E 438  LEU HD12', -0.753, (211.525, 142.456, 131.65)), (' E 176  LEU HD22', ' E 201  GLU  HB3', -0.745, (171.824, 164.361, 147.072)), (' D 176  ASN  OD1', ' D 179  ASN  ND2', -0.744, (223.773, 132.126, 160.261)), (' E 448  ILE  O  ', ' E 451  THR  OG1', -0.742, (204.407, 139.574, 117.449)), (' E 332  ARG  NH1', ' E 333  ILE  O  ', -0.742, (189.148, 146.85, 146.371)), (' A 387  LEU HD23', ' B 128  LEU HD12', -0.74, (166.965, 141.635, 183.666)), (' F 489  ASN  O  ', ' F 518  GLN  NE2', -0.74, (102.186, 159.984, 139.072)), (' F 420  GLU  OE2', ' F 431  THR  OG1', -0.739, (137.024, 171.999, 127.718)), (' E 286  THR  N  ', ' E 704  ADP  O1B', -0.736, (206.449, 141.482, 130.705)), (' E 443  ARG  NH2', ' E 704  ADP  O1A', -0.734, (201.983, 139.724, 132.986)), (' E 185  TYR  O  ', ' E 187  VAL HG13', -0.733, (170.364, 179.831, 132.347)), (' A 676  LYS  NZ ', ' A 678  GLY  O  ', -0.717, (170.424, 161.884, 196.54)), (' A 242  MET  SD ', ' A 463  MET  HE2', -0.709, (162.82, 159.241, 215.551)), (' A 720  VAL HG11', ' A 775  LEU HD23', -0.699, (175.815, 179.803, 228.562)), (' A 758  LEU HD23', ' A 813  CYS  SG ', -0.699, (181.574, 182.038, 198.698)), (' F 159  SER  OG ', ' F 162  GLU  O  ', -0.699, (111.613, 147.953, 161.653)), (' D  50  ASP  OD2', " P  19    A  O2'", -0.697, (180.107, 217.212, 167.11)), (' A 409  THR  OG1', ' C  23  GLU  OE2', -0.696, (186.976, 160.325, 176.653)), (' A 915  TYR  O  ', ' A 921  TYR  OH ', -0.691, (195.54, 194.424, 182.805)), (' E 228  THR  O  ', ' E 228  THR HG22', -0.678, (181.878, 175.311, 134.834)), (' C  54  SER  HB2', ' D 122  LEU HD21', -0.677, (207.164, 153.42, 183.613)), (' E 328  ASP  OD1', ' E 329  LYS  N  ', -0.667, (197.755, 134.179, 154.991)), (' E 441  CYS  HB2', ' E 449  VAL HG21', -0.665, (208.822, 138.994, 123.93)), (' C  50  GLU  HG2', ' D 122  LEU HD22', -0.657, (208.741, 153.628, 185.418)), (' F   7  LEU HD21', ' F  29  CYS  SG ', -0.655, (148.345, 186.379, 145.398)), (' F 585  LEU  O  ', ' F 585  LEU HD12', -0.648, (111.052, 158.444, 122.291)), (' F 322  LEU HD11', ' F 343  PHE  CZ ', -0.646, (133.466, 138.714, 146.608)), (' D 134  ASP  OD1', ' D 135  TYR  N  ', -0.638, (221.245, 144.453, 162.937)), (' E 200  PHE  HB3', ' E 209  VAL HG21', -0.636, (168.195, 167.264, 143.406)), (' E  26  CYS  SG ', ' E  27  CYS  N  ', -0.635, (200.702, 188.069, 145.886)), (' F 322  LEU HD11', ' F 343  PHE  HZ ', -0.634, (133.579, 138.394, 146.783)), (' A 340  PHE  CE1', ' B  95  LEU HD11', -0.631, (151.077, 156.625, 172.966)), (' F 248  ARG  NH1', ' F 249  ILE  O  ', -0.624, (159.248, 150.262, 130.001)), (' A 612  PRO  CG ', ' A 805  LEU HD11', -0.615, (186.695, 189.441, 217.019)), (' F 363  LEU  O  ', ' F 390  ARG  NH1', -0.612, (144.457, 158.276, 152.897)), (' F 549  THR HG22', ' F 550  THR HG23', -0.61, (105.829, 166.838, 138.633)), (' A 478  LYS  NZ ', ' A 743  ASN  OD1', -0.609, (161.908, 185.924, 216.099)), (' E 451  THR HG22', ' E 586  GLN  H  ', -0.607, (205.128, 139.472, 113.342)), (' E 554  HIS  O  ', ' E 560  ARG  NE ', -0.605, (193.956, 153.725, 119.434)), (' E 296  ALA  HB2', ' E 306  TYR  OH ', -0.6, (205.24, 141.785, 147.273)), (' A 568  ASN  OD1', ' A 654  ARG  NH2', -0.599, (159.239, 173.121, 192.011)), (' A  72  VAL  O  ', ' A  72  VAL HG12', -0.597, (172.903, 149.918, 247.558)), (' A 875  GLN  NE2', ' A 879  ASP  OD1', -0.595, (207.677, 190.741, 193.038)), (' F   7  LEU  H  ', ' F   7  LEU HD23', -0.595, (148.058, 183.929, 145.618)), (' F  96  THR  O  ', ' F  96  THR HG22', -0.595, (159.726, 187.303, 146.922)), (' E 376  ILE HD11', ' E 429  MET  HE1', -0.59, (206.955, 154.908, 134.263)), (' A 676  LYS  NZ ', ' A 679  GLY  O  ', -0.588, (170.044, 163.424, 196.122)), (' E 163  LEU  N  ', ' E 209  VAL  O  ', -0.582, (163.835, 170.226, 146.488)), (' E 501  THR  O  ', ' E 507  ARG  NH2', -0.579, (185.655, 124.295, 116.12)), (' E 240  LEU HD21', ' E 425  VAL HG22', -0.578, (206.739, 159.578, 140.19)), (' E 375  GLU  OE2', ' E 706  AF3  F3 ', -0.578, (201.669, 145.93, 133.597)), (' A 340  PHE  HE1', ' B  95  LEU HD11', -0.576, (151.59, 156.61, 172.71)), (' E 214  THR  O  ', ' E 214  THR HG22', -0.576, (176.584, 180.244, 148.371)), (' A  57  GLN  NE2', ' A  66  ILE  O  ', -0.573, (181.152, 141.973, 234.484)), (' A 912  THR  O  ', ' A 912  THR HG22', -0.57, (195.939, 197.257, 176.431)), (' A 335  VAL  O  ', ' A 338  VAL HG12', -0.568, (146.413, 156.848, 171.353)), (' F 563  VAL  O  ', ' F 567  ARG  NH1', -0.565, (121.495, 153.977, 134.263)), (' A 473  VAL HG22', ' A 633  MET  SD ', -0.563, (163.583, 172.509, 209.592)), (' E 365  GLU  OE2', ' E 390  ARG  NH1', -0.563, (192.715, 160.142, 151.673)), (' F 258  ILE HG23', ' F 259  SER  N  ', -0.562, (145.416, 138.013, 127.154)), (' E 201  GLU  C  ', ' E 209  VAL HG23', -0.56, (168.026, 165.327, 145.408)), (' B 159  VAL HG22', ' B 186  VAL HG12', -0.559, (178.484, 138.731, 178.329)), (' E   5  CYS  SG ', ' E  26  CYS  N  ', -0.558, (199.099, 184.477, 145.423)), (' D 175  ASP  OD1', ' D 176  ASN  N  ', -0.557, (227.793, 134.59, 162.324)), (' E 376  ILE HD11', ' E 429  MET  CE ', -0.556, (207.052, 155.123, 134.443)), (' F 235  LEU  H  ', ' F 235  LEU HD23', -0.555, (144.392, 171.661, 150.725)), (' E 147  LEU  O  ', ' E 147  LEU HD12', -0.555, (180.121, 163.682, 132.852)), (' E 154  VAL HG21', ' E 163  LEU HD11', -0.553, (163.619, 174.947, 142.692)), (' A 840  ALA  O  ', ' A 858  ARG  NH2', -0.553, (193.101, 179.447, 182.12)), (' A 254  GLU  OE1', ' A 285  ARG  NH2', -0.552, (156.943, 143.831, 212.827)), (' E 447  GLU  O  ', ' E 451  THR HG23', -0.549, (205.751, 137.669, 115.956)), (' B 171  GLU  O  ', ' B 176  ASN  ND2', -0.549, (189.686, 135.122, 177.698)), (' E 515  TYR  O  ', ' E 519  ASN  ND2', -0.549, (185.345, 146.872, 122.48)), (' E 456  VAL HG23', ' E 457  TYR  CD2', -0.547, (208.257, 147.546, 121.526)), (' E 409  ARG  NH2', ' E 422  PHE  O  ', -0.546, (200.059, 161.986, 131.735)), (' E 576  MET  HE1', ' E 585  LEU HD21', -0.541, (198.168, 142.711, 110.578)), (' A 331  ARG  NH2', ' B 114  CYS  SG ', -0.54, (146.261, 154.571, 189.624)), (' D 173  SER  O  ', ' D 177  SER  N  ', -0.538, (225.27, 137.132, 163.178)), (' F 518  GLN  OE1', ' F 549  THR  OG1', -0.536, (105.545, 161.84, 139.429)), (' A1006  1N7  H31', ' A1006  1N7  H5 ', -0.534, (145.768, 158.381, 227.853)), (" T   9    A  O2'", " T  10    U  O5'", -0.532, (184.286, 163.356, 140.993)), (' A 503  GLY  O  ', ' A 507  ASN  ND2', -0.532, (168.852, 166.145, 177.754)), (' E  18  ALA  HB3', ' E  39  HIS  CG ', -0.53, (189.746, 183.826, 134.479)), (' E 280  LEU  HB3', ' E 399  ILE HG22', -0.53, (209.18, 148.474, 138.194)), (' A 904  SER  CB ', ' E 707  1N7  H51', -0.528, (198.798, 199.268, 153.529)), (' F  80  SER  HB3', ' F  81  PHE  HB3', -0.527, (154.202, 205.834, 160.48)), (' F 492  GLN  NE2', ' F 548  GLN  O  ', -0.527, (104.518, 162.131, 134.552)), (' A 326  PHE  O  ', ' B 118  ASN  ND2', -0.525, (160.364, 152.496, 192.571)), (' F 105  ASP  OD1', ' F 106  PHE  N  ', -0.525, (140.805, 185.495, 140.726)), (' A 116  ARG  NH2', ' A1004  ADP  O3B', -0.522, (169.859, 152.83, 240.698)), (' A 341  VAL  O  ', ' A 341  VAL HG13', -0.522, (154.398, 154.519, 180.301)), (' E  59  ASP  OD1', ' E  61  THR HG22', -0.521, (189.933, 195.621, 134.919)), (' A 629  MET  HA ', ' A 629  MET  HE3', -0.521, (163.743, 164.893, 206.615)), (' D 155  GLU  HA ', ' D 155  GLU  OE1', -0.52, (219.272, 140.322, 181.903)), (' A 445  ASP  N  ', ' A 445  ASP  OD1', -0.52, (188.785, 157.264, 183.787)), (' A 904  SER  HB3', ' E 707  1N7  H53', -0.519, (199.797, 200.59, 154.852)), (' A 686  THR  O  ', ' A 686  THR HG23', -0.517, (167.392, 174.146, 195.52)), (' E 154  VAL HG21', ' E 163  LEU  CD1', -0.516, (163.623, 174.437, 142.67)), (' E 441  CYS  CB ', ' E 449  VAL HG21', -0.514, (208.824, 138.369, 124.367)), (' A  77  PHE  CE1', ' A  81  GLN  NE2', -0.514, (159.489, 154.97, 256.187)), (' A 858  ARG  NH1', ' P  32    G  OP1', -0.513, (189.463, 180.802, 180.06)), (' A 691  ASN  HB3', ' A 759  SER  O  ', -0.513, (175.162, 174.184, 200.415)), (' E 165  LEU HD21', ' E 167  TRP  NE1', -0.51, (167.157, 165.349, 137.857)), (' E 121  ILE HG22', ' E 421  TYR  CD2', -0.508, (204.665, 166.618, 125.917)), (' F 228  THR  O  ', ' F 228  THR HG23', -0.506, (129.233, 164.379, 157.944)), (' A  28  THR HG21', ' A  51  THR  O  ', -0.504, (177.454, 157.719, 245.909)), (' F 480  ILE HD13', ' F 550  THR HG22', -0.503, (104.478, 168.698, 137.872)), (' E  79  ILE  O  ', ' E  79  ILE HG23', -0.503, (186.594, 208.257, 150.659)), (' E 456  VAL HG21', ' E 562  ASN  ND2', -0.503, (204.734, 147.497, 121.964)), (' F 107  ASN  O  ', ' F 111  THR HG22', -0.501, (134.765, 186.623, 145.756)), (' F 178  ARG  NH2', ' F 534  ASP  O  ', -0.501, (122.103, 154.39, 142.896)), (' A 279  ARG  NH1', ' A 318  SER  OG ', -0.499, (158.077, 154.472, 204.654)), (' B  53  ALA  O  ', ' B  54  ALA  HB3', -0.499, (163.523, 214.42, 161.889)), (' A 720  VAL HG11', ' A 775  LEU  CD2', -0.495, (176.433, 179.406, 229.106)), (' E 120  TYR  CE2', ' E 138  LEU HD11', -0.494, (194.933, 166.948, 130.532)), (' E 554  HIS  O  ', ' E 560  ARG  NH2', -0.493, (193.706, 154.548, 119.059)), (' A 350  GLU  OE2', ' A 628  ASN  ND2', -0.493, (164.874, 160.458, 201.156)), (' F 283  PRO  HB2', ' F 461  LEU HD21', -0.492, (127.184, 153.999, 125.589)), (' F 311  HIS  HA ', ' F 314  VAL HG12', -0.49, (132.429, 151.308, 147.018)), (' F  37  THR  O  ', ' F  40  LYS  NZ ', -0.49, (137.065, 195.56, 151.424)), (' A 372  LEU HD12', ' A 506  PHE  CE1', -0.488, (159.704, 168.315, 177.102)), (' F 585  LEU HD13', ' F 587  PHE  CE2', -0.488, (111.679, 156.497, 124.207)), (' B 159  VAL HG13', ' B 186  VAL HG12', -0.488, (179.422, 139.184, 178.286)), (' T  37    U  C2 ', ' T  38    G  C8 ', -0.485, (176.483, 221.415, 174.934)), (' F   5  CYS  SG ', ' F  26  CYS  N  ', -0.482, (150.459, 186.275, 149.264)), (' F 272  VAL HG11', ' F 295  LEU HD21', -0.481, (146.453, 151.45, 131.845)), (' E 126  CYS  O  ', ' E 131  LYS  NZ ', -0.479, (207.541, 170.344, 136.694)), (' E 296  ALA  HB1', ' E 355  TYR  HE1', -0.479, (204.686, 140.685, 149.901)), (' A 629  MET  CA ', ' A 629  MET  HE3', -0.478, (163.992, 165.355, 206.635)), (' A 572  HIS  HB3', ' A 576  LEU HD13', -0.478, (163.575, 180.227, 195.622)), (' E 449  VAL HG11', ' E 463  ALA  HB2', -0.477, (209.6, 136.713, 121.941)), (' A 851  ASP  OD1', ' D  75  ARG  NH2', -0.475, (197.662, 183.471, 167.807)), (' F 214  THR  OG1', ' F 339  ARG  O  ', -0.474, (128.0, 152.287, 158.749)), (' E 321  ALA  O  ', ' E 325  LEU  N  ', -0.473, (201.208, 134.183, 147.018)), (' A 612  PRO  CB ', ' A 805  LEU HD11', -0.473, (186.697, 188.946, 216.795)), (' A 116  ARG  NH1', ' A1004  ADP  O3B', -0.473, (168.743, 152.846, 240.458)), (' A 749  LEU  O  ', ' A 753  PHE  N  ', -0.473, (176.331, 183.887, 217.951)), (' A 695  ASN HD21', ' A 762  ALA  HB2', -0.473, (178.657, 177.339, 206.437)), (' F1003  ADP  O3B', ' F1005  AF3  F1 ', -0.472, (127.556, 149.675, 133.304)), (' A  77  PHE  HE1', ' A  81  GLN  NE2', -0.471, (159.042, 154.41, 256.43)), (' A 531  THR  O  ', ' A 657  ASN  ND2', -0.47, (153.739, 169.838, 191.656)), (' E 260  ASP  OD1', ' E 261  GLU  N  ', -0.47, (212.215, 129.607, 141.499)), (' F 489  ASN  HB2', ' F 549  THR HG23', -0.468, (103.736, 164.532, 139.264)), (' E  13  SER  O  ', ' E  13  SER  OG ', -0.467, (191.358, 187.089, 150.693)), (' E 451  THR HG21', ' E 587  PHE  CE1', -0.467, (202.503, 138.322, 115.221)), (' E 449  VAL  HA ', ' E 452  VAL HG12', -0.466, (206.175, 140.521, 120.465)), (' E 249  ILE HD11', ' E 270  GLN  NE2', -0.466, (220.652, 145.207, 150.357)), (" P  24    C  O2'", ' P  25    C  P  ', -0.466, (169.991, 201.911, 185.765)), (' E 148  SER  OG ', ' E 149  TYR  N  ', -0.465, (176.853, 167.456, 130.953)), (' E 518  GLN  OE1', ' E 549  THR  OG1', -0.465, (185.843, 146.759, 116.727)), (' F 303  ARG  NH2', ' F 351  THR  O  ', -0.465, (150.154, 148.347, 149.652)), (' E 308  ALA  HB3', ' E 314  VAL HG13', -0.464, (195.498, 148.38, 140.327)), (' E 507  ARG  O  ', ' E 528  LEU HD21', -0.463, (185.508, 130.753, 124.021)), (' F 258  ILE HD11', ' F 297  LEU  HB3', -0.463, (146.402, 139.378, 132.79)), (" P  24    C HO2'", ' P  25    C  P  ', -0.463, (170.045, 202.048, 186.302)), (' E 116  ASN  OD1', ' E 117  ALA  N  ', -0.459, (197.666, 170.536, 122.073)), (' A 162  TRP  O  ', ' A 171  ILE HD13', -0.459, (184.469, 151.827, 212.948)), (' D  95  LEU HD21', ' D 107  ILE HD11', -0.459, (210.135, 161.819, 173.763)), (' B 137  THR  O  ', ' B 141  THR HG22', -0.459, (179.097, 137.827, 188.048)), (' E 576  MET  HE1', ' E 585  LEU  CD2', -0.459, (198.82, 142.778, 110.99)), (' C  14  LEU HD22', ' C  36  HIS  CG ', -0.458, (196.96, 162.678, 181.525)), (' E 228  THR  CG2', ' E 228  THR  O  ', -0.458, (181.069, 175.489, 134.686)), (' E 464  HIS  O  ', ' E 465  LYS  HG3', -0.458, (209.637, 132.288, 126.169)), (' F 509  ALA  HB1', ' F 545  ILE HG12', -0.458, (107.075, 148.234, 135.27)), (' A 726  ARG  NH2', ' A 744  GLU  OE2', -0.458, (165.795, 183.22, 228.581)), (' E 255  THR HG22', ' E 256  LEU  N  ', -0.457, (215.968, 134.406, 152.565)), (' F 448  ILE HG22', ' F 587  PHE  CE1', -0.457, (113.979, 153.784, 122.771)), (' A 231  VAL  O  ', ' A 231  VAL HG13', -0.457, (151.854, 159.411, 232.627)), (' B  59  LEU  C  ', ' B  59  LEU HD23', -0.456, (159.454, 203.66, 160.433)), (' E 509  ALA  O  ', ' E 528  LEU HD22', -0.455, (187.054, 133.204, 125.496)), (' F 158  LEU  HB2', ' F 163  LEU HD13', -0.455, (112.394, 150.778, 164.785)), (' A  28  THR HG21', ' A  51  THR  C  ', -0.454, (177.713, 157.241, 245.807)), (' F 588  THR HG22', ' F 590  LEU  H  ', -0.454, (102.336, 154.038, 119.484)), (' C  58  VAL HG22', ' D 119  ILE HG12', -0.453, (201.358, 152.311, 176.723)), (' A 316  LEU HD22', ' A 463  MET  SD ', -0.452, (163.325, 155.679, 213.261)), (' E 446  ALA  HA ', ' E 449  VAL HG12', -0.451, (208.093, 135.93, 120.872)), (' F 552  THR  OG1', ' F 553  ALA  N  ', -0.451, (112.408, 172.055, 135.923)), (' A 149  TYR  HE2', ' A 212  LEU HD13', -0.45, (175.858, 147.58, 226.044)), (' F 212  ARG  NH1', ' F 339  ARG  O  ', -0.45, (127.556, 151.773, 157.332)), (' E 358  CYS  SG ', ' E 359  THR  N  ', -0.45, (192.772, 150.536, 145.722)), (' F 255  THR HG21', ' F 258  ILE HD13', -0.45, (148.702, 138.861, 131.388)), (' F 274  MET  HA ', ' F 274  MET  HE2', -0.45, (154.107, 154.225, 126.74)), (' E 249  ILE HD11', ' E 270  GLN HE22', -0.45, (220.797, 144.811, 150.741)), (' A 665  GLU  N  ', ' A 665  GLU  OE1', -0.449, (165.909, 161.665, 192.46)), (' E 449  VAL HG22', ' E 461  LEU HD22', -0.449, (209.509, 140.87, 122.292)), (' F 216  THR  O  ', ' F 216  THR HG22', -0.448, (124.23, 144.871, 167.34)), (' F 466  ASP  OD1', ' F 467  LYS  N  ', -0.447, (115.61, 144.418, 116.798)), (' F 456  VAL HG23', ' F 457  TYR  N  ', -0.447, (125.992, 161.155, 124.404)), (' A 494  ILE HD11', ' A 577  LYS  HE2', -0.447, (166.664, 187.788, 188.059)), (' F 283  PRO  O  ', ' F 286  THR HG23', -0.446, (129.583, 151.649, 128.156)), (' A  15  SER  OG ', ' A 118  ARG  NH2', -0.445, (170.102, 136.315, 240.976)), (' A 824  ASP  N  ', ' A 824  ASP  OD1', -0.445, (192.909, 206.623, 204.039)), (' E  12  THR HG21', ' E  25  LEU  O  ', -0.445, (197.197, 184.822, 147.709)), (' E 474  MET  HE1', ' E 495  VAL HG11', -0.445, (186.435, 136.0, 108.81)), (' F 192  LYS  HG2', ' F 192  LYS  O  ', -0.444, (128.523, 162.964, 171.7)), (' A 338  VAL  CG2', ' B  95  LEU HD13', -0.442, (150.396, 153.958, 171.707)), (' A 293  THR HG22', ' A 294  TYR  N  ', -0.441, (148.842, 161.145, 213.618)), (' A 775  LEU  N  ', ' A 775  LEU HD12', -0.44, (179.017, 176.757, 227.912)), (' E   7  LEU HD11', ' E  29  CYS  SG ', -0.44, (203.054, 184.629, 142.014)), (' F 486  SER  OG ', ' F 487  ALA  N  ', -0.44, (108.056, 165.524, 145.119)), (' F  15  ARG  HE ', ' F  24  PHE  HE1', -0.439, (148.202, 180.546, 157.29)), (' B 160  VAL HG12', ' B 166  ILE HD13', -0.439, (179.63, 142.161, 171.662)), (' A 338  VAL HG22', ' B  95  LEU HD13', -0.438, (150.344, 153.985, 171.872)), (' F 258  ILE HG23', ' F 259  SER  H  ', -0.436, (145.642, 137.524, 127.035)), (' A 501  SER  OG ', ' T  19    A  OP1', -0.436, (172.037, 169.654, 178.606)), (' A 382  ALA  HB3', ' B 117  LEU HD11', -0.436, (160.04, 153.088, 183.999)), (' A 702  ALA  HA ', ' A 785  VAL HG21', -0.434, (175.6, 170.266, 216.719)), (' D 171  GLU  O  ', ' D 176  ASN  ND2', -0.433, (223.471, 132.986, 164.611)), (' E 474  MET  HE1', ' E 495  VAL  CG1', -0.432, (186.596, 135.504, 108.654)), (' B 141  THR HG23', ' B 142  CYS  N  ', -0.432, (176.752, 136.945, 186.541)), (' P  25    C  N3 ', ' T  31    G  N1 ', -0.431, (169.831, 200.343, 177.348)), (' A 153  ASP  O  ', ' A 154  ASP  HB3', -0.431, (189.055, 142.646, 220.973)), (' B  59  LEU HD12', ' F  80  SER  HB2', -0.431, (155.859, 206.898, 161.321)), (' A  31  VAL HG22', ' A  32  TYR  N  ', -0.431, (180.902, 156.811, 236.19)), (' E 405  LEU HD23', ' E 563  VAL HG11', -0.431, (196.385, 149.256, 125.624)), (' P  26    U  C2 ', ' P  27    A  C8 ', -0.43, (169.274, 195.886, 176.914)), (' F 247  VAL HG23', ' F 248  ARG  N  ', -0.43, (160.413, 154.823, 125.766)), (' F  80  SER  HB3', ' F  81  PHE  CA ', -0.43, (153.467, 205.323, 160.872)), (' A 116  ARG  HG2', ' A 217  TYR  HB2', -0.429, (167.229, 149.163, 239.343)), (' A 848  VAL HG11', ' D  80  ARG  CZ ', -0.429, (188.354, 177.808, 168.176)), (' F  12  THR  OG1', ' F  25  LEU  O  ', -0.429, (151.68, 186.794, 152.659)), (' A 335  VAL  O  ', ' A 335  VAL HG23', -0.428, (146.802, 158.005, 172.632)), (' F 232  VAL  O  ', ' F 232  VAL HG13', -0.428, (139.252, 170.993, 155.893)), (' F 526  LEU HD13', ' F 528  LEU  HG ', -0.428, (102.613, 148.767, 139.929)), (' E 513  SER  HG ', ' E 519  ASN  CG ', -0.428, (185.421, 144.731, 122.307)), (' E 304  ILE HG12', ' E 370  ILE  CG2', -0.428, (206.334, 145.893, 150.332)), (' F 445  PRO  HD2', ' F 448  ILE HD11', -0.428, (117.232, 149.818, 125.14)), (' A 149  TYR  CE2', ' A 212  LEU HD13', -0.428, (175.679, 147.388, 226.036)), (' E 371  VAL  O  ', ' E 371  VAL HG13', -0.427, (204.579, 152.534, 146.897)), (' A 401  LEU HD11', ' A 673  LEU HD11', -0.427, (166.646, 156.532, 180.72)), (' E 283  PRO  CB ', ' E 461  LEU HD12', -0.427, (209.616, 144.689, 125.296)), (' F 494  GLY  HA2', ' F 497  ARG  NH1', -0.426, (96.112, 154.817, 138.443)), (' F 136  GLU  HB2', ' F 235  LEU HD22', -0.425, (141.746, 172.387, 149.805)), (' A 154  ASP  O  ', ' A 154  ASP  OD1', -0.425, (190.491, 145.669, 221.055)), (' E 241  VAL HG13', ' E 388  ASN  OD1', -0.425, (205.424, 160.792, 147.16)), (' E 259  SER  OG ', ' E 260  ASP  N  ', -0.425, (212.222, 130.473, 144.034)), (' A 568  ASN  HB3', ' A 685  ALA  HB3', -0.425, (163.55, 175.11, 191.213)), (' A  85  THR  O  ', ' A  89  LEU HD13', -0.423, (153.108, 150.296, 244.4)), (' F  80  SER  HB3', ' F  81  PHE  HA ', -0.423, (153.101, 205.694, 161.143)), (" P  25    C  H2'", " P  26    U  O4'", -0.423, (166.993, 198.047, 180.77)), (' F 192  LYS  CG ', ' F 192  LYS  O  ', -0.423, (128.004, 162.999, 171.961)), (' T  42    U  C2 ', ' T  43    A  C8 ', -0.423, (161.068, 230.308, 167.911)), (' F 533  VAL HG23', ' F 564  ALA  HB2', -0.422, (117.71, 157.493, 136.092)), (' A 837  ILE HG22', ' A 884  TYR  CE2', -0.422, (197.227, 184.277, 187.292)), (' A 708  LEU HD11', ' A 731  LEU HD12', -0.421, (167.593, 170.65, 224.116)), (' E 165  LEU HD21', ' E 167  TRP  HE1', -0.42, (167.286, 164.942, 138.137)), (' E 401  ASP  OD2', ' E 403  ALA  HB3', -0.42, (205.746, 150.28, 126.213)), (' C  20  LEU HD13', ' C  65  ALA  HB1', -0.419, (199.5, 158.025, 166.874)), (' P  24    C  C2 ', ' P  25    C  C5 ', -0.419, (170.856, 202.505, 181.202)), (' F  21  ARG  NE ', ' F 136  GLU  OE2', -0.418, (140.362, 174.454, 154.219)), (' A  77  PHE  CD1', ' A  81  GLN  NE2', -0.418, (159.697, 155.176, 255.683)), (' D  33  VAL HG13', ' D  34  VAL  N  ', -0.417, (179.135, 244.094, 160.653)), (' E 115  THR HG22', ' E 414  LYS  HE2', -0.417, (191.547, 170.636, 121.086)), (' F 490  ARG  N  ', ' F 491  PRO  HD2', -0.416, (98.669, 161.868, 140.688)), (' A  31  VAL HG21', ' A  33  ARG  NH2', -0.416, (179.982, 153.349, 235.575)), (' B 132  ILE HD11', ' B 142  CYS  SG ', -0.415, (177.998, 138.77, 183.973)), (' E 132  LEU  HB3', ' E 235  LEU HD11', -0.415, (198.229, 168.904, 143.228)), (' A 612  PRO  HB2', ' A 805  LEU HD11', -0.415, (186.788, 188.384, 216.869)), (' E 150  GLY  N  ', ' E 172  PRO  O  ', -0.414, (172.479, 166.059, 131.681)), (' T  47    U  C2 ', ' T  48    G  C8 ', -0.414, (165.915, 247.914, 174.023)), (' E 515  TYR  OH ', ' E 552  THR HG21', -0.414, (188.199, 153.102, 115.212)), (' D  68  THR  O  ', ' D  72  LYS  HG2', -0.413, (188.769, 189.894, 165.843)), (' E 287  GLY  HA3', ' E 290  HIS  CE1', -0.412, (208.888, 139.069, 135.33)), (' A 746  TYR  CZ ', ' A 750  ARG  HD2', -0.411, (169.62, 186.665, 213.802)), (" P  24    C  C2'", " P  25    C  O5'", -0.411, (169.749, 201.493, 184.832)), (' T  45    C  C2 ', ' T  46    A  C8 ', -0.411, (161.01, 240.663, 176.115)), (' A 633  MET  HE2', ' A 697  CYS  SG ', -0.411, (167.797, 171.747, 209.958)), (' P  10    U  C2 ', ' P  11    G  C8 ', -0.41, (168.755, 240.484, 174.36)), (' E 154  VAL  O  ', ' E 154  VAL HG13', -0.409, (162.538, 176.412, 138.933)), (' A 101  PHE  CD2', ' A 114  ILE HG22', -0.409, (164.064, 149.482, 248.402)), (' E 304  ILE HD12', ' E 355  TYR  CE1', -0.409, (204.531, 141.639, 150.662)), (' T  33    A  C4 ', ' T  34    G  C8 ', -0.409, (168.11, 208.767, 178.991)), (' C  36  HIS  CE1', ' C  40  LEU HD11', -0.409, (197.207, 166.019, 184.143)), (' F 152  ALA  O  ', ' F 225  PHE  N  ', -0.409, (119.645, 161.768, 165.596)), (' A 196  MET  HE2', ' A 232  PRO  HB3', -0.408, (154.583, 155.209, 231.982)), (' E 235  LEU  O  ', ' E 235  LEU HD12', -0.408, (197.326, 169.075, 145.912)), (' E 405  LEU HD12', ' E 406  PRO  O  ', -0.408, (195.835, 154.511, 128.684)), (' B  70  MET  HG2', ' F  92  LEU HD21', -0.408, (157.712, 188.699, 160.658)), (' E 480  ILE  CD1', ' E 550  THR HG22', -0.408, (184.9, 150.335, 111.139)), (' F 235  LEU HD12', ' F 385  SER  CB ', -0.408, (143.339, 168.832, 146.328)), (" T  50    U  H2'", ' T  51    A  H8 ', -0.407, (163.402, 255.124, 161.992)), (' E 555  SER  O  ', ' E 561  PHE  CZ ', -0.407, (194.348, 149.58, 115.603)), (" P  25    C  H2'", ' P  26    U  H6 ', -0.406, (167.917, 197.993, 180.844)), (' E 287  GLY  HA3', ' E 290  HIS  HE1', -0.406, (209.206, 138.969, 135.155)), (' B  47  SER  O  ', ' B  51  ARG  N  ', -0.406, (161.498, 219.444, 161.139)), (' A 609  VAL HG21', ' A 765  CYS  O  ', -0.406, (182.468, 186.759, 217.468)), (' E 188  THR  O  ', ' E 189  LYS  HB2', -0.405, (167.564, 187.694, 127.795)), (' E 258  ILE HG23', ' E 259  SER  N  ', -0.405, (214.335, 132.999, 146.315)), (' F  30  CYS  O  ', ' F  34  VAL HG22', -0.405, (144.816, 193.131, 151.404)), (" P  24    C  O2'", ' P  25    C  OP1', -0.404, (169.382, 202.485, 186.174)), (' E 177  ASN  O  ', ' E 180  TYR  N  ', -0.403, (178.957, 167.805, 144.107)), (' F 448  ILE HG22', ' F 587  PHE  CZ ', -0.402, (113.634, 154.0, 123.342)), (' A 588  VAL  O  ', ' A 588  VAL HG23', -0.402, (177.662, 185.123, 200.905)), (' A 496  ASN  C  ', ' A 496  ASN  OD1', -0.402, (171.607, 184.042, 182.587)), (' E 127  THR HG22', ' E 128  GLU  N  ', -0.402, (207.124, 172.873, 141.419)), (' A 924  MET  HB2', ' A 924  MET  HE2', -0.402, (189.072, 196.677, 189.152)), (' A 818  MET  HE3', ' A 820  VAL HG11', -0.402, (196.672, 192.966, 200.636)), (' T  40    C  C2 ', ' T  41    G  C8 ', -0.402, (168.967, 226.739, 165.962)), (' A 371  LEU HD21', ' B  88  GLN  HG3', -0.401, (153.868, 165.254, 170.185)), (' E  98  VAL  O  ', ' E  98  VAL HG13', -0.401, (206.733, 185.846, 147.254)), (' A 398  VAL HG23', ' A 675  VAL HG23', -0.401, (166.301, 152.586, 189.713)), (' A 687  THR HG23', ' A 688  ALA  N  ', -0.4, (172.856, 176.601, 194.555))]
handle_read_draw_probe_dots_unformatted("molprobity_probe.txt", 0, 0)
show_probe_dots(True, True)
gui = coot_molprobity_todo_list_gui(data=data)
